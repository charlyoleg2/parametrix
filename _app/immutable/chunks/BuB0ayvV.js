import{p as s,a as te,b as ct,d as wt,f as He,g as Pe,h as m,j as B,E as be,k as se,l as N,r as Ie,m as _t,n as vt,o as St,q as tn,s as ie,t as so,u as Ve,w as sn,x as ue,y as $t,z as J,A as Gs,B as on,C as nn,D as rn,F as oo,G as We,H as ms,I as ks,J as Ts,S as qt,K as an,e as gt,L as dn,M as ln,N as cn,O as gn,P as Ks,Q as ws,R as no,T as Tt,U as un,V as hn,W as fn,X as _n,Y as Rs,Z as Fs,_ as ro,$ as Ue,a0 as vn,a1 as io,a2 as Sn,a3 as Ln,a4 as pn,a5 as Pn}from"./D3CViFKh.js";import"./DsnmJJEf.js";import{G as xn,I as Bs,M as Dn,L as bn,b5 as Hn,bc as mn,bd as kn,aS as wn,be as Rn,aT as An,ab as ae,V as A,an as Mn,ad as Bt,p as st,a9 as Qs,f as Pt,a as De,b as ot,d as b,r as x,t as Ge,c as Me,s as H,aa as Ce,ac as Qe,n as rt,R as eo,aA as hs,bf as As,b0 as ao,ae as Js,ax as yn}from"./BbPHKYFl.js";import{d as Lt,a as oe,s as ve,e as lo}from"./CqIcUl-F.js";import{s as $e,r as Je,a as Ms,b as Nn}from"./B32sI_Hj.js";import{i as ps}from"./C03kjGj3.js";import{p as at}from"./BW11xtzg.js";import{a as Us,r as $n}from"./DJ0mkbHa.js";import{s as tt,c as co}from"./B0OaGDzO.js";import{b as ys}from"./EpORvojL.js";import{a as it,b as Xt}from"./CalqpzuI.js";import{s as En}from"./BJepCtu4.js";import{p as go}from"./DLUl3T2K.js";import{a as vo,g as Cn}from"./CnPVvNV8.js";import{a as On,o as In}from"./BByOIjj7.js";import"./B0yeDSe9.js";import{i as zn}from"./HuASpZhE.js";function So(n,e,g=!1){if(n.multiple){if(e==null)return;if(!Hn(e))return mn();for(var t of n.options)t.selected=e.includes(_s(t));return}for(t of n.options){var o=_s(t);if(kn(o,e)){t.selected=!0;return}}(!g||e!==void 0)&&(n.selectedIndex=-1)}function Vn(n){var e=new MutationObserver(()=>{So(n,n.__value)});e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),wn(()=>{e.disconnect()})}function uo(n,e,g=e){var t=new WeakSet,o=!0;xn(n,"change",a=>{var i=a?"[selected]":":checked",r;if(n.multiple)r=[].map.call(n.querySelectorAll(i),_s);else{var d=n.querySelector(i)??n.querySelector("option:not([disabled])");r=d&&_s(d)}g(r),Bs!==null&&t.add(Bs)}),Dn(()=>{var a=e();if(n===document.activeElement){var i=bn??Bs;if(t.has(i))return}if(So(n,a,o),o&&a===void 0){var r=n.querySelector(":checked");r!==null&&(a=_s(r),g(a))}n.__value=a,o=!1}),Vn(n)}function _s(n){return"__value"in n?n.__value:n.value}function Tn(n,e){Rn(window,["resize"],()=>An(()=>e(window[n])))}function Fn(n){var e=Mn(0);return function(){return arguments.length===1?(ae(e,A(e)+1),arguments[0]):(A(e),n())}}var Bn=class{base_center_x;base_center_y;base_radius;initial_angle;right_nleft;constructor(n,e,g,t,o){this.base_center_x=n,this.base_center_y=e,this.base_radius=g,this.initial_angle=t,this.right_nleft=o}angleSign(){return this.right_nleft?1:-1}lFromU(n){return this.base_radius*Math.sqrt(1+n**2)}wFromU(n){if(n<0)throw`err729: involute parameter au ${n} is negative`;if(Math.abs(n)>Math.PI/2)throw`err730: involute parameter au ${n} is larger than PI/2`;return this.angleSign()*(n-Math.atan(n))}w2FromU(n){return this.initial_angle+this.wFromU(n)}ptc(n){const e=this.lFromU(n),g=this.w2FromU(n),t=this.base_center_x+Math.cos(g)*e,o=this.base_center_y+Math.sin(g)*e;return[t,o]}ptcta(n){return this.initial_angle+this.angleSign()*n}uFromL(n){return Math.sqrt(n**2/this.base_radius**2-1)}uFromWslow(n){let g=Math.PI/3,t=g/2,o=this.wFromU(g),a=0;for(;Math.abs(o-n)>1e-4;)o<n?g+=t:g-=t,o=this.wFromU(g),t=t/2,a+=1;return console.log(`dbg072: uFromWslow itcnt ${a}`),g}laptc(n,e,g,t){if(Math.sign(e)*this.angleSign()<0)throw`err904: Invole.laptc angle-of-pressure ${e} not compatible with right_nleft ${this.right_nleft}`;const o=n+e,a=this.base_center_x+Math.cos(o)*this.base_radius,i=this.base_center_y+Math.sin(o)*this.base_radius,r=o-this.angleSign()*Math.PI/2,d=g*this.base_radius,u=a+Math.cos(r)*d,l=i+Math.sin(r)*d,f=this.lFromU(g)*t,h=g,c=Math.cos(h)*f,S=Math.sin(h)*f;return[u,l,c,S]}};function Et(n,e,g,t,o){return new Bn(n,e,g,t,o)}var Gn=class{mod=1;TN=23;as=1;cx=0;cy=0;brr=50;blr=50;ar=54;pr=53;dr=52;br=51;bRound=1;adt=.5;initAngle=0;axisAngle=0;involArcPairs=1;skinThickness=0;involuteR=Et(0,0,50,0,!0);involuteL=Et(0,0,50,0,!1);rud=0;rup=0;rua=0;rwd=0;rwp=0;rwa=0;lud=0;lup=0;lua=0;lwd=0;lwp=0;lwa=0;msg;initStep=0;constructor(){this.mod=1,this.msg="",this.initStep=0}incInitStep(n){if(this.initStep+1!==n)throw`err834: incInitStep initStep ${this.initStep} and target ${n} are not compatible`;this.initStep=n}checkInitStep(n,e){if(this.initStep<n)throw`err835: checkInitStep for ${e} initStep ${this.initStep} is too small compare to targetMin ${n}`}set1ModuleToothNumber(n,e){this.incInitStep(1),this.mod=n,this.TN=e,this.pr=this.mod*this.TN/2,this.as=2*Math.PI/this.TN}set2CenterPosition(n,e){this.incInitStep(2),this.cx=n,this.cy=e}set3CircleRadius(n,e,g,t){this.incInitStep(3),this.ar=this.pr+this.mod*n,this.dr=this.pr-this.mod*e,this.br=this.dr-this.mod*g,this.bRound=t}set4BaseCircles(n,e){this.incInitStep(4),this.brr=n,this.blr=e}set5AddendumThickness(n){this.incInitStep(5),this.adt=n/100}set6Angles(n,e){this.incInitStep(6),this.initAngle=n,this.axisAngle=e}set7InvoluteDetails(n,e){this.incInitStep(7),this.involArcPairs=n,this.skinThickness=e}getRefCircles(){return this.checkInitStep(4,"getRefCircles"),[N(this.cx,this.cy,this.ar,"Azure"),N(this.cx,this.cy,this.pr,"Azure"),N(this.cx,this.cy,this.dr,"Azure"),N(this.cx,this.cy,this.br,"Azure"),N(this.cx,this.cy,this.brr,"CornFlowerBlue"),N(this.cx,this.cy,this.blr,"Crimson")]}calcInvoluteAngles(){this.checkInitStep(4,"calcInvoluteAngles"),this.involuteR=Et(this.cx,this.cy,this.brr,0,!0),this.dr>this.brr?this.rud=this.involuteR.uFromL(this.dr):this.rud=0,this.rup=this.involuteR.uFromL(this.pr),this.rua=this.involuteR.uFromL(this.ar),this.rwd=this.involuteR.wFromU(this.rud),this.rwp=this.involuteR.wFromU(this.rup),this.rwa=this.involuteR.wFromU(this.rua),this.involuteL=Et(this.cx,this.cy,this.blr,0,!1),this.dr>this.blr?this.lud=this.involuteL.uFromL(this.dr):this.lud=0,this.lup=this.involuteL.uFromL(this.pr),this.lua=this.involuteL.uFromL(this.ar),this.lwd=this.involuteL.wFromU(this.lud),this.lwp=this.involuteL.wFromU(this.lup),this.lwa=this.involuteL.wFromU(this.lua)}checkProfileConditions(){const n=this.as*this.adt,e=this.rwa-this.rwp,g=Math.abs(this.lwa-this.lwp),t=n-e-g;if(t<0)throw`err554: No remaining Addendum reserve ${m(t)}
`;const o=this.as*(1-this.adt),a=this.rwp-this.rwd,i=Math.abs(this.lwp-this.lwd),r=o-a-i;if(r<2*Math.atan2(this.bRound,this.br))throw`err555: No remaining Dedendum reserve ${m(r)} compare to bRound ${m(this.bRound)}
`}getToothRef(){const n=6*this.involArcPairs,e=0;this.checkInitStep(7,"getProfile"),this.calcInvoluteAngles();const g=(this.rua-this.rud)/n,t=(this.lua-this.lud)/n,o=this.initAngle+e*this.as,a=Et(this.cx,this.cy,this.brr,o-this.rwp,!0),[i,r]=a.ptc(this.rud+0*g),d=B(i,r,"Gold");for(let _=0;_<n;_++){const[f,h]=a.ptc(this.rud+(_+1)*g);d.addSegStrokeA(f,h)}const u=o+this.as*this.adt,l=Et(this.cx,this.cy,this.blr,u-this.lwp,!1);for(let _=0;_<n+1;_++){const[f,h]=l.ptc(this.lud+(n-_)*t);d.addSegStrokeA(f,h)}return d.closeSegStroke(),d}getProfile(){this.checkInitStep(7,"getProfile"),this.calcInvoluteAngles(),this.checkProfileConditions();const n=this.rwd-this.rwp,e=this.lwd-this.lwp,g=this.dr>this.brr?this.dr:this.brr,t=this.dr>this.blr?this.dr:this.blr;if(this.bRound>g-this.br)throw`err409: getProfile bRound ${m(this.bRound)} too large for erdr ${m(g)} and br ${m(this.br)}`;if(this.bRound>t-this.br)throw`err408: getProfile bRound ${m(this.bRound)} too large for eldr ${m(t)} and br ${m(this.br)}`;const o=(this.rua-this.rud)/this.involArcPairs,a=(this.lua-this.lud)/this.involArcPairs,i=ie(this.cx,this.cy),r=i.translatePolar(this.initAngle+n,this.br),d=B(r.cx,r.cy);for(let u=0;u<this.TN;u++){const l=this.initAngle+u*this.as,_=i.translatePolar(l+n,this.br);d.addSegStrokeA(_.cx,_.cy).addCornerRounded(this.bRound);const f=Et(this.cx,this.cy,this.brr,l-this.rwp,!0),[h,c]=f.ptc(this.rud),S=f.ptcta(this.rud),L=ie(h,c).translatePolar(S-Math.PI/2,this.skinThickness);d.addSegStrokeA(L.cx,L.cy);for(let k=0;k<this.involArcPairs;k++){const V=this.rud+k*o,[C,M]=f.ptc(V+o),q=f.ptcta(V),X=f.ptcta(V+o)+Math.PI,y=ie(C,M).translatePolar(q-Math.PI/2,this.skinThickness);d.addPointA(y.cx,y.cy).addSeg2Arcs(q,X)}const w=l+this.as*this.adt,v=Et(this.cx,this.cy,this.blr,w-this.lwp,!1),P=this.lud+this.involArcPairs*a,[$,z]=v.ptc(P),I=v.ptcta(P)+Math.PI,p=ie($,z).translatePolar(I-Math.PI/2,this.skinThickness);d.addSegStrokeA(p.cx,p.cy);for(let k=0;k<this.involArcPairs;k++){const V=this.lud+(this.involArcPairs-k)*a,[C,M]=v.ptc(V-a),q=v.ptcta(V)+Math.PI,X=v.ptcta(V-a),y=ie(C,M).translatePolar(q-Math.PI/2,this.skinThickness);d.addPointA(y.cx,y.cy).addSeg2Arcs(q,X)}const R=i.translatePolar(w+e,this.br);d.addSegStrokeA(R.cx,R.cy).addCornerRounded(this.bRound)}return d.closeSegStroke(),d}getMsg(){return this.msg}};function ho(){return new Gn}function Jn(n,e,g,t){n.checkInitStep(1,"helper.gw2center-1"),e.checkInitStep(1,"helper.gw2center-2");const o=n.pr+e.pr+t,a=n.cx+o*Math.cos(g),i=n.cy+o*Math.sin(g);return[a,i,o]}function Un(n,e,g,t,o,a,i,r,d,u,l){n.checkInitStep(3,"helper.baseCircles-1"),e.checkInitStep(3,"helper.baseCircles-2");let _=g,f=o,h=t,c=a;const S=n.pr+e.pr,L=u,w=l;switch(L){case 0:e.TN>n.TN?(_=n.dr,f=_*e.TN/n.TN):(f=e.dr,_=f*n.TN/e.TN);break;case 1:f=_*e.TN/n.TN;break;case 2:_=f*n.TN/e.TN;break;case 3:_=S*n.TN/(n.TN+e.TN)*Math.cos(Pe(i)),f=_*e.TN/n.TN;break;case 4:break;default:console.log(`err337: involROpt2 case ${L} is not implemented!`)}switch(w){case 0:e.TN>n.TN?(h=n.dr,c=h*e.TN/n.TN):(c=e.dr,h=c*n.TN/e.TN);break;case 1:c=h*e.TN/n.TN;break;case 2:h=c*n.TN/e.TN;break;case 3:h=S*n.TN/(n.TN+e.TN)*Math.cos(Pe(r)),c=h*e.TN/n.TN;break;case 4:break;default:console.log(`err358: involLOpt2 case ${w} is not implemented!`)}return d===1&&(h=_,c=f),[_,h,f,c]}var jn=class{gw1;gw2;initAngle1;angleCenterCenter;interAxis;rightLeftCenter2;msg;apr;apl;lBDr=0;lBDl=0;laStartRr1=0;laStartRr2=0;laStartRl1=0;laStartRl2=0;aFODr1=0;aFODr2=0;aFODl1=0;aFODl2=0;lasr1=0;lasr2=0;lasl1=0;lasl2=0;firstToothUr1=0;firstToothUl1=0;ftdr1=0;ftdl1=0;constructor(n,e,g,t,o,a){this.gw1=n,this.gw2=e,this.initAngle1=g,this.angleCenterCenter=t,this.interAxis=o,this.rightLeftCenter2=a,this.msg="",this.apr=0,this.apl=0}check1(){this.gw1.checkInitStep(4,"ActionLine.check1-1"),this.gw2.checkInitStep(4,"ActionLine.check1-2"),this.interAxis>this.gw1.ar+this.gw2.ar&&(this.msg+=`warn333: initAngle2 interAxis ${m(this.interAxis)} is too large compare to gw1.ar ${m(this.gw1.ar)} and gw2.ar ${m(this.gw2.ar)}
`),We(this.gw1.brr*this.gw2.TN-this.gw2.brr*this.gw1.TN)!==0&&(this.msg+=`warn407: right ratios differ N1/N2 = ${this.gw1.TN} / ${this.gw2.TN} = ${m(this.gw1.TN/this.gw2.TN)} and brr1/brr2 = ${m(this.gw1.brr)}/${m(this.gw2.brr)} = ${m(this.gw1.brr/this.gw2.brr)}
`),We(this.gw1.blr*this.gw2.TN-this.gw2.blr*this.gw1.TN)!==0&&(this.msg+=`warn408: left ratios differ N1/N2 = ${this.gw1.TN} / ${this.gw2.TN} = ${m(this.gw1.TN/this.gw2.TN)} and blr1/blr2 = ${m(this.gw1.blr)}/${m(this.gw2.blr)} = ${m(this.gw1.blr/this.gw2.blr)}
`)}check2(){this.gw1.checkInitStep(5,"ActionLine.check2-1"),this.gw2.checkInitStep(5,"ActionLine.check2-2"),We(this.gw1.adt+this.gw2.adt-1)>0&&(this.msg+=`warn281: addendum thickness too large: adt1 ${m(this.gw1.adt)} adt2 ${m(this.gw2.adt)}
`);const n=this.gw1.ar-this.gw1.pr,e=this.gw1.pr-this.gw1.dr,g=this.gw2.ar-this.gw2.pr,t=this.gw2.pr-this.gw2.dr;We(t-n)<0&&(this.msg+=`warn282: addendum-1 ${m(n)} larger than dedendum-2 ${m(t)}
`),We(e-g)<0&&(this.msg+=`warn283: addendum-2 ${m(g)} larger than dedendum-1 ${m(e)}
`)}calcActionLine(){this.gw1.checkInitStep(4,"ActionLine.calcActionLine-1"),this.gw2.checkInitStep(4,"ActionLine.calcActionLine-2"),this.gw1.calcInvoluteAngles(),this.gw2.calcInvoluteAngles();const n=this.interAxis*this.gw1.brr/(this.gw1.brr+this.gw2.brr),e=this.interAxis*this.gw1.blr/(this.gw1.blr+this.gw2.blr),g=this.interAxis-n,t=this.interAxis-e;this.apr=Math.acos((this.gw1.brr+this.gw2.brr)/this.interAxis),this.apl=Math.acos((this.gw1.blr+this.gw2.blr)/this.interAxis),this.msg+=`Pressure angular: right: ${m(Ie(this.apr))} left: ${m(Ie(this.apl))} degree
`,this.lBDr=this.interAxis*Math.sin(this.apr),this.lBDl=this.interAxis*Math.sin(this.apl),this.msg+=`Line of Action Maximum length: right: ${m(this.lBDr)} left: ${m(this.lBDl)} mm
`;const o=Math.PI/2+this.apr,a=ms(this.gw1.ar,n,o);this.aFODr1=Math.PI-o-a;const i=this.gw1.rua-this.apr-this.gw1.rwa;if(We(this.aFODr1-i)!==0)throw`dbg378: aFODr1 ${this.aFODr1} and aFODr1Alt ${i} differ`;const r=ks(n,this.gw1.ar,this.aFODr1),d=o,u=ms(this.gw2.ar,g,d);this.aFODr2=Math.PI-d-u;const l=this.gw2.rua-this.apr-this.gw2.rwa;if(We(this.aFODr2-l)!==0)throw`dbg379: aFODr2 ${this.aFODr2} and aFODr2Alt ${l} differ`;const _=ks(g,this.gw2.ar,this.aFODr2),f=r+_,h=f/this.gw1.brr,c=f/this.gw2.brr,S=this.gw1.rua-h,L=this.gw2.rua-c;this.laStartRr1=this.gw1.involuteR.lFromU(S),this.laStartRr2=this.gw2.involuteR.lFromU(L);const w=Math.PI/2+this.apl,v=ms(this.gw1.ar,e,w);this.aFODl1=Math.PI-w-v;const P=this.gw1.lua-this.apl+this.gw1.lwa;if(We(this.aFODl1-P)!==0)throw`dbg388: aFODl1 ${this.aFODl1} and aFODl1Alt ${P} differ`;const $=ks(e,this.gw1.ar,this.aFODl1),z=w,I=ms(this.gw2.ar,t,z);this.aFODl2=Math.PI-z-I;const p=this.gw2.lua-this.apl+this.gw2.lwa;if(We(this.aFODl2-p)!==0)throw`dbg389: aFODl2 ${this.aFODl2} and aFODl2Alt ${p} differ`;const R=ks(t,this.gw2.ar,this.aFODl2),k=$+R,V=k/this.gw1.blr,C=k/this.gw2.blr,M=this.gw1.lua-V,q=this.gw2.lua-C;this.laStartRl1=this.gw1.involuteL.lFromU(M),this.laStartRl2=this.gw2.involuteL.lFromU(q),this.msg+=`Line of Action Effective length: right: ${m(f)} left: ${m(k)} mm
`,this.msg+=`Line of Action Effective rotation angle: right-1: ${m(Ie(h))} right-2: ${m(Ie(c))} left-1: ${m(Ie(V))} left-2: ${m(Ie(C))} degree
`,this.msg+=`Line of Action Effective height: right-1: ${m(this.gw1.ar-this.laStartRr1)} right-2: ${m(this.gw2.ar-this.laStartRr2)} left-1: ${m(this.gw1.ar-this.laStartRl1)} left-2: ${m(this.gw2.ar-this.laStartRl2)} mm
`,this.lasr1=2*Math.PI/this.gw1.TN*this.gw1.brr,this.lasr2=2*Math.PI/this.gw2.TN*this.gw2.brr,this.msg+=`Line of Action right: step length: 1: ${m(this.lasr1)} 2: ${m(this.lasr2)} mm
`,this.msg+=`Line of Action right: nb of contact point: 1: ${m(f/this.lasr1)} 2: ${m(f/this.lasr2)}
`,this.lasl1=2*Math.PI/this.gw1.TN*this.gw1.blr,this.lasl2=2*Math.PI/this.gw2.TN*this.gw2.blr,this.msg+=`Line of Action left: step length: 1: ${m(this.lasl1)} 2: ${m(this.lasl2)} mm
`,this.msg+=`Line of Action left: nb of contact point: 1: ${m(k/this.lasl1)} 2: ${m(k/this.lasl2)}
`}calcContactPoint1(){for(this.gw1.checkInitStep(5,"ActionLine.calcContactPoint1"),this.firstToothUr1=Ts(this.apr-(this.initAngle1-this.angleCenterCenter)+this.gw1.rwp);We(this.firstToothUr1-this.gw1.as)>=0;)this.firstToothUr1=We(this.firstToothUr1-this.gw1.as);for(this.firstToothUl1=Ts(this.apl+(this.initAngle1-this.angleCenterCenter)+this.gw1.as*this.gw1.adt-this.gw1.lwp);We(this.firstToothUl1-this.gw1.as)>=0;)this.firstToothUl1=We(this.firstToothUl1-this.gw1.as);this.ftdr1=this.gw1.brr*this.firstToothUr1,this.ftdl1=this.gw1.blr*this.firstToothUl1}prepare(){this.check1(),this.check2(),this.calcActionLine(),this.calcContactPoint1()}oneContactSpeed(n,e,g,t,o,a,i,r,d,u){const _=Math.floor(e/(2*g)),f=(t+_*g)/o,h=n?1:-1,[c,S,L,w]=a.laptc(i,h*r,f,.4);this.msg+=`speed ${d}: vx ${m(L)} vy: ${m(w)} m/s
`;const v=ie(c,S),P=i+h*r,$=B(c,S,u),z=v.translatePolar(P,-w);$.addSegStrokeA(z.cx,z.cy);const I=z.translatePolar(P-h*Math.PI/2,L);return $.addSegStrokeA(I.cx,I.cy),$.closeSegStroke(),$}getContactSpeed(){const n=this.oneContactSpeed(!0,this.lBDr,this.lasr1,this.ftdr1,this.gw1.brr,this.gw1.involuteR,this.angleCenterCenter,this.apr,"R1","Black"),e=this.oneContactSpeed(!1,this.lBDl,this.lasl1,this.ftdl1,this.gw1.blr,this.gw1.involuteL,this.angleCenterCenter,this.apl,"L1","Black"),g=[];return g.push(n),g.push(e),g}getContours(){const n=[];n.push(N(this.gw1.cx,this.gw1.cy,this.laStartRr1,"SkyBlue")),n.push(N(this.gw1.cx,this.gw1.cy,this.laStartRl1,"SlateBlue")),n.push(N(this.gw2.cx,this.gw2.cy,this.laStartRr2,"SkyBlue")),n.push(N(this.gw2.cx,this.gw2.cy,this.laStartRl2,"SlateBlue"));const e=ie(this.gw1.cx,this.gw1.cy),g=ie(this.gw2.cx,this.gw2.cy),t=e.translatePolar(this.angleCenterCenter+this.apr,this.gw1.brr),o=g.translatePolar(this.angleCenterCenter+Math.PI+this.apr,this.gw2.brr),a=B(t.cx,t.cy,"YellowGreen");a.addSegStrokeA(o.cx,o.cy),a.closeSegStroke(),n.push(a);const i=e.translatePolar(this.angleCenterCenter-this.aFODr1,this.gw1.ar),r=g.translatePolar(this.angleCenterCenter+Math.PI-this.aFODr2,this.gw2.ar),d=B(i.cx,i.cy,"Yellow");d.addSegStrokeA(r.cx,r.cy),d.closeSegStroke(),n.push(d);const u=e.translatePolar(this.angleCenterCenter-this.apl,this.gw1.blr),l=g.translatePolar(this.angleCenterCenter+Math.PI-this.apl,this.gw2.blr),_=B(u.cx,u.cy,"YellowGreen");_.addSegStrokeA(l.cx,l.cy),_.closeSegStroke(),n.push(_);const f=e.translatePolar(this.angleCenterCenter+this.aFODl1,this.gw1.ar),h=g.translatePolar(this.angleCenterCenter+Math.PI+this.aFODl2,this.gw2.ar),c=B(f.cx,f.cy,"Yellow");return c.addSegStrokeA(h.cx,h.cy),c.closeSegStroke(),n.push(c),n.push(...this.getContactSpeed()),n}getContactPoint(){const n=[],e=ie(this.gw1.cx,this.gw1.cy),g=e.translatePolar(this.angleCenterCenter+this.apr,this.gw1.brr),t=e.translatePolar(this.angleCenterCenter-this.apl,this.gw1.blr);n.push(ie(g.cx,g.cy,qt.eBigSquare)),n.push(ie(t.cx,t.cy,qt.eBigSquare));const o=this.angleCenterCenter+this.apr-Math.PI/2,a=this.angleCenterCenter-this.apl+Math.PI/2,i=g.translatePolar(o,this.ftdr1),r=t.translatePolar(a,this.ftdl1);n.push(ie(i.cx,i.cy,qt.eBigSquare)),n.push(ie(r.cx,r.cy,qt.eBigSquare));let d=this.ftdr1;for(;d+this.lasr1<this.lBDr;){d+=this.lasr1;const l=g.translatePolar(o,d);n.push(ie(l.cx,l.cy,qt.eBigSquare))}let u=this.ftdl1;for(;u+this.lasl1<this.lBDl;){u+=this.lasl1;const l=t.translatePolar(a,u);n.push(ie(l.cx,l.cy,qt.eBigSquare))}return n}getMsg(){return this.msg}getInitAngle2(){let n=this.lBDr-this.ftdr1;for(;We(n-this.lasr2)>=0;)n=We(n-this.lasr2);let e=this.lBDl-this.ftdl1;for(;We(e-this.lasl2)>=0;)e=We(e-this.lasl2);const g=n/this.gw2.brr,t=e/this.gw2.blr,o=this.angleCenterCenter+Math.PI+this.apr-g+this.gw2.rwp,i=this.angleCenterCenter+Math.PI-this.apl+t+this.gw2.lwp-this.gw2.as*this.gw2.adt;let r=2*Math.PI+Ts(i);for(;We(r-this.gw2.as-o)>=0;)r=We(r-this.gw2.as);const d=r-o,u=d*this.gw2.brr/this.gw1.brr,l=d*this.gw2.brr,_=d*this.gw2.blr;this.msg+=`slack angle: 1: ${m(Ie(u))} 2: ${m(Ie(d))} degree
`,this.msg+=`slack on action line: right-2: ${m(l)} left-2: ${m(_)} mm
`;let f=0;if(this.rightLeftCenter2===0)f=o;else if(this.rightLeftCenter2===1)f=i;else if(this.rightLeftCenter2===2)f=o+d/2;else throw`err221: initAngle2 rightLeftCenter2 ${this.rightLeftCenter2} has an unkown value`;return an(f)}};function Wn(n,e,g,t,o,a){return new jn(n,e,g,t,o,a)}function qn(n,e,g,t,o,a,i,r,d){let u=N(n,e,g);if(t>0){if(o>2*g)throw`err383: axisTorque ribWidth ${m(o)} larger than 2x axisRadius ${m(g)}`;const l=Math.asin(o/(2*g)),_=2*Math.PI/t;if(_-2.5*l<0)throw`err384: axisTorque ribWidth ${m(o)} or ribNb ${t} are too large`;if(i>o/2)throw`err385: axisTorque ribRound1 ${m(i)} too large compare to ribWidth ${m(o)}`;if(i+r>a)throw`err386: axisTorque ribRound12 ${m(i)} ${m(r)} too large compare to ribHeight ${m(o)}`;const f=_-2*l>Math.PI,h=ie(n,e),S=h.translatePolar(d,g+a).translatePolar(d+Math.PI/2,o/2);u=B(S.cx,S.cy);for(let L=0;L<t;L++){const w=d+L*_,v=w+_,P=h.translatePolar(w+l,g),$=h.translatePolar(v-l,g),I=h.translatePolar(w,g+a).translatePolar(w+Math.PI/2,o/2),R=h.translatePolar(v,g+a).translatePolar(v-Math.PI/2,o/2);u.addSegStrokeA(I.cx,I.cy).addCornerRounded(i),u.addSegStrokeA(P.cx,P.cy).addCornerRounded(r),u.addPointA($.cx,$.cy).addSegArc(g,f,!0).addCornerRounded(r),u.addSegStrokeA(R.cx,R.cy).addCornerRounded(i)}u.closeSegStroke()}return u}function Xn(n,e,g,t,o,a,i,r){const d=2*Math.PI/o,u=Math.asin(a/(2*t)),l=Math.asin(a/(2*g));if(a>2*t)throw`err905: hollowStraight spokeWidth ${m(a)} too large for hollowInt ${m(t)}`;if(g-t<2.1*i)throw`err906: hollowStraight hollowExt ${m(g)}, hollowInt ${m(t)} and spokeRound ${m(i)} do not fit`;if(d-2*l<2.5*Math.asin(i/g))throw`err907: hollowStraight spokeNb ${o}, spokeWidth ${m(a)} or spokeRound ${m(i)} are too large`;const _=a/(2*Math.sin(d/2)),f=d-2*u<2.1*Math.asin(i/t),h=d-2*l>Math.PI,c=ie(n,e),S=[];for(let L=0;L<o;L++){const w=r+L*d,v=w+d,P=w+d/2,$=c.translatePolar(w+l,g),z=c.translatePolar(v-l,g),I=c.translatePolar(v-u,t),p=c.translatePolar(w+u,t),R=c.translatePolar(P,_),k=B($.cx,$.cy);k.addCornerRounded(i),k.addPointA(z.cx,z.cy).addSegArc(g,h,!0).addCornerRounded(i),f?k.addSegStrokeA(R.cx,R.cy).addCornerRounded(i):(k.addSegStrokeA(I.cx,I.cy).addCornerRounded(i),k.addPointA(p.cx,p.cy).addSegArc(t,h,!1).addCornerRounded(i)),k.closeSegStroke(),S.push(k)}return S}function fo(n,e,g,t,o,a,i,r,d,u){const l=u?1:-1,_=n/2,f=_+e,h=f+g,c=B(0,-h);return c.addSegStrokeA(l*t,-h).addCornerRounded(i).addSegStrokeA(l*t,-f).addCornerRounded(r).addSegStrokeA(l*o,-f).addSegStrokeA(l*a,-_).addCornerRounded(d).addSegStrokeA(l*a,_).addCornerRounded(d).addSegStrokeA(l*o,f).addSegStrokeA(l*t,f).addCornerRounded(r).addSegStrokeA(l*t,h).addCornerRounded(i).addSegStrokeA(0,h).closeSegStroke(),c}var Lo={partName:"gear_wheel",params:[s("module","mm",10,.1,100,.1),s("N1","scalar",23,3,1e3,1),s("N2","scalar",19,3,1e3,1),s("angleCenterCenter","degree",0,-180,180,1),s("addInterAxis","mm",0,0,100,.05),s("c1x","mm",0,-200,200,1),s("c1y","mm",0,-200,200,1),te("Tooth addendum dedendum"),s("ah1","scalar",1,.1,2,.05),s("dh1","scalar",1,.1,2,.05),s("bh1","scalar",.25,.1,2,.05),s("bRound1","mm",2,0,50,.1),s("ah2","scalar",1,.1,2,.05),s("dh2","scalar",1,.1,2,.05),s("bh2","scalar",.25,.1,2,.05),s("bRound2","mm",2,0,50,.1),s("at1","%",50,10,90,.5),s("at2","%",50,10,90,.5),te("Tooth involute of circle"),ct("involSym",!0),wt("involROpt",["Optimum","Base-1","Base-2","PressureAngle","FreeBase-12"]),wt("involLOpt",["Optimum","Base-1","Base-2","PressureAngle","FreeBase-12"]),s("brr1","mm",102.9,10,2e3,.05),s("blr1","mm",102.9,10,2e3,.05),s("brr2","mm",85,10,2e3,.05),s("blr2","mm",85,10,2e3,.05),s("rightPressureAngle","degree",26,1,45,.5),s("leftPressureAngle","degree",26,1,45,.5),s("involArcPairs1","scalar",2,1,40,1),s("involArcPairs2","scalar",2,1,40,1),s("skinThickness1","mm",0,-3,3,.01),s("skinThickness2","mm",0,-3,3,.01),s("initAngle1","degree",0,-180,180,1),wt("gw2Position",["right","left","center"]),te("Inner"),ct("centralAxis",!0),s("axisRadius","mm",10,.1,200,.1),s("ribNb","scalar",5,0,32,1),s("ribWidth","mm",8,1,100,.1),s("ribHeight","mm",8,1,100,.1),s("ribRound1","mm",2,0,20,.1),s("ribRound2","mm",2,0,20,.1),ct("hollow",!0),s("materialHeightExt","mm",20,1,200,.5),s("materialHeightInt","mm",15,1,200,.5),s("spokeNb","scalar",5,1,18,1),s("spokeWidth","mm",15,1,200,.1),s("spokeRound","mm",10,0,20,.1),te("Axis"),ct("wheelAxis",!0),s("wheelHeight","mm",40,.1,400,.1),s("wheelMidExtra","mm",6,0,10,.1),s("wheelAxisLength","mm",40,0,400,.1),s("wheelAxisRadius","mm",20,0,200,.1),s("wheelMidRadius","mm",60,0,200,.1),s("wheelRadiusExtra","mm",1,0,20,.1),s("wheelAxisExtRound","mm",4,0,20,.1),s("wheelAxisIntRound","mm",0,0,20,.1),s("wheelExtraRound","mm",4,0,20,.1)],paramSvg:{module:"gearwheel_params_main.svg",N1:"gearwheel_params_main.svg",N2:"gearwheel_params_main.svg",angleCenterCenter:"gearwheel_params_interaxis.svg",addInterAxis:"gearwheel_params_interaxis.svg",c1x:"gearwheel_params_main.svg",c1y:"gearwheel_params_main.svg",ah1:"gearwheel_params_teeth_height.svg",dh1:"gearwheel_params_teeth_height.svg",bh1:"gearwheel_params_teeth_height.svg",bRound1:"gearwheel_params_teeth_height.svg",ah2:"gearwheel_params_teeth_height.svg",dh2:"gearwheel_params_teeth_height.svg",bh2:"gearwheel_params_teeth_height.svg",bRound2:"gearwheel_params_teeth_height.svg",at1:"gearwheel_params_addendum_portion.svg",at2:"gearwheel_params_addendum_portion.svg",involSym:"gearwheel_params_involSym.svg",involROpt:"gearwheel_params_main.svg",involLOpt:"gearwheel_params_main.svg",brr1:"gearwheel_params_baseCircles.svg",brr2:"gearwheel_params_baseCircles.svg",blr1:"gearwheel_params_baseCircles.svg",blr2:"gearwheel_params_baseCircles.svg",rightPressureAngle:"gearwheel_params_baseCircles.svg",leftPressureAngle:"gearwheel_params_baseCircles.svg",involArcPairs1:"gearwheel_params_skin.svg",skinThickness1:"gearwheel_params_skin.svg",involArcPairs2:"gearwheel_params_skin.svg",skinThickness2:"gearwheel_params_skin.svg",initAngle1:"gearwheel_params_initAngle.svg",gw2Position:"gearwheel_params_initAngle.svg",centralAxis:"gearwheel_params_hollow_axis.svg",axisRadius:"gearwheel_params_hollow_axis.svg",ribNb:"gearwheel_params_hollow_axis.svg",ribWidth:"gearwheel_params_hollow_axis.svg",ribHeight:"gearwheel_params_hollow_axis.svg",ribRound1:"gearwheel_params_hollow_axis.svg",ribRound2:"gearwheel_params_hollow_axis.svg",hollow:"gearwheel_params_hollow_axis.svg",materialHeightExt:"gearwheel_params_hollow_axis.svg",materialHeightInt:"gearwheel_params_hollow_axis.svg",spokeNb:"gearwheel_params_hollow_axis.svg",spokeWidth:"gearwheel_params_hollow_axis.svg",spokeRound:"gearwheel_params_hollow_axis.svg",wheelAxis:"gearwheel_params_side.svg",wheelHeight:"gearwheel_params_side.svg",wheelMidExtra:"gearwheel_params_side.svg",wheelAxisLength:"gearwheel_params_side.svg",wheelAxisRadius:"gearwheel_params_side.svg",wheelMidRadius:"gearwheel_params_side.svg",wheelRadiusExtra:"gearwheel_params_side.svg",wheelAxisExtRound:"gearwheel_params_side.svg",wheelAxisIntRound:"gearwheel_params_side.svg",wheelExtraRound:"gearwheel_params_side.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function Yn(n,e,g=""){const t=He(Lo.partName+g),o=J(),a=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const i=[],r=ho(),d=ho();r.set1ModuleToothNumber(e.module,e.N1),d.set1ModuleToothNumber(e.module,e.N2),r.set2CenterPosition(e.c1x,e.c1y);const u=Pe(e.angleCenterCenter),[l,_,f]=Jn(r,d,u,e.addInterAxis);d.set2CenterPosition(l,_),r.set3CircleRadius(e.ah1,e.dh1,e.bh1,e.bRound1),d.set3CircleRadius(e.ah2,e.dh2,e.bh2,e.bRound2);const[h,c,S,L]=Un(r,d,e.brr1,e.blr1,e.brr2,e.blr2,e.rightPressureAngle,e.leftPressureAngle,e.involSym,e.involROpt,e.involLOpt);t.logstr+=`base-circles: brr1: ${h.toFixed(2)}  blr1: ${c.toFixed(2)}  brr2: ${S.toFixed(2)}  blr2: ${L.toFixed(2)}
`,r.set4BaseCircles(h,c),d.set4BaseCircles(S,L),r.set5AddendumThickness(e.at1),d.set5AddendumThickness(e.at2);const w=Pe(e.initAngle1)+n*3*r.as/100;r.set6Angles(w,u);const v=Wn(r,d,w,u,f,e.gw2Position);v.prepare();for(const k of v.getContours())o.addDynamics(k);o.addPoints(v.getContactPoint()),d.set6Angles(v.getInitAngle2(),u+Math.PI),t.logstr+=v.getMsg(),r.set7InvoluteDetails(e.involArcPairs1,e.skinThickness1),d.set7InvoluteDetails(e.involArcPairs2,e.skinThickness2);for(const k of r.getRefCircles())o.addDynamics(k);for(const k of d.getRefCircles())o.addDynamics(k);o.addDynamics(r.getToothRef()),o.addDynamics(d.getToothRef());const P=r.getProfile();if(t.logstr+=r.getMsg(),t.logstr+=P.check(),i.push(P),e.centralAxis===1){const k=qn(r.cx,r.cy,e.axisRadius,e.ribNb,e.ribWidth,e.ribHeight,e.ribRound1,e.ribRound2,w);t.logstr+=k.check(),i.push(k)}if(e.hollow===1){const k=r.br,V=e.axisRadius+e.ribHeight,C=k-e.materialHeightExt,M=V+e.materialHeightInt;if(M>C)throw`err902: hollowMaterialInt ${m(M)} bigger than hollowMaterialExt ${m(C)}`;const q=Xn(r.cx,r.cy,C,M,e.spokeNb,e.spokeWidth,e.spokeRound,w);for(const X of q)t.logstr+=X.check(),i.push(X)}o.addMainOI(i);const $=d.getProfile();t.logstr+=$.check(),o.addSecond($);const z=[],I=r.ar+e.wheelRadiusExtra;if(e.wheelAxis===1){const k=fo(e.wheelHeight,e.wheelMidExtra,e.wheelAxisLength,e.wheelAxisRadius,e.wheelMidRadius,I,e.wheelAxisExtRound,e.wheelAxisIntRound,e.wheelExtraRound,!0),V=fo(e.wheelHeight,e.wheelMidExtra,e.wheelAxisLength,e.wheelAxisRadius,e.wheelMidRadius,I,e.wheelAxisExtRound,e.wheelAxisIntRound,e.wheelExtraRound,!1);z.push(k),a.addSecond(V)}else{const k=B(0,-e.wheelHeight/2).addSegStrokeR(0,e.wheelHeight).addSegStrokeR(I,0).addSegStrokeR(0,-e.wheelHeight).closeSegStroke(),V=B(0,-e.wheelHeight/2).addSegStrokeR(0,e.wheelHeight).addSegStrokeR(-I,0).addSegStrokeR(0,-e.wheelHeight).closeSegStroke();z.push(k),a.addSecond(V)}a.addMainOI(z),t.fig={teethProfile:o,axisProfile:a};const p=t.partName,R=e.wheelHeight/2+e.wheelMidExtra+e.wheelAxisLength+10;t.vol={extrudes:[{outName:`subpax_${p}_teethProfile`,face:`${p}_teethProfile`,extrudeMethod:se.eLinearOrtho,length:2*R,rotate:[0,0,0],translate:[0,0,-R]},{outName:`subpax_${p}_axisProfile`,face:`${p}_axisProfile`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${p}`,boolMethod:be.eIntersection,inList:[`subpax_${p}_teethProfile`,`subpax_${p}_axisProfile`]}]},t.logstr+=`gear_wheel drawn successfully!
`,t.calcErr=!1}catch(i){t.logstr+=i,console.log(i)}return t}var Zn={pTitle:"Gearwheel",pDescription:"Gear-system with two wheels",pDef:Lo,pGeom:Yn},po={partName:"gear_bar",params:[s("H1","mm",40,1,4e3,1),s("H2","mm",50,1,4e3,1),s("radius","mm",10,1,4e3,1),te("corners"),s("Rc","mm",10,0,400,1)],paramSvg:{H1:"voila_face.svg",H2:"voila_face.svg",radius:"voila_face.svg",Rc:"voila_face.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Kn(n,e,g=""){const t=He(po.partName+g),o=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const a=[],i=B(-e.H1/2,-e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(e.H1/2,-e.H2/2).addSegStrokeA(e.H1/2,e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(-e.H1/2,e.H2/2).closeSegStroke();a.push(i),a.push(N(0,0,e.radius)),o.addMainOI(a),t.fig={faceVoila:o};const r=t.partName;t.vol={extrudes:[{outName:`subpax_${r}_top`,face:`${r}_faceVoila`,extrudeMethod:se.eLinearOrtho,length:10,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${r}`,boolMethod:be.eIdentity,inList:[`subpax_${r}_top`]}]},t.sub={},t.logstr+=`gear_bar drawn successfully!
`,t.calcErr=!1}catch(a){t.logstr+=a,console.log(a)}return t}var Qn={pTitle:"Gearbar",pDescription:"Gear-system with a bar and a wheel",pDef:po,pGeom:Kn},Po={partName:"gear_ring",params:[s("H1","mm",40,1,4e3,1),s("H2","mm",50,1,4e3,1),s("radius","mm",10,1,4e3,1),te("corners"),s("Rc","mm",10,0,400,1)],paramSvg:{H1:"voila_face.svg",H2:"voila_face.svg",radius:"voila_face.svg",Rc:"voila_face.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function er(n,e,g=""){const t=He(Po.partName+g),o=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const a=[],i=B(-e.H1/2,-e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(e.H1/2,-e.H2/2).addSegStrokeA(e.H1/2,e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(-e.H1/2,e.H2/2).closeSegStroke();a.push(i),a.push(N(0,0,e.radius)),o.addMainOI(a),t.fig={faceVoila:o};const r=t.partName;t.vol={extrudes:[{outName:`subpax_${r}_top`,face:`${r}_faceVoila`,extrudeMethod:se.eLinearOrtho,length:10,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${r}`,boolMethod:be.eIdentity,inList:[`subpax_${r}_top`]}]},t.sub={},t.logstr+=`gear_ring drawn successfully!
`,t.calcErr=!1}catch(a){t.logstr+=a,console.log(a)}return t}var tr={pTitle:"Gearring",pDescription:"Gear-system with a ring and a wheel",pDef:Po,pGeom:er},xo={partName:"gear_epicycloid",params:[s("H1","mm",40,1,4e3,1),s("H2","mm",50,1,4e3,1),s("radius","mm",10,1,4e3,1),te("corners"),s("Rc","mm",10,0,400,1)],paramSvg:{H1:"voila_face.svg",H2:"voila_face.svg",radius:"voila_face.svg",Rc:"voila_face.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function sr(n,e,g=""){const t=He(xo.partName+g),o=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const a=[],i=B(-e.H1/2,-e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(e.H1/2,-e.H2/2).addSegStrokeA(e.H1/2,e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(-e.H1/2,e.H2/2).closeSegStroke();a.push(i),a.push(N(0,0,e.radius)),o.addMainOI(a),t.fig={faceVoila:o};const r=t.partName;t.vol={extrudes:[{outName:`subpax_${r}_top`,face:`${r}_faceVoila`,extrudeMethod:se.eLinearOrtho,length:10,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${r}`,boolMethod:be.eIdentity,inList:[`subpax_${r}_top`]}]},t.sub={},t.logstr+=`gear_epicycloid drawn successfully!
`,t.calcErr=!1}catch(a){t.logstr+=a,console.log(a)}return t}var or={pTitle:"Gear-epicycloid",pDescription:"The epicycloid gear system",pDef:xo,pGeom:sr};function nr(n){let e="";const g=n.PHD1/2,t=n.PHD5/2,o=2*Math.asin(n.PHR4/g),a=2*Math.asin(n.PHL2/(2*t)),i=2*Math.PI/n.PHN1-a,r=n.PHL2/2,d=Math.sqrt(t**2-r**2)-g,u=Math.sqrt(r**2+d**2),l=Math.acos(d/u),_=Math.acos(n.PHR4/u),f=Math.PI-l-_;if(t<g+n.PHR4)throw`err211: PHD5 ${n.PHD5} too small compare to PHD1 ${n.PHD1} or PHR4 ${n.PHR4}`;if(i<a)throw`err212: PHL2 ${n.PHL2} too large compare to PHN1 ${n.PHN1}`;if(n.PHD3>2*n.PHR4)throw`err213: PHD3 ${n.PHD3} too large compare to PHR4 ${n.PHR4}`;f>Math.PI/2-o&&(e+=`warn345: PHL2 is quiet small ${m(n.PHL2)} mm
`),e+=`petal angle: ${m(Ie(a))} degree
`,e+=`hollow angle: ${m(Ie(i))} degree
`;const h=ie(0,0),S=ie(t,0).rotate(h,-a/2),L=ie(g,0),w=ie(g-n.PHR4,0),v=w.rotate(L,f),P=w.rotate(L,-f),$=B(S.cx,S.cy).addCornerRounded(n.PHR6).addSegStrokeA(v.cx,v.cy).addPointA(g-n.PHR4,0).addPointA(P.cx,P.cy).addSegArc2().addSegStrokeAP(a/2,t).addCornerRounded(n.PHR6).addPointAP(a/2+i/2,t).addPointAP(a/2+i,t).addSegArc2(),z=B(S.cx,S.cy),I=[...Array(n.PHN1).keys()].map(p=>p*(a+i));for(const p of I)z.addPartial($.rotate(0,0,p));return[e,z,I]}function Do(n){const g=n.D1/2,t=n.D2/2,o=n.D4/2,a=2*Math.PI/n.N1,i=n.L1/2,r=Math.sqrt(t**2-i**2),d=Math.asin(i/t),u=g-r,l=Math.atan2(i,u),_=Math.sqrt(i**2+u**2),f=Math.acos(o/_),h=l+f,c=(a-2*d)/2;if(c<0)throw`err464: N1 ${n.N1} is too large compare to D2 ${n.D2}, L1 ${n.L1}`;if(g<t)throw`err465: D2 ${n.D2} is too large compare to D1 ${n.D1}`;const S=B(r,-i),L=ie(0,0),w=ie(t,0),v=ie(g,0),$=ie(g-o,0).rotate(v,h),z=w.rotate(L,d+c),I=w.rotate(L,a-d),p=B(r,-i).addCornerRounded(n.R5).addSegStrokeA($.cx,$.cy).addPointA(g+o,0).addPointA($.cx,-$.cy).addSegArc2().addSegStrokeA(r,i).addCornerRounded(n.R5).addPointA(z.cx,z.cy).addPointA(I.cx,I.cy).addSegArc2();for(let R=0;R<n.N1;R++)S.addPartial(p.rotate(0,0,R*a));return["",S,a]}function Ns(n,e){let g="";const t=n.SD2/2,o=t+n.SE1,a=2*o;let i=!1,r=-t,d=-o;if(e&&(i=!0,r=o,d=t),n.SL2<o)throw`err421: SL2 ${n.SL2} is too small compare to SD2 ${n.SD2} and SE1 ${n.SE1}`;g+=`info309: spring height: ${m(n.SL1+a)} length: ${m(n.SN1*2*(n.SD2+n.SE1))}
`;const u=B(0,0);for(let l=0;l<n.SN1;l++)u.addSegStrokeR(0,-n.SL1).addPointR(2*r,0).addSegArc(Math.abs(r),!1,i),l<n.SN1-1?u.addSegStrokeR(0,n.SL1).addPointR(2*d,0).addSegArc(Math.abs(d),!1,!i):n.Send===1?u.addSegStrokeR(0,n.SL2):u.addSegStrokeR(0,n.SL2-o).addPointR(2*d,0).addSegArc(Math.abs(d),!1,!i);n.Send===1?u.addSegStrokeR(-n.SE1,0):u.addSegStrokeR(n.SE1,0);for(let l=0;l<n.SN1;l++)l>0?u.addPointR(-2*r,0).addSegArc(Math.abs(r),!1,i).addSegStrokeR(0,-n.SL1):n.Send===1?u.addSegStrokeR(0,-n.SL2):u.addPointR(-2*r,0).addSegArc(Math.abs(r),!1,i).addSegStrokeR(0,-n.SL2+o),u.addPointR(-2*d,0).addSegArc(Math.abs(d),!1,!i).addSegStrokeR(0,n.SL1);return[g,u]}function rr(n){let e="";const g=n.D6/2,t=2*Math.PI/n.N2,o=n.E2/2,a=2*Math.asin(o/g),i=(t-a)/2,d=(n.N2<3?0:Math.PI/n.N2)+Pe(n.SA1),u=Math.PI/2-d,l=-Math.PI/2+d,_=n.SD1/2;if(i<0)throw`err564: N2 ${n.N2} is too large compare to D6 ${n.D6}, E2 ${n.E2}`;if(n.orientation===2&&n.N2%2===1)throw`err565: N2 ${n.N2} is odd and orientation is alt`;const[f,h]=Ns(n,!1),[,c]=Ns(n,!0);e+=f;const S=ie(0,-g),L=ie(0,0),w=S.rotate(L,a),v=S.translate(0,n.L2),P=v.translate(-_,0),$=P.translate(0,_),z=P.translate(0,_+n.SE1),I=z.rotate(P,u),p=v.translate(0,_+n.SE1).translate(n.SE1,0),R=S.rotate(L,-a),k=v.translate(_,0),V=k.translate(0,_),C=V.rotate(k,l),M=k.translate(0,_+n.SE1),q=v.translate(0,_+n.SE1).translate(-n.SE1,0),X=B(w.cx,w.cy).addSegStrokeA(p.cx,p.cy).addSegStrokeA(z.cx,z.cy),y=B(z.cx,z.cy).addPointA(I.cx,I.cy).addSegArc(_+n.SE1,!1,!0);y.addPartial(h.rotate(0,0,-d).translate(I.cx,I.cy)),y.addPointA($.cx,$.cy).addPointA(v.cx,v.cy).addSegArc2().addSegStrokeA(S.cx,S.cy),X.addPartial(y);const F=B(S.cx,S.cy).addSegStrokeA(v.cx,v.cy).addPointA(V.cx,V.cy).addPointA(C.cx,C.cy).addSegArc2();F.addPartial(c.rotate(0,0,d).translate(C.cx,C.cy)),F.addPointA(M.cx,M.cy).addSegArc(_+n.SE1,!1,!0);const j=B(M.cx,M.cy).addSegStrokeA(q.cx,q.cy).addSegStrokeA(R.cx,R.cy),Z=B(S.cx,S.cy).addPartial(F).addPartial(j),G=B(g,0);if(n.orientation===2)for(let O=0;O<n.N2/2;O++){G.addPointAP(-2*O*t-2*i,g).addPointAP(-2*O*t-4*i,g).addSegArc2(),G.addCornerRounded(n.R7);const W=Math.PI/2-(2*O+2)*t,D=W+2*a;G.addPartial(F.rotate(0,0,D));const Y=y.rotate(0,0,W),E=Y.getFirstPoint();G.addCornerRounded(n.R7),G.addSegStrokeA(E.cx,E.cy),G.addCornerRounded(n.R7),G.addPartial(Y),G.addCornerRounded(n.R7)}else for(let O=0;O<n.N2;O++)G.addPointAP(-O*t-i,g).addPointAP(-O*t-2*i,g).addSegArc2().addCornerRounded(n.R7),n.orientation===0?G.addPartial(Z.rotate(0,0,Math.PI/2-(O+1)*t+a)):n.orientation===1&&G.addPartial(X.rotate(0,0,Math.PI/2-(O+1)*t)),G.addCornerRounded(n.R7);return[e,G]}var bo={partName:"vaxis_holder",params:[s("PHD1","mm",700,1,2e3,1),s("PHD2","mm",900,1,4e3,1),s("PHD5","mm",800,1,4e3,1),s("PHN1","holes",6,1,24,1),te("screw holes"),s("PHD3","mm",40,1,100,1),s("PHR4","mm",40,1,100,1),s("PHL2","mm",120,1,400,1),s("PHR6","mm",20,0,400,1),te("section"),s("PHE1","mm",10,1,80,1),s("PHH1","mm",50,1,200,1),s("PHA","degree",5,-45,45,.1),s("PHL1","mm",300,1,500,1),s("PHE2","mm",10,1,80,1),s("PHE3","mm",10,1,80,1),te("for reuse"),ct("withOuterCone",!0)],paramSvg:{PHD1:"vaxis_holder_top.svg",PHD2:"vaxis_holder_top.svg",PHD5:"vaxis_holder_top.svg",PHD3:"vaxis_holder_top.svg",PHR4:"vaxis_holder_top.svg",PHN1:"vaxis_holder_top.svg",PHL2:"vaxis_holder_top.svg",PHR6:"vaxis_holder_top.svg",PHE1:"vaxis_holder_section.svg",PHH1:"vaxis_holder_section.svg",PHA:"vaxis_holder_section.svg",PHL1:"vaxis_holder_section.svg",PHE2:"vaxis_holder_section.svg",PHE3:"vaxis_holder_top.svg",withOuterCone:"vaxis_holder_section.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function ir(n,e,g=""){const t=He(bo.partName+g),o=J(),a=J(),i=J(),r=J(),d=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const u=Pe(e.PHA),l=e.PHD1/2,_=e.PHD2/2,f=e.PHD3/2,h=e.PHD5/2,c=_+e.PHL1/2*Math.sin(u),S=_-e.PHL1/2*Math.sin(u),L=e.PHL1*Math.cos(u),w=_-e.PHE2/Math.cos(u)+e.PHE1/2*Math.tan(u),v=_-e.PHE2/Math.cos(u)-e.PHE1/2*Math.tan(u),P=Math.min(w,v),$=(e.PHL1-e.PHE1/Math.cos(u))/2,z=_-e.PHE2/Math.cos(u);if(P<h)throw`err210: PHD5 ${e.PHD5} too large compare to PHE2 ${e.PHE2} or PHA ${e.PHA}`;t.logstr+=`vaxis_holder's height: ${m(L)} mm
`,t.logstr+=`vaxis_holder outerD1: ${m(2*c)} mm
`,t.logstr+=`vaxis_holder outerD2: ${m(2*S)} mm
`,t.logstr+=`vaxis_holder innerD: ${m(e.PHD1-2*e.PHR4)} mm
`,t.logstr+=`vaxis_holder D2-next: ${m(2*z)} mm
`;const I=function(D){const Y=h+(w-h)/2;return B(D*Y,-e.PHE1/2).addSegStrokeR(D*(w-Y),0).addSegStrokeRP(-Math.PI/2+D*u,$).addSegStrokeRP(-Math.PI/2+D*(Math.PI/2+u),e.PHE2).addSegStrokeRP(Math.PI/2+D*u,e.PHL1).addSegStrokeRP(Math.PI/2+D*(Math.PI/2+u),e.PHE2).addSegStrokeRP(-Math.PI/2+D*u,$).addSegStrokeA(D*Y,e.PHE1/2).closeSegStroke()},p=function(D){return B(D*P,-e.PHE1/2).addSegStrokeA(D*P,e.PHE1/2).addSegStrokeA(D*(l-e.PHR4),e.PHE1/2).addSegStrokeA(D*(l-e.PHR4),-e.PHE1/2).closeSegStroke()},R=function(D){return B(D*(l+f),-e.PHE1/2).addSegStrokeA(D*(l+f),e.PHE1/2).addSegStrokeA(D*(l-f),e.PHE1/2).addSegStrokeA(D*(l-f),-e.PHE1/2).closeSegStroke()};o.addMainO(I(1)),o.addSecond(I(-1)),o.addSecond(p(1)),o.addSecond(R(1)),o.addSecond(p(-1)),o.addSecond(R(-1));const k=function(D){return B(D*(l+e.PHR4),-e.PHE1/2).addSegStrokeA(D*w,-e.PHE1/2).addSegStrokeRP(-Math.PI/2+D*u,$).closeSegStroke()},V=function(D){return B(D*(l+e.PHR4),e.PHE1/2).addSegStrokeA(D*v,e.PHE1/2).addSegStrokeRP(Math.PI/2+D*u,$).addSegStrokeA(D*(l+e.PHR4),e.PHE1/2+e.PHH1).closeSegStroke()},C=function(D){const Y=ie(D*v,e.PHE1/2).translatePolar(Math.PI/2+D*u,$),E=ie(D*w,-e.PHE1/2).translatePolar(-Math.PI/2+D*u,$),Q=_-e.PHE2/2;return B(D*Q,0).addSegStrokeA(Y.cx,Y.cy).addSegStrokeA(D*(l+e.PHR4),e.PHE1/2+e.PHH1).addSegStrokeA(D*(l+e.PHR4),e.PHE1/2).addSegStrokeA(D*(l+e.PHR4),-e.PHE1/2).addSegStrokeA(E.cx,E.cy).closeSegStroke()};o.addSecond(k(-1)),o.addSecond(V(-1)),i.mergeFigure(o,!0),r.mergeFigure(o,!0),d.mergeFigure(o,!0),o.addSecond(k(1)),o.addSecond(V(1)),i.addMainO(k(1)),i.addSecond(V(1)),r.addSecond(k(1)),r.addMainO(V(1)),d.addMainO(C(1));const M=[];M.push(N(0,0,P)),a.addSecond(N(0,0,_)),a.addSecond(N(0,0,Math.max(c,S)));const[q,X,y]=nr(e);t.logstr+=q,M.push(X);for(const D of y){const Y=ie(0,0).translatePolar(D,l);M.push(N(Y.cx,Y.cy,e.PHD3/2))}const F=B(l+e.PHR4,-e.PHE3).addSegStrokeA(P,-e.PHE3).addSegStrokeA(P,e.PHE3).addSegStrokeA(l+e.PHR4,e.PHE3).closeSegStroke();for(const D of y)a.addSecond(F.rotate(0,0,D));a.addMainOI(M),t.fig={facePetal:a,faceOuter:o,faceButtress1:i,faceButtress2:r,faceButtress12:d};const j=t.partName,Z=so();Z.addRotation(Math.PI/2,0,0),Z.addTranslation(0,e.PHE3/2,0);const G=y.map((D,Y)=>{const E=so(Z.getMatrix());return E.addRotation(0,0,D),{outName:`subpax_${j}_b2_${Y}`,face:`${j}_faceButtress12`,extrudeMethod:se.eLinearOrtho,length:e.PHE3,rotate:E.getRotation(),translate:E.getTranslation()}}),O=y.map((D,Y)=>`subpax_${j}_b2_${Y}`),W=e.withOuterCone?[`subpax_${j}_outer`]:[];t.vol={extrudes:[{outName:`subpax_${j}_outer`,face:`${j}_faceOuter`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${j}_petal`,face:`${j}_facePetal`,extrudeMethod:se.eLinearOrtho,length:e.PHE1,rotate:[0,0,0],translate:[0,0,-e.PHE1/2]},...G],volumes:[{outName:`pax_${j}`,boolMethod:be.eUnion,inList:[`subpax_${j}_petal`,...W,...O]}]},t.sub={},t.logstr+=`vaxis_holder drawn successfully!
`,t.calcErr=!1}catch(u){t.logstr+=u,console.log(u)}return t}var Ft={pTitle:"Heliostat vaxis_holder",pDescription:"The holders of the guidance mechanism for azimuth motion",pDef:bo,pGeom:ir},Ho={partName:"pole_static",params:[s("D1","mm",1e3,20,4e3,1),s("D2","mm",700,10,4e3,1),s("D3","mm",800,10,4e3,1),s("H1","mm",3e3,10,4e4,10),s("H2","mm",7e3,50,4e4,10),te("thickness"),s("E1","mm",30,1,80,1),s("E2","mm",5,1,80,1),te("base holes"),s("N1","",32,3,100,1),s("D5","mm",40,1,100,1),s("L1","mm",45,1,300,1),te("door"),s("D4","mm",600,1,1200,1),s("H3","mm",300,5,1200,1),s("H4","mm",1800,10,2500,1),s("L2","mm",30,1,100,1),s("E3","mm",40,1,100,1),te("holders"),ct("holders",!0),s("PHL1A","mm",400,1,1e3,1),s("PHL1B","mm",400,1,1e3,1),s("PHB","mm",5e3,1,2e4,1),s("PHD1A","mm",600,1,4e3,1),s("PHD1B","mm",380,1,4e3,1),s("PHN1AB","petal",6,1,24,1),te("holder-B"),s("PHD5B2","mm",600,1,4e3,1),s("PHD5B1","mm",600,1,4e3,1),s("PHR4B","mm",30,1,400,1),s("PHD3B","mm",40,1,400,1),s("PHL2B","mm",140,1,400,1),s("PHE3B","mm",10,1,50,1),s("PHR6B","mm",20,0,400,1),s("PHE1B","mm",10,1,50,1),s("PHH1B","mm",10,1,50,1),te("holder-A"),s("PHD5A","mm",900,1,4e3,1),s("PHR4A","mm",30,1,400,1),s("PHD3A","mm",40,1,400,1),s("PHL2A","mm",200,1,400,1),s("PHE3A","mm",10,1,50,1),s("PHR6A","mm",20,0,400,1),s("PHE1A","mm",10,1,50,1),s("PHH1A","mm",10,1,50,1)],paramSvg:{D1:"pole_stator_cut.svg",D2:"pole_stator_cut.svg",D3:"pole_stator_cut.svg",H1:"pole_stator_cut.svg",H2:"pole_stator_cut.svg",E1:"pole_stator_cut.svg",E2:"pole_stator_E2.svg",N1:"pole_stator_bottom.svg",D5:"pole_stator_bottom.svg",L1:"pole_stator_bottom.svg",D4:"pole_stator_face.svg",H3:"pole_stator_face.svg",H4:"pole_stator_face.svg",L2:"pole_stator_face.svg",E3:"pole_stator_right.svg",holders:"pole_stator_holders.svg",PHL1A:"pole_stator_holders.svg",PHL1B:"pole_stator_holders.svg",PHB:"pole_stator_holders.svg",PHD1A:"pole_stator_holders.svg",PHD1B:"pole_stator_holders.svg",PHN1AB:"pole_stator_holderB_top.svg",PHD5A:"pole_stator_holderB_top.svg",PHR4A:"pole_stator_holderB_top.svg",PHD3A:"pole_stator_holderB_top.svg",PHL2A:"pole_stator_holderB_top.svg",PHE3A:"pole_stator_holderB_top.svg",PHR6A:"pole_stator_holderB_top.svg",PHE1A:"pole_stator_holderB_section.svg",PHH1A:"pole_stator_holderB_section.svg",PHD5B1:"pole_stator_holderB_top.svg",PHD5B2:"pole_stator_holderB_top.svg",PHR4B:"pole_stator_holderB_top.svg",PHD3B:"pole_stator_holderB_top.svg",PHL2B:"pole_stator_holderB_top.svg",PHE3B:"pole_stator_holderB_top.svg",PHR6B:"pole_stator_holderB_top.svg",PHE1B:"pole_stator_holderB_section.svg",PHH1B:"pole_stator_holderB_section.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function ar(n,e,g=""){const t=He(Ho.partName+g),o=J(),a=J(),i=J(),r=J(),d=J(),u=J(),l=J(),_=J(),f=J(),h=J(),c=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const S=e.D1/2,L=e.D2/2,w=e.D3/2,v=e.H1+e.H2,P=Math.atan2(S-L,e.H2),$=e.E2*Math.tan(P/2),z=e.H1-$,I=e.PHL1B/Math.cos(P),p=L+e.PHL1B/2*Math.tan(P),R=e.H1+e.H2-e.PHL1B/2,k=L+(e.PHL1B/2+e.PHB)*Math.tan(P),V=e.H1+e.H2-e.PHL1B/2-e.PHB,C=e.PHL1A/Math.cos(P),M=S-e.PHL1A/2*Math.tan(P),q=e.H1+e.PHL1A/2;if(L>S)throw`err091: D2 ${e.D2} is larger than D1 ${e.D1}`;if(w+e.E2>S)throw`err095: D3 ${e.D3} and E2 ${e.E2} are too large compare to D1 ${e.D1}`;if(e.holders){if(e.PHB<e.PHL1B)throw`err131: PHB ${e.PHB} is too small compare to PHL1B ${e.PHL1B}`;if(e.PHB>e.H2-e.PHL1B-e.PHL1A)throw`err132: PHB ${e.PHB} is too large compare to H2 ${e.H2}, PHL1B ${e.PHL1B} and PHL1A ${e.PHL1A}`}t.logstr+=`pole-height: ${m(v)} mm
`,t.logstr+=`cone-half-angle: ${m(Ie(P))} degree
`,t.logstr+=`holder position: A: ${m(q)}  B1: ${m(V)}  B2: ${m(R)} mm
`;const X=function(T){let K=L-e.E2*Math.cos(P);return K+=(v-e.E2*Math.sin(P)-T)*Math.tan(P),K},y=function(T,K){const ee=B(T*S,0).addSegStrokeA(T*S,e.H1).addSegStrokeA(T*L,v).addSegStrokeR(-T*e.E2*Math.cos(P),-e.E2*Math.sin(P));if(K&&e.holders){const me=e.H1+e.PHL1A/2-e.PHE1A/2,Se=me+e.PHE1A,Ee=v-e.PHL1B/2+e.PHE1B/2,_e=Ee-e.PHE1B,de=Ee-e.PHB,Fe=de-e.PHE1B;ee.addSegStrokeA(T*X(Ee),Ee).addSegStrokeA(T*(e.PHD1B/2-e.PHR4B),Ee).addSegStrokeA(T*(e.PHD1B/2-e.PHR4B),_e).addSegStrokeA(T*X(_e),_e).addSegStrokeA(T*X(de),de).addSegStrokeA(T*(e.PHD1B/2-e.PHR4B),de).addSegStrokeA(T*(e.PHD1B/2-e.PHR4B),Fe).addSegStrokeA(T*X(Fe),Fe).addSegStrokeA(T*X(Se),Se).addSegStrokeA(T*(e.PHD1A/2-e.PHR4A),Se).addSegStrokeA(T*(e.PHD1A/2-e.PHR4A),me).addSegStrokeA(T*X(me),me)}return ee.addSegStrokeA(T*(S-e.E2),z),K?ee.addSegStrokeA(T*(S-e.E2),e.E1).addSegStrokeA(T*w,e.E1).addSegStrokeA(T*w,0):ee.addSegStrokeA(T*(S-e.E2),0),ee.closeSegStroke(),ee};o.addMainO(y(1,!1)),o.addSecond(y(1,!0)),o.addSecond(y(-1,!0));const F=e.D4/2,j=e.H4-2*F;if(j<0)throw`err121: H4 ${e.H4} is too small compare to D4 ${e.D4}`;if(F-e.L2<0)throw`err121: D4 ${e.D4} is too small compare to L2 ${e.L2}`;const Z=function(T){const K=F-T;return tn(0,e.H3+F-K,2*K,j+2*K,Math.PI/2)};a.addMainOI([Z(0),Z(e.L2)]);const G=B(S,0).addSegStrokeA(S,e.H1).addSegStrokeA(L,v).addSegStrokeA(-L,v).addSegStrokeA(-S,e.H1).addSegStrokeA(-S,0).closeSegStroke();a.addSecond(G);const O=B(-S,e.H3).addSegStrokeR(0,e.H4).addSegStrokeR(-e.E3,0).addSegStrokeR(0,-e.H4).closeSegStroke();a.addSecond(O);const W=[];W.push(N(0,0,S)),W.push(N(0,0,w));const D=w+e.L1,Y=2*Math.PI/e.N1;for(let T=0;T<e.N1;T++){const K=D*Math.cos(T*Y),ee=D*Math.sin(T*Y);W.push(N(K,ee,e.D5/2))}i.addSecond(N(0,0,L)),i.addSecond(N(0,0,S-e.E2)),i.addMainOI(W),r.addMainOI([N(0,0,S+e.E3),N(0,0,S-e.E2)]),d.addMainO(Z(e.L2));const E=t.partName,Q=[],ce=[];let U={};if(e.holders){const K=_t(Ft.pDef,"B2");K.setVal("PHD1",e.PHD1B),K.setVal("PHD2",2*p),K.setVal("PHD5",e.PHD5B2),K.setVal("PHN1",e.PHN1AB),K.setVal("PHD3",e.PHD3B),K.setVal("PHR4",e.PHR4B),K.setVal("PHL2",e.PHL2B),K.setVal("PHR6",e.PHR6B),K.setVal("PHE1",e.PHE1B),K.setVal("PHH1",e.PHH1B),K.setVal("PHA",Ie(P)),K.setVal("PHL1",I),K.setVal("PHE2",e.E2),K.setVal("PHE3",e.PHE3B),K.setVal("withOuterCone",1);const ee=Ft.pGeom(0,K.getParamVal(),K.getSuffix());vt(ee),t.logstr+=St(ee.logstr,K.getPartNameSuffix()),u.mergeFigure(ee.fig.faceOuter),l.mergeFigure(ee.fig.facePetal);const me={outName:`inpax_${E}_hB2`,subdesign:"pax_vaxis_holderB2",subgeom:ee,rotate:[0,0,0],translate:[0,0,R]};Q.push(me),ce.push(`inpax_${E}_hB2`);const Se=_t(Ft.pDef,"B1");Se.setVal("PHD1",e.PHD1B),Se.setVal("PHD2",2*k),Se.setVal("PHD5",e.PHD5B1),Se.setVal("PHN1",e.PHN1AB),Se.setVal("PHD3",e.PHD3B),Se.setVal("PHR4",e.PHR4B),Se.setVal("PHL2",e.PHL2B),Se.setVal("PHR6",e.PHR6B),Se.setVal("PHE1",e.PHE1B),Se.setVal("PHH1",e.PHH1B),Se.setVal("PHA",Ie(P)),Se.setVal("PHL1",I),Se.setVal("PHE2",e.E2),Se.setVal("PHE3",e.PHE3B),Se.setVal("withOuterCone",1);const Ee=Ft.pGeom(0,Se.getParamVal(),Se.getSuffix());vt(Ee),t.logstr+=St(Ee.logstr,Se.getPartNameSuffix()),_.mergeFigure(Ee.fig.faceOuter),f.mergeFigure(Ee.fig.facePetal);const _e={outName:`inpax_${E}_hB1`,subdesign:"pax_vaxis_holderB1",subgeom:Ee,rotate:[0,0,0],translate:[0,0,V]};Q.push(_e),ce.push(`inpax_${E}_hB1`);const de=_t(Ft.pDef,"A");de.setVal("PHD1",e.PHD1A),de.setVal("PHD2",2*M),de.setVal("PHD5",e.PHD5A),de.setVal("PHN1",e.PHN1AB),de.setVal("PHD3",e.PHD3A),de.setVal("PHR4",e.PHR4A),de.setVal("PHL2",e.PHL2A),de.setVal("PHR6",e.PHR6A),de.setVal("PHE1",e.PHE1A),de.setVal("PHH1",e.PHH1A),de.setVal("PHA",Ie(P)),de.setVal("PHL1",C),de.setVal("PHE2",e.E2),de.setVal("PHE3",e.PHE3A),de.setVal("withOuterCone",1);const Fe=Ft.pGeom(0,de.getParamVal(),de.getSuffix());vt(Fe),t.logstr+=St(Fe.logstr,de.getPartNameSuffix()),h.mergeFigure(Fe.fig.faceOuter),c.mergeFigure(Fe.fig.facePetal);const qe={outName:`inpax_${E}_hA`,subdesign:"pax_vaxis_holderA",subgeom:Fe,rotate:[0,0,0],translate:[0,0,q]};Q.push(qe),ce.push(`inpax_${E}_hA`),U={vaxis_holder_B2:{partName:K.getPartName(),dparam:K.getDesignParamList(),orientation:[0,0,0],position:[0,0,R]},vaxis_holder_B1:{partName:Se.getPartName(),dparam:Se.getDesignParamList(),orientation:[0,0,0],position:[0,0,V]},vaxis_holder_A:{partName:de.getPartName(),dparam:de.getDesignParamList(),orientation:[0,0,0],position:[0,0,q]}}}t.fig={poleCut:o,poleFace:a,poleBottom:i,emptyPole:r,emptyDoor:d,holderB2Section:u,holderB2Top:l,holderB1Section:_,holderB1Top:f,holderASection:h,holderATop:c},t.vol={inherits:Q,extrudes:[{outName:`subpax_${E}_pole`,face:`${E}_poleCut`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${E}_bottom`,face:`${E}_poleBottom`,extrudeMethod:se.eLinearOrtho,length:e.E1,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${E}_door`,face:`${E}_poleFace`,extrudeMethod:se.eLinearOrtho,length:S+e.E3,rotate:[Math.PI/2,0,0],translate:[0,0,0]},{outName:`subpax_${E}_emptyPole`,face:`${E}_emptyPole`,extrudeMethod:se.eLinearOrtho,length:e.H1,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${E}_emptyDoor`,face:`${E}_emptyDoor`,extrudeMethod:se.eLinearOrtho,length:S+e.E3+10,rotate:[Math.PI/2,0,0],translate:[0,0,0]}],volumes:[{outName:`ipax_${E}_door`,boolMethod:be.eIntersection,inList:[`subpax_${E}_door`,`subpax_${E}_emptyPole`]},{outName:`ipax_${E}_pole`,boolMethod:be.eSubstraction,inList:[`subpax_${E}_pole`,`subpax_${E}_emptyDoor`]},{outName:`pax_${E}`,boolMethod:be.eUnion,inList:[`ipax_${E}_pole`,`subpax_${E}_bottom`,`ipax_${E}_door`,...ce]}]},t.sub=U,t.logstr+=`pole_static drawn successfully!
`,t.calcErr=!1}catch(S){t.logstr+=S,console.log(S)}return t}var vs={pTitle:"Heliostat pole static",pDescription:"The vertical pole of an heliostat",pDef:Ho,pGeom:ar},mo={partName:"rake",params:[s("D1","mm",600,10,4e3,1),s("D2","mm",400,10,4e3,1),s("D3","mm",400,10,4e3,1),s("H1","mm",800,1,4e3,1),s("H2","mm",3e3,20,6e3,1),s("H3","mm",400,0,4e3,1),s("E1","mm",20,1,80,1),s("E3","mm",30,1,80,1),te("transversal"),s("H4","mm",400,10,1e3,1),s("D4","mm",300,10,1e3,1),s("E4","mm",20,1,80,1),s("H5","mm",1e3,10,2e3,1),s("D5","mm",200,1,1e3,1),s("L4","mm",300,1,1e3,1),s("L5","mm",2e3,10,4e3,1),s("L6","mm",2e3,1,4e3,1),s("D8","mm",400,1,1e3,1),te("diagonal"),s("D6","mm",100,1,600,1),s("E6","mm",10,1,80,1),s("L7","mm",100,1,1e3,1),s("L8","mm",200,1,1e3,1),te("base"),s("N1","",24,3,100,1),s("D7","mm",40,1,100,1),s("L1","mm",30,1,300,1),te("door"),s("H6","mm",100,1,1e3,1),s("H7","mm",600,10,2e3,1),s("L9","mm",300,1,1e3,1),s("R9","mm",50,0,300,1),s("doorOrientation","degree",0,-180,180,1)],paramSvg:{D1:"rake_face.svg",D2:"rake_side.svg",D3:"rake_face.svg",H1:"rake_face.svg",H2:"rake_face.svg",H3:"rake_face.svg",E1:"rake_face.svg",E3:"rake_face.svg",H4:"rake_side.svg",D4:"rake_side.svg",E4:"rake_side.svg",H5:"rake_side.svg",D5:"rake_side.svg",L4:"rake_face.svg",L5:"rake_face.svg",L6:"rake_face.svg",D6:"rake_face.svg",E6:"rake_face.svg",L7:"rake_face.svg",L8:"rake_face.svg",N1:"rake_top.svg",D7:"rake_top.svg",L1:"rake_top.svg",D8:"rake_side.svg",H6:"rake_door.svg",H7:"rake_door.svg",L9:"rake_door.svg",R9:"rake_door.svg",doorOrientation:"rake_door.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function dr(n,e,g=""){const t=He(mo.partName+g),o=J(),a=J(),i=J(),r=J(),d=J(),u=J(),l=J(),_=J(),f=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const c=Math.PI/2,S=-Math.PI/2,L=e.D1/2,w=e.D2/2,v=e.D3/2,P=e.D4/2,$=e.D5/2,z=e.D6/2,I=e.D7/2,p=e.D8/2,R=e.D4-2*e.E4,k=e.H1+e.H2,V=k-e.H4+e.H5,C=4*e.L4+e.L5+2*e.L6,M=e.H1+e.H2-e.H4,q=P*Math.cos(Math.PI/6),X=P*Math.sin(Math.PI/6),y=$*Math.cos(Math.PI/6),F=$*Math.sin(Math.PI/6),j=p*Math.cos(Math.PI/6),Z=p*Math.sin(Math.PI/6),G=[-C/2,-e.L5/2-e.L4,e.L5/2,C/2-e.L4],O=e.H2-e.L8-e.H4-P,W=Math.atan2(L-w,e.H2),D=C/2-e.L7-L+e.L8*Math.tan(W),Y=Math.sqrt(D**2+O**2),E=Math.atan2(D,O),Q=e.E1/Math.sin(E+W),ce=Y+e.E4/Math.cos(E)+Q,U=L-e.L8*Math.tan(W)-Q*Math.sin(E),T=e.H1+e.L8-Q*Math.cos(E),K=U-z*Math.cos(E),ee=T+z*Math.sin(E),me=z-e.E6,Se=U-e.E6*Math.cos(E),Ee=T+e.E6*Math.sin(E),_e=Math.PI/2-E,de=e.L9/2,Fe=de-e.H7*Math.tan(W);if(e.D2>e.D1)throw`err110: D2 ${e.D2} is larger than D1 ${e.D1}`;if(e.D3+e.E1>e.D1)throw`err113: D3 ${e.D3} is too large compare to D1 ${e.D1} and E1 ${e.E1}`;if(e.H3+e.E3>e.H1)throw`err116: H3 ${e.H3} is too large compare to H1 ${e.H1} and E3 ${e.E3}`;if(e.H4+P>e.H2)throw`err119: H4 ${e.H4} is too large compare to H2 ${e.H2} and D4 ${e.D4}`;if(e.E4>P)throw`err122: E4 ${e.E4} is too large compare to D4 ${e.D4}`;if(e.D8<=e.D5)throw`err146: D8 ${e.D8} is too small compare to D5 ${e.D5}`;if(O<0)throw`err140: H2 ${e.H2} too small compare to L8 ${e.L8}, H4 ${e.H4} and D4 ${e.D4}`;if(Fe<e.R9)throw`err177: R9 ${e.R9} too large compare to doorHighX ${Fe} and L9 ${e.L9}`;if(e.L9>e.D1)throw`err180: L9 ${e.L9} too large compare to D1 ${e.D1}`;if(e.E6>e.D6/2)throw`err197: E6 ${e.E6} is too large compare to D6 ${e.D6}`;t.logstr+=`rake-L4: ${m(e.L4)} mm (compare with swing)
`,t.logstr+=`rake-L5: ${m(e.L5)} mm (compare with swing)
`,t.logstr+=`rake-L6: ${m(e.L6)} mm (compare with swing)
`,t.logstr+=`rake-beamL (4*L4+L5+2*L6): ${m(C)} mm (compare with swing)
`,t.logstr+=`cone-height: ${m(k)} mm
`,t.logstr+=`cone-height total: ${m(V)} mm
`,t.logstr+=`cone-angle: ${m(Ie(W))} degree
`,t.logstr+=`wing-angle: ${m(Ie(E))} degree
`;const qe=e.E1*Math.cos(W),Ze=e.E1*Math.sin(W),ge=e.E1*Math.tan(W/2),Ct=function(xe){return B(xe*L,0).addSegStrokeA(xe*L,e.H1).addSegStrokeA(xe*w,k).addSegStrokeA(xe*(w-qe),k-Ze).addSegStrokeA(xe*(L-e.E1),e.H1-ge).addSegStrokeA(xe*(L-e.E1),0).closeSegStroke()},ut=function(xe){return B(xe*L,0).addSegStrokeA(xe*L,e.H1).addSegStrokeA(xe*w,k).addSegStrokeA(xe*(w-qe),k-Ze).addSegStrokeA(xe*(L-e.E1),e.H1-ge).addSegStrokeA(xe*(L-e.E1),e.H1-e.H3).addSegStrokeA(xe*v,e.H1-e.H3).addSegStrokeA(xe*v,e.H1-e.H3-e.E3).addSegStrokeA(xe*(L-e.E1),e.H1-e.H3-e.E3).addSegStrokeA(xe*(L-e.E1),0).closeSegStroke()},Rt=M-P-(e.H1-ge),Gt=L-e.E1-Math.tan(W)*Rt,Ot=B(0,M-P).addSegStrokeA(Gt,M-P).addSegStrokeA(L-e.E1,e.H1-ge).addSegStrokeA(L-e.E1,e.H1-e.H3).addSegStrokeA(0,e.H1-e.H3).closeSegStroke(),It=sn(-de,e.H1+e.H6,e.L9,2*Fe,e.H7,e.R9);o.addMainO(Ct(1)),o.addSecond(ut(1)),o.addSecond(ut(-1)),o.addSecond(ue(-C/2,M,C,e.D4,0)),o.addSecond(ue(-C/2,M,C,R,0));for(const xe of G)o.addSecond(Ve(xe,M+X,e.L4,e.H5-X-F));o.addSecond($t(U,T,ce,2*z,_e)),o.addSecond($t(Se,Ee,ce,2*me,_e)),o.addSecond($t(-U,T,2*z,ce,E)),o.addSecond($t(-Se,Ee,2*me,ce,E)),o.addSecond(It),a.mergeFigure(o,!0),a.addMainO(Ot);const xt=[],Dt=B(q,M+X).addSegStrokeA(j,M+e.H5-Z).addSegStrokeA(y,M+e.H5-F).addPointA(-y,M+e.H5-F).addSegArc($,!1,!1).addSegStrokeA(-j,M+e.H5-Z).addSegStrokeA(-q,M+X).closeSegArc(P,!1,!1);xt.push(N(0,M,P)),xt.push(N(0,M,P-e.E4)),i.addSecond(ut(1)),i.addSecond(ut(-1)),i.addSecond(Dt),i.addSecond(N(0,M+e.H5,$)),i.addSecond(ue(0,e.H1+e.L8,O,2*z,c)),i.addSecond(ue(0,e.H1+e.L8,O,2*me,c)),i.addSecond(It),i.addMainOI(xt),r.addMainO(N(0,M,P-e.E4)),r.addSecond(N(0,M,P)),r.addSecond(Dt);const dt=[];dt.push(N(0,0,L)),dt.push(N(0,0,v));const At=v+e.L1,bt=2*Math.PI/e.N1;for(let xe=0;xe<e.N1;xe++){const et=At*Math.cos(xe*bt),mt=At*Math.sin(xe*bt);dt.push(N(et,mt,I))}d.addSecond(N(0,0,L-e.E1)),d.addSecond(N(0,0,w)),d.addSecond(ue(0,-C/2,C,e.D4,c)),d.addSecond(ue(0,-C/2,C,R,c));for(const xe of G)d.addSecond(ue(0,xe,e.L4,2*q,c)),d.addSecond(ue(0,xe,e.L4,2*y,c)),d.addSecond(ue(0,xe,e.L4,2*j,c));const Ht=L-e.L8*Math.tan(W);d.addSecond(ue(0,Ht,D,2*z,c)),d.addSecond(ue(0,Ht,D,2*me,c)),d.addSecond(ue(0,-Ht,D,2*z,S)),d.addSecond(ue(0,-Ht,D,2*me,S)),d.addMainOI(dt),u.addMainO(Dt),u.addSecond(N(0,M,P)),u.addSecond(N(0,M,P-e.E4)),u.addSecond(N(0,M+e.H5,$));const pt=[];pt.push(N(0,0,z)),pt.push(N(0,0,me)),l.addMainOI(pt),_.addSecond(N(0,0,z)),_.addMainO(N(0,0,me)),f.addMainO(It),f.addSecond(ut(1)),f.addSecond(ut(-1)),f.addSecond(ue(-C/2,M,C,e.D4,0)),f.addSecond(ue(-C/2,M,C,R,0));for(const xe of G)f.addSecond(Ve(xe,M+X,e.L4,e.H5-X-F));f.addSecond($t(U,T,ce,2*z,_e)),f.addSecond($t(Se,Ee,ce,2*me,_e)),f.addSecond($t(-U,T,2*z,ce,E)),f.addSecond($t(-Se,Ee,2*me,ce,E)),t.fig={faceCone:o,faceConeHollow:a,faceBeam:i,faceBeamHollow:r,faceDisc:d,faceHand:u,faceWing:l,faceWingHollow:_,faceDoor:f};const Le=t.partName,Jt=G.map((xe,et)=>({outName:`subpax_${Le}_hand_${et}`,face:`${Le}_faceHand`,extrudeMethod:se.eLinearOrtho,length:e.L4,rotate:[Math.PI/2,0,0],translate:[0,-xe,0]}));t.vol={extrudes:[{outName:`subpax_${Le}_cone`,face:`${Le}_faceCone`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${Le}_coneHollow`,face:`${Le}_faceConeHollow`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${Le}_beam`,face:`${Le}_faceBeam`,extrudeMethod:se.eLinearOrtho,length:C,rotate:[Math.PI/2,0,0],translate:[0,C/2,0]},{outName:`subpax_${Le}_beamHollow`,face:`${Le}_faceBeamHollow`,extrudeMethod:se.eLinearOrtho,length:C,rotate:[Math.PI/2,0,0],translate:[0,C/2,0]},{outName:`subpax_${Le}_disc`,face:`${Le}_faceDisc`,extrudeMethod:se.eLinearOrtho,length:e.E3,rotate:[0,0,0],translate:[0,0,e.H1-e.H3-e.E3]},{outName:`subpax_${Le}_wing_right`,face:`${Le}_faceWing`,extrudeMethod:se.eLinearOrtho,length:ce,rotate:[-E,0,0],translate:[0,K,ee]},{outName:`subpax_${Le}_wing_left`,face:`${Le}_faceWing`,extrudeMethod:se.eLinearOrtho,length:ce,rotate:[E,0,0],translate:[0,-K,ee]},{outName:`subpax_${Le}_wing_hollow_right`,face:`${Le}_faceWingHollow`,extrudeMethod:se.eLinearOrtho,length:ce,rotate:[-E,0,0],translate:[0,K,ee]},{outName:`subpax_${Le}_wing_hollow_left`,face:`${Le}_faceWingHollow`,extrudeMethod:se.eLinearOrtho,length:ce,rotate:[E,0,0],translate:[0,-K,ee]},{outName:`subpax_${Le}_door`,face:`${Le}_faceDoor`,extrudeMethod:se.eLinearOrtho,length:e.D1,rotate:[Math.PI/2,0,-Math.PI/2+Pe(e.doorOrientation)],translate:[0,0,0]},...Jt],volumes:[{outName:`ipax_${Le}_plus`,boolMethod:be.eUnion,inList:[`subpax_${Le}_cone`,`subpax_${Le}_beam`,`subpax_${Le}_disc`,`subpax_${Le}_hand_0`,`subpax_${Le}_hand_1`,`subpax_${Le}_hand_2`,`subpax_${Le}_hand_3`,`subpax_${Le}_wing_right`,`subpax_${Le}_wing_left`]},{outName:`ipax_${Le}_hollow`,boolMethod:be.eUnion,inList:[`subpax_${Le}_coneHollow`,`subpax_${Le}_beamHollow`,`subpax_${Le}_wing_hollow_right`,`subpax_${Le}_wing_hollow_left`,`subpax_${Le}_door`]},{outName:`pax_${Le}`,boolMethod:be.eSubstraction,inList:[`ipax_${Le}_plus`,`ipax_${Le}_hollow`]}]},t.sub={},t.logstr+=`heliostat-rake drawn successfully!
`,t.calcErr=!1}catch(h){t.logstr+=h,console.log(h)}return t}var Ss={pTitle:"Heliostat rake",pDescription:"The rake on top of the V-Axis of the heliostat",pDef:mo,pGeom:dr},js={partName:"spider",params:[s("D1","mm",100,1,400,1),s("L1","mm",400,1,1e3,1),s("L2","mm",400,1,1e3,1),s("L3","mm",100,1,400,1),s("L4","mm",3e3,10,8e3,10),te("longitude"),s("L5","mm",2e3,1,8e3,1),s("N1","",6,1,20,1),s("L6","mm",30,1,100,1),te("thickness"),s("E1","mm",3,1,80,1),s("E2","mm",50,1,200,1),s("E3","mm",3,1,80,1),s("R2","mm",100,0,400,10)],paramSvg:{D1:"spider_profile.svg",L1:"spider_profile.svg",L2:"spider_profile.svg",L3:"spider_profile.svg",L4:"spider_profile.svg",L5:"spider_lateral.svg",L6:"spider_lateral.svg",E1:"spider_profile.svg",E2:"spider_profile.svg",E3:"spider_profile.svg",R2:"spider_profile.svg",N1:"spider_lateral.svg"},sim:{tMax:360,tStep:.5,tUpdate:500}};function lr(n,e,g=""){const t=He(js.partName+g);let o,a;const i=J(),r=J(),d=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const u=e.D1/2;if(e.D1<e.E2)throw`err476: D1 ${e.D1} smaller then E2 ${e.E2}`;const l=e.E2/2,_=Math.sqrt(u**2-l**2),f=e.L1+e.L2*Math.sqrt(2),h=e.L2+e.L1*Math.sqrt(2),c=e.L4-h;if(c<e.R2)throw`err984: L4 ${e.L4} too small compare to R2 ${e.R2}`;const S=c*Math.cos(Math.PI/4),L=c*Math.sin(Math.PI/4),w=e.E2*Math.cos(Math.PI/4),v=e.E2*Math.sin(Math.PI/4),P=e.E2*Math.tan(Math.PI/8);if(u<e.E1)throw`err092: D1 ${e.D1} too small compare to E1 ${e.E1}`;if(e.L3<e.E2)throw`err994: L3 ${e.L3} smaller than E2 ${e.E2}`;if(e.L3<2*e.E3)throw`err997: L3 ${e.L3} too small compare to E3 ${e.E3}`;const $=(e.L3-e.E2)/2*Math.cos(Math.PI/4),z=f+S+$,I=-e.L1-L+$,p=I-e.E3*Math.sqrt(2);if(e.L5<e.N1*e.L6)throw`err110: L5 ${e.L5} too small compare to N1 ${e.N1} and L6 ${e.L6}`;let R=1;e.N1>1&&(R=(e.L5-e.L6)/(e.N1-1));const k=[...Array(e.N1).keys()].map(F=>F*R);o=function(F,j,Z){return B(F,j).addSegStrokeA(F+Z*Math.cos(Math.PI/4),j-Z*Math.sin(Math.PI/4)).addSegStrokeA(F,j-2*Z*Math.sin(Math.PI/4)).addSegStrokeA(F-Z*Math.cos(Math.PI/4),j-Z*Math.sin(Math.PI/4)).closeSegStroke()},a=function(F,j,Z,G){return B(Z,G).addSegStrokeA(Z+F,G).addSegStrokeA(Z+F,G+j).addSegStrokeA(Z,G+j).closeSegStroke()};const V=Math.sin(2*Math.PI*n/js.sim.tMax)*Math.PI/2;t.logstr+=`spide leg number: ${e.N1}
`,t.logstr+=`spide position angle: ${m(Ie(V))} degree
`;const C=[],M=B(l,-_).addCornerRounded(e.R2).addSegStrokeA(l,-e.L1).addCornerRounded(e.R2).addSegStrokeA(f,-e.L1).addCornerRounded(e.R2+e.E2).addSegStrokeA(f+S,-e.L1-L).addSegStrokeA(f+S-w,-e.L1-L-v).addSegStrokeA(f-P,-e.L1-e.E2).addCornerRounded(e.R2).addSegStrokeA(-f+P,-e.L1-e.E2).addCornerRounded(e.R2).addSegStrokeA(-f-S+w,-e.L1-L-v).addSegStrokeA(-f-S,-e.L1-L).addSegStrokeA(-f,-e.L1).addCornerRounded(e.R2+e.E2).addSegStrokeA(-l,-e.L1).addCornerRounded(e.R2).addSegStrokeA(-l,-_).addCornerRounded(e.R2).closeSegArc(u,!0,!1);C.push(M),C.push(N(0,0,u-e.E1)),i.addSecond(o(z,I,e.L3)),i.addSecond(o(z,p,e.L3-2*e.E3)),i.addSecond(o(-z,I,e.L3)),i.addSecond(o(-z,p,e.L3-2*e.E3)),i.addMainOI(C),r.addMainOI([N(0,0,u),N(0,0,u-e.E1)]),r.addMainOI([o(z,I,e.L3),o(z,p,e.L3-2*e.E3)]),r.addMainOI([o(-z,I,e.L3),o(-z,p,e.L3-2*e.E3)]),r.addSecond(M),d.addSecond(a(e.L5,e.D1,0,-e.D1/2)),d.addSecond(a(e.L5,e.L3,0,-e.L4-e.L3));for(const F of k)d.addSecond(a(e.L6,e.L4,F,-e.L4));t.fig={faceLegs:i.rotate(0,0,V),faceTube:r.rotate(0,0,V),faceBody:d};const q=t.partName,X=k.map((F,j)=>({outName:`subpax_${q}_leg_${j}`,face:`${q}_faceLegs`,extrudeMethod:se.eLinearOrtho,length:e.L6,rotate:[0,0,0],translate:[0,0,F]})),y=k.map((F,j)=>`subpax_${q}_leg_${j}`);t.vol={extrudes:[{outName:`subpax_${q}_tube`,face:`${q}_faceTube`,extrudeMethod:se.eLinearOrtho,length:e.L5,rotate:[0,0,0],translate:[0,0,0]},...X],volumes:[{outName:`pax_${q}`,boolMethod:be.eUnion,inList:[`subpax_${q}_tube`,...y]}]},t.sub={},t.logstr+=`heliostat-spider drawn successfully!
`,t.calcErr=!1}catch(u){t.logstr+=u,console.log(u)}return t}var Ws={pTitle:"Heliostat spider",pDescription:"The spider part for the control of the inclination of the heliostat",pDef:js,pGeom:lr},ko={partName:"swing",params:[s("L1","mm",12500,100,4e4,1),s("L2","mm",6e3,100,4e4,1),te("radial"),s("D1","mm",400,1,1e3,1),s("E1","mm",5,1,80,1),s("H2","mm",100,1,400,1),s("H4","mm",100,1,400,1),s("E2","mm",3,1,80,1),s("L3","mm",500,1,4e3,1),te("longitudinal"),s("L4","mm",600,1,4e3,1),s("L5","mm",2e3,1,1e4,1),s("L6","mm",2e3,1,1e4,1),s("H1","mm",100,1,400,1),s("H3","mm",100,1,400,1),s("E3","mm",3,1,80,1),te("buttress"),s("S1","mm",300,0,3e3,1),s("S2","mm",10,0,2e3,1),s("R2","mm",100,0,1e3,1),te("rod overlay"),s("rod1","",10,1,40,1),s("rod2","mm",1300,10,4e3,1),s("rod3","mm",400,10,1e3,1),s("rod4","mm",100,1,400,1)],paramSvg:{L1:"swing_top.svg",L2:"swing_top.svg",L3:"swing_top.svg",L4:"swing_top.svg",L5:"swing_top.svg",L6:"swing_top.svg",D1:"swing_top.svg",H1:"swing_top.svg",H2:"swing_top.svg",H3:"swing_side.svg",H4:"swing_side.svg",E1:"swing_side.svg",E2:"swing_side.svg",E3:"swing_face.svg",S1:"swing_buttress.svg",S2:"swing_buttress.svg",R2:"swing_buttress.svg",rod1:"swing_with_rod.svg",rod2:"swing_with_rod.svg",rod3:"swing_with_rod.svg",rod4:"swing_with_rod.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function cr(n,e,g=""){const t=He(ko.partName+g),o=J(),a=J(),i=J(),r=J(),d=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const u=e.D1/2,l=u+e.S2,_=4*e.L4+e.L5+2*e.L6-2*e.H1,f=e.L4-2*e.H1,h=e.L5+2*e.H1,c=e.L6+2*e.H1;t.logstr+=`swing size: L1 ${m(e.L1)} x L2 ${m(e.L2)} mm
`,t.logstr+=`rake-L4: ${m(f)} mm (compare with rake)
`,t.logstr+=`rake-L5: ${m(h)} mm (compare with rake)
`,t.logstr+=`rake-L6: ${m(c)} mm (compare with rake)
`,t.logstr+=`rake-beamL: (4*L4+L5+2*L6-2*H1) ${m(_)} mm (compare with rake)
`,o.addMainOI([N(0,0,u),N(0,0,u-e.E1)]);const S=[-e.L2/2,-e.L3-e.H2,e.L3,e.L2/2-e.H2];for(const y of S)o.addMainOI([Ve(y,l-e.H4,e.H2,e.H4),Ve(y+e.E2,l-e.H4+e.E2,e.H2-2*e.E2,e.H4-2*e.E2)]);o.addSecond(Ve(-e.L2/2,l,e.L2,e.H3));const L=[];L.push(-e.L1/2),L.push(e.L1/2-e.H1);for(const y of[-e.L5/2-2*e.L4-e.L6,-e.L5/2-e.L4,e.L5/2,e.L5/2+e.L4+e.L6])for(const F of[0,e.L4-e.H1])L.push(y+F);for(const y of L)a.addMainOI([Ve(y,l,e.H1,e.H3),Ve(y+e.E3,l+e.E3,e.H1-2*e.E3,e.H3-2*e.E3)]);a.addSecond(Ve(-e.L1/2,-u,e.L1,e.D1)),a.addSecond(Ve(-e.L1/2,l-e.H4,e.L1,e.H4));for(const y of L)i.addSecond(Ve(y,-e.L2/2,e.H1,e.L2));for(const y of S)i.addSecond(Ve(-e.L1/2,y,e.L1,e.H2));i.addSecond(Ve(-e.L1/2,-u,e.L1,e.D1));const w=Math.sqrt(l**2+e.S1**2),v=Math.acos(u/w),P=Math.atan2(e.S1,l),$=ie(0,0),I=$.translatePolar(Math.PI/2+P,u).rotate($,v),p=B(-e.L3,l).addSegStrokeA(-e.S1,l).addCornerRounded(e.R2).addSegStrokeA(I.cx,I.cy).addPointA(0,-u).addPointA(-I.cx,I.cy).addSegArc2().addSegStrokeA(e.S1,l).addCornerRounded(e.R2).addSegStrokeA(e.L3,l).addSegStrokeA(e.L3,l+e.E3).addSegStrokeA(-e.L3,l+e.E3).closeSegStroke();r.addMainOI([p,N(0,0,u-e.E1)]),o.addSecond(p);for(const y of L)d.addMainO(Ve(y,-e.L2/2,e.H1,e.L2));for(const y of S)d.addMainO(Ve(-e.L1/2,y,e.L1,e.H2));d.addMainO(Ve(-e.L1/2,-u,e.L1,e.D1));const R=-((e.rod1-1)*e.rod2+e.rod3)/2,k=(e.rod3-e.rod4)/2,V=e.rod3/2,C=1.2*e.L2,M=(C-V)/3,q=-C/2;for(let y=0;y<e.rod1;y++){const F=R+y*e.rod2;d.addSecond(Ve(F+k,q,e.rod4,C));for(let j=0;j<4;j++)d.addSecond(Ve(F,q+j*M,e.rod3,V,V/4))}t.fig={faceSide:o,faceFace:a,faceTop:i,faceButtress:r,faceTopWithRods:d};const X=t.partName;t.vol={extrudes:[{outName:`subpax_${X}_side`,face:`${X}_faceSide`,extrudeMethod:se.eLinearOrtho,length:e.L1,rotate:[0,0,0],translate:[0,0,-e.L1/2]},{outName:`subpax_${X}_face`,face:`${X}_faceFace`,extrudeMethod:se.eLinearOrtho,length:e.L2,rotate:[0,Math.PI/2,0],translate:[-e.L2/2,0,0]},...L.map((y,F)=>({outName:`subpax_${X}_buttress_${F}`,face:`${X}_faceButtress`,extrudeMethod:se.eLinearOrtho,length:e.H1,rotate:[0,0,0],translate:[0,0,y]}))],volumes:[{outName:`pax_${X}`,boolMethod:be.eUnion,inList:[`subpax_${X}_side`,`subpax_${X}_face`,...L.map((y,F)=>`subpax_${X}_buttress_${F}`)]}]},t.sub={},t.logstr+=`heliostat-swing drawn successfully!
`,t.calcErr=!1}catch(u){t.logstr+=u,console.log(u)}return t}var Ls={pTitle:"Heliostat swing",pDescription:"The swing for the heliostat inclination",pDef:ko,pGeom:cr},qs={partName:"heliostat",params:[s("H1","mm",3e3,10,4e4,1),s("H2","mm",2500,50,4e4,1),s("D1","mm",1e3,20,4e3,1),s("D2","mm",700,20,4e3,1),s("E1","mm",30,1,80,1),te("rake"),s("H3","mm",200,1,500,1),s("H4","mm",800,1,4e3,1),s("H5","mm",3e3,50,6e3,1),s("H6","mm",200,1,4e3,1),s("H7","mm",800,1,4e3,1),s("H8","mm",200,1,4e3,1),s("D3","mm",900,20,4e3,1),s("D4","mm",400,20,4e3,1),s("D5","mm",300,20,1e3,1),s("D6","mm",200,10,1e3,1),s("D7","mm",400,10,1e3,1),te("rake diagonal"),s("D9","mm",100,1,1e3,1),s("L7","mm",100,1,1e3,1),s("L8","mm",200,1,1e3,1),te("spider"),s("D8","mm",100,1,1e3,1),s("S1","mm",250,1,800,1),s("S2","mm",200,1,800,1),s("E2","mm",50,1,80,1),te("swing"),s("L1","mm",12500,100,4e4,1),s("L2","mm",6e3,100,4e4,1),s("L3","mm",100,1,500,1),s("L4","mm",600,1,4e3,1),s("L5","mm",2e3,10,6e3,1),s("L6","mm",2e3,1,6e3,1),s("H9","mm",100,1,400,1),te("motion amplitude"),s("al","degree",80,0,95,1),s("ar","degree",80,0,95,1)],paramSvg:{H1:"heliostat_overview.svg",H2:"heliostat_side.svg",H3:"heliostat_side_sizing.svg",H4:"heliostat_side_sizing.svg",H5:"heliostat_side_sizing.svg",H6:"heliostat_side_sizing.svg",H7:"heliostat_side_sizing.svg",H8:"heliostat_side_sizing.svg",H9:"heliostat_side_sizing.svg",D1:"heliostat_side_sizing.svg",D2:"heliostat_side_sizing.svg",D3:"heliostat_side_sizing.svg",D4:"heliostat_side_sizing.svg",D5:"heliostat_side_sizing.svg",D6:"heliostat_side_sizing.svg",D7:"heliostat_side_sizing.svg",D8:"heliostat_side_sizing.svg",D9:"heliostat_face_sizing.svg",S1:"heliostat_side_sizing.svg",S2:"heliostat_side_sizing.svg",E1:"heliostat_side_sizing.svg",E2:"heliostat_side_sizing.svg",L1:"heliostat_face_sizing.svg",L2:"heliostat_side_sizing.svg",L3:"heliostat_face_sizing.svg",L4:"heliostat_face_sizing.svg",L5:"heliostat_face_sizing.svg",L6:"heliostat_face_sizing.svg",L7:"heliostat_face_sizing.svg",L8:"heliostat_face_sizing.svg",al:"heliostat_side_sizing.svg",ar:"heliostat_side_sizing.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function gr(n,e,g=""){const t=He(qs.partName+g),o=J(),a=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const i=e.H1+e.H2-e.H3+e.H4+e.H5-e.H6+e.H7;t.logstr+=`heliostat-height: ${m(i)}, diameter ${m(e.D1)} m
`,t.logstr+=`heliostat-swing-length: ${m(e.L1)}, width ${m(e.L2)} m
`;const d=(e.al-e.ar)/2-Math.sin(2*Math.PI*n/qs.sim.tMax)*(e.al+e.ar)/2,u=Pe(d);t.logstr+=`swing position angle: ${m(Ie(u))} degree
`;const l=e.H1+e.H2-e.H3,_=l+e.H4+e.H5-e.H6+e.H7,f=_+e.H8,h=_t(vs.pDef),c=_t(Ss.pDef),S=_t(Ws.pDef),L=_t(Ls.pDef);h.setVal("H1",e.H1),h.setVal("H2",e.H2),h.setVal("D1",e.D1),h.setVal("D2",e.D2),h.setVal("D3",e.D1-6*e.E1),h.setVal("E1",e.E1),h.setVal("E2",e.E1);const w=32,v=(e.D1-6*e.E1)/(w*4);h.setVal("N1",w),h.setVal("D5",v),h.setVal("L1",e.E1+v/2),h.setVal("H3",e.H1/4),h.setVal("H4",e.H1/2),h.setVal("D4",e.H1/4),h.setVal("L2",e.H1/80),h.setVal("E3",e.H1/80),h.setVal("holders",0),c.setVal("H1",e.H4),c.setVal("H2",e.H5),c.setVal("H3",e.H4-2*e.E1),c.setVal("D1",e.D3),c.setVal("D2",e.D4),c.setVal("L9",e.D3/2),c.setVal("H7",e.D3/2*1.6),c.setVal("H6",e.D3/20),c.setVal("R9",e.D3/20),c.setVal("E1",e.E1),c.setVal("E3",e.E1),c.setVal("E4",e.E1),c.setVal("E6",e.E1);const P=e.D2*.6,$=24,z=P/($*4);if(c.setVal("D3",P),e.D2>e.D3-2*e.E1)throw`err153: D2 ${e.D2} too large compare to D3 ${e.D3} and E1 ${e.E1}`;if(c.setVal("N1",$),c.setVal("D7",z),c.setVal("L1",z),c.setVal("H4",e.H6),c.setVal("D4",e.D5),c.setVal("L7",e.L7),c.setVal("L8",e.L8),c.setVal("D6",e.D9),c.setVal("H5",e.H7+e.H8),c.setVal("D5",e.D6),c.setVal("D8",e.D7),e.D6>=e.D7)throw`err164: D6 ${e.D6} too large compare to D7 ${e.D7}`;const I=e.L4-2*e.L3;if(c.setVal("L4",I),I<=0)throw`err169: L3 ${e.L3} too large compare to L4 ${e.L4}`;c.setVal("L5",e.L5+2*e.L3),c.setVal("L6",e.L6+2*e.L3);const p=e.L5*.96,R=6;if(S.setVal("L5",p),S.setVal("D1",e.D8),S.setVal("L1",e.S1),S.setVal("L2",e.S2),S.setVal("L3",e.E2*2),S.setVal("E1",e.E1),S.setVal("E2",e.E2),S.setVal("E3",e.E1),S.setVal("L4",e.L2/2-e.H8),S.setVal("R2",0),S.setVal("N1",R),S.setVal("L6",p/(R*10)),L.setVal("L2",e.L2),L.setVal("D1",e.D6),L.setVal("H3",e.H9),L.setVal("H4",e.H9),L.setVal("L1",e.L1),e.L1<4*e.L4+2*e.L6+e.L5+2*e.L3)throw`err185: L1 ${e.L1} too small compare to L4 ${e.L4}, L5 ${e.L5}, L6 ${e.L6}`;L.setVal("H1",e.L3),L.setVal("H2",e.L3),L.setVal("L4",e.L4),L.setVal("L5",e.L5),L.setVal("L6",e.L6),L.setVal("L3",e.D7),L.setVal("S1",e.D6/2),L.setVal("R2",0);const k=vs.pGeom(0,h.getParamVal(),h.getSuffix());vt(k),t.logstr+=St(k.logstr,h.getPartNameSuffix());const V=Ss.pGeom(0,c.getParamVal(),c.getSuffix());vt(V),t.logstr+=St(V.logstr,c.getPartNameSuffix());const C=Ws.pGeom(0,S.getParamVal(),S.getSuffix());vt(C),t.logstr+=St(C.logstr,S.getPartNameSuffix());const M=Ls.pGeom(0,L.getParamVal(),L.getSuffix());vt(M),t.logstr+=St(M.logstr,L.getPartNameSuffix()),o.mergeFigure(k.fig.poleCut),o.mergeFigure(V.fig.faceBeam.translate(0,l)),o.mergeFigure(C.fig.faceLegs.translate(0,_).rotate(0,_,u/2)),o.mergeFigure(M.fig.faceSide.translate(0,f).rotate(0,f,u)),a.mergeFigure(k.fig.poleCut),a.mergeFigure(V.fig.faceCone.translate(0,l)),a.mergeFigure(C.fig.faceBody.translate(-p/2,_)),a.mergeFigure(M.fig.faceFace.translate(0,f)),t.fig={faceSide:o,faceFace:a};const q=t.partName;t.vol={inherits:[{outName:`inpax_${q}_poleStatic`,subdesign:"pax_pole_static",subgeom:k,rotate:[0,0,0],translate:[0,0,0]},{outName:`inpax_${q}_rake`,subdesign:"pax_rake",subgeom:V,rotate:[0,0,0],translate:[0,0,l]},{outName:`inpax_${q}_swing`,subdesign:"pax_swing",subgeom:M,rotate:[Math.PI/2,0,0],translate:[0,0,f]},{outName:`inpax_${q}_spider`,subdesign:"pax_spider",subgeom:C,rotate:[Math.PI/2,0,0],translate:[0,p/2,_]}],extrudes:[],volumes:[{outName:`pax_${q}`,boolMethod:be.eUnion,inList:[`inpax_${q}_poleStatic`,`inpax_${q}_rake`,`inpax_${q}_swing`,`inpax_${q}_spider`]}]};const X={partName:h.getPartName(),dparam:h.getDesignParamList(),orientation:[0,0,0],position:[0,0,0]},y={partName:c.getPartName(),dparam:c.getDesignParamList(),orientation:[0,0,0],position:[0,0,l]},F={partName:S.getPartName(),dparam:S.getDesignParamList(),orientation:[Math.PI/2,0,0],position:[0,p/2,_]},j={partName:L.getPartName(),dparam:L.getDesignParamList(),orientation:[Math.PI/2,0,0],position:[0,0,f]};t.sub={pole_static_1:X,rake_1:y,spider_1:F,swing_1:j},t.logstr+=`heliostat-overview drawn successfully!
`,t.calcErr=!1}catch(i){t.logstr+=i,console.log(i)}return t}var ur={pTitle:"Heliostat overview",pDescription:"The heliostat inclination mechanism",pDef:qs,pGeom:gr},wo={partName:"rake_stopper",params:[s("D1","mm",600,10,4e3,1),s("D2","mm",400,10,4e3,1),s("D3","mm",400,1,4e3,1),s("H1","mm",800,1,4e3,1),s("H2","mm",3e3,20,6e3,1),s("H3","mm",400,0,4e3,1),s("E1","mm",20,1,80,1),s("E3","mm",30,1,80,1),te("transversal"),s("H4","mm",200,1,1e3,1),s("D4","mm",300,1,1e3,1),s("E4","mm",20,1,80,1),s("H5","mm",400,1,2e3,1),s("D5","mm",200,1,1e3,1),s("L4","mm",300,1,1e3,1),s("L5","mm",2e3,1,4e3,1),s("L6","mm",2e3,1,4e3,1),s("D8","mm",400,1,1e3,1),te("diagonal"),s("D6","mm",100,1,600,1),s("E6","mm",10,1,80,1),s("L7","mm",100,1,1e3,1),s("L8","mm",200,1,1e3,1),te("base"),s("N1","",24,3,100,1),s("D7","mm",40,1,100,1),s("L1","mm",30,1,300,1),te("door"),s("H6","mm",100,1,1e3,1),s("H7","mm",600,1,2e3,1),s("L9","mm",300,1,1e3,1),s("R9","mm",50,0,300,1),s("doorOrientation","degree",0,-180,180,1),te("stoppers"),s("S1","mm",100,1,300,1),s("S2","mm",2e3,1,8e3,1),s("S3","mm",100,0,8e3,1),s("E7","mm",5,1,80,1),te("low stopper"),s("JD1","mm",200,1,500,1),s("JE1","mm",5,1,80,1),s("JL1","mm",260,1,2e3,1),s("JH1","mm",20,-500,500,1),s("JS1","mm",100,1,500,1),s("JS2","mm",200,1,500,1),te("high stopper"),s("JD3","mm",200,1,500,1),s("JE3","mm",5,1,80,1),s("JS3","mm",120,1,500,1),s("JD4","mm",200,1,500,1),s("JE4","mm",5,1,80,1),s("JS4","mm",120,1,500,1)],paramSvg:{D1:"rake_face.svg",D2:"rake_side.svg",D3:"rake_face.svg",H1:"rake_face.svg",H2:"rake_face.svg",H3:"rake_face.svg",E1:"rake_face.svg",E3:"rake_face.svg",H4:"rake_side.svg",D4:"rake_side.svg",E4:"rake_side.svg",H5:"rake_side.svg",D5:"rake_side.svg",L4:"rake_face.svg",L5:"rake_face.svg",L6:"rake_face.svg",D6:"rake_face.svg",E6:"rake_face.svg",L7:"rake_face.svg",L8:"rake_face.svg",N1:"rake_top.svg",D7:"rake_top.svg",L1:"rake_top.svg",D8:"rake_side.svg",H6:"rake_door.svg",H7:"rake_door.svg",L9:"rake_door.svg",R9:"rake_door.svg",doorOrientation:"rake_door.svg",S1:"rake_side_stopper.svg",S2:"rake_top_stopper.svg",S3:"rake_side_stopper.svg",E7:"rake_side_stopper.svg",JD1:"rake_low_stopper_holder.svg",JE1:"rake_low_stopper_holder.svg",JL1:"rake_low_stopper_holder.svg",JH1:"rake_low_stopper_holder.svg",JS1:"rake_side_stopper.svg",JS2:"rake_top_stopper.svg",JD3:"rake_side_stopper.svg",JE3:"rake_side_stopper.svg",JS3:"rake_top_stopper.svg",JD4:"rake_top_stopper.svg",JE4:"rake_top_stopper.svg",JS4:"rake_side_stopper.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function hr(n,e,g=""){const t=He(wo.partName+g),o=J(),a=J(),i=J(),r=J(),d=J(),u=J(),l=J(),_=J(),f=J(),h=J(),c=J(),S=J(),L=J(),w=J(),v=J(),P=J(),$=J(),z=J(),I=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const R=Math.PI,k=Math.PI/2,V=-Math.PI/2,C=e.D1/2,M=e.H1+e.H2,q=M-e.H4+e.H5,X=q-e.S2,y=e.H1+e.H2-e.H4,F=y+e.D4/2,j=e.H1+e.S3,Z=e.L5/2,G=e.S1/2,O=e.S1-2*e.E7,W=O/2,D=e.S2-G,Y=X-e.JH1,E=e.JD1/2,Q=E-e.JE1,ce=C+e.JS2,U=Z-G,T=C+e.JS3,K=e.JD3-2*e.JE3,ee=e.D4/2+e.JS4,me=e.JD4-2*e.JE4;if(2*e.E7>=e.S1)throw`err135: E7 ${e.E7} too large compare to S1 ${e.S1}`;if(e.L5<e.D2)throw`err138: L5 ${e.L5} too small compare to D2 ${e.D2}`;if(X-e.JH1-e.JD1/2<0)throw`err143: S2 ${e.S2} too large compare to H1H5 ${m(q)}`;if(e.JS1<e.S1/2)throw`err144: JS1 ${e.JS1} too small compare to S1 ${e.S1}`;if(e.JE1>e.JD1/2)throw`err145: JE1 ${e.JE1} too large compare to JD1 ${e.JD1}`;if(e.JL1>e.D1)throw`err146: JL1 ${e.JL1} too large compare to D1 ${e.D1}`;if(e.JL1<e.JD1)throw`err147: JL1 ${e.JL1} too small compare to JD1 ${e.JD1}`;if(Math.abs(e.JH1)>e.JD1/2+G)throw`err148: JH1 ${e.JH1} too large compare to JD1 ${e.JD1} and S1 ${e.S1}`;if(e.JS2<e.JS1-G)throw`err149: JS2 ${e.JS2} too small compare to JS1 ${e.JS1} and S1 ${e.S1}`;if(e.S3>e.H2-e.H4)throw`err150: S3 ${e.S3} too large compare to H2 ${e.H2} and H4 ${e.H4}`;if(e.JE3>e.JD3/2)throw`err151: JE3 ${e.JE3} too large compare to JD3 ${e.JD3}`;if(e.JE4>e.JD4/2)throw`err152: JE4 ${e.JE4} too large compare to JD4 ${e.JD4}`;t.logstr+=`cone-height: ${m(M)} mm
`,t.logstr+=`cone-height total: ${m(q)} mm
`;const Se=[],Ee=[];P.addSecond(ue(-Z,X,e.L5,e.S1,0)),P.addSecond(ue(-Z,X,e.L5,O,0)),Se.push(N(-e.JL1/2,Y,E)),Se.push(N(-e.JL1/2,Y,Q)),Ee.push(N(e.JL1/2,Y,E)),Ee.push(N(e.JL1/2,Y,Q)),P.addMainOI(Se),P.addMainOI(Ee);const _e=_t(Ss.pDef);_e.setVal("D1",e.D1),_e.setVal("D2",e.D2),_e.setVal("D3",e.D3),_e.setVal("H1",e.H1),_e.setVal("H2",e.H2),_e.setVal("H3",e.H3),_e.setVal("E1",e.E1),_e.setVal("E3",e.E3),_e.setVal("H4",e.H4),_e.setVal("D4",e.D4),_e.setVal("E4",e.E4),_e.setVal("H5",e.H5),_e.setVal("D5",e.D5),_e.setVal("L4",e.L4),_e.setVal("L5",e.L5),_e.setVal("L6",e.L6),_e.setVal("D6",e.D6),_e.setVal("E6",e.E6),_e.setVal("L7",e.L7),_e.setVal("L8",e.L8),_e.setVal("N1",e.N1),_e.setVal("D7",e.D7),_e.setVal("L1",e.L1),_e.setVal("D8",e.D8),_e.setVal("H6",e.H6),_e.setVal("H7",e.H7),_e.setVal("L9",e.L9),_e.setVal("R9",e.R9),_e.setVal("doorOrientation",e.doorOrientation);const de=Ss.pGeom(0,_e.getParamVal(),_e.getSuffix());vt(de),t.logstr+=St(de.logstr,_e.getPartNameSuffix()),o.mergeFigure(de.fig.faceCone),o.mergeFigure(P,!0),a.mergeFigure(de.fig.faceBeam),i.mergeFigure(de.fig.faceBeamHollow),r.mergeFigure(de.fig.faceDisc),d.mergeFigure(de.fig.faceHand),u.mergeFigure(de.fig.faceWing),l.mergeFigure(de.fig.faceWingHollow),_.mergeFigure(de.fig.faceDoor),_.mergeFigure(P,!0),f.mergeFigure(de.fig.faceDisc,!0),f.addMainOI([ue(-C-e.JS1,-Z,e.L5,e.S1,k),ue(-C-e.JS1,-Z,e.L5,O,k)]),f.addMainOI([ue(D,-Z,e.L5,e.S1,k),ue(D,-Z,e.L5,O,k)]),f.addMainOI([ue(0,-Z+G,D,e.S1,0),ue(0,-Z+G,D,O,0)]),f.addMainOI([ue(0,Z-G,D,e.S1,0),ue(0,Z-G,D,O,0)]),f.addMainOI([ue(0,-C-G,D,e.S1,0),ue(0,-C-G,D,O,0)]),f.addMainOI([ue(0,C+G,D,e.S1,0),ue(0,C+G,D,O,0)]),f.addSecond(ue(0,-e.JL1/2,ce,2*E,R)),f.addSecond(ue(0,-e.JL1/2,ce,2*Q,R)),f.addSecond(ue(0,e.JL1/2,ce,2*E,R)),f.addSecond(ue(0,e.JL1/2,ce,2*Q,R)),f.addSecond(ue(0,0,T,e.JD3,V)),f.addSecond(ue(0,0,T,K,V)),f.addSecond(ue(0,0,T,e.JD3,k)),f.addSecond(ue(0,0,T,K,k)),h.mergeFigure(de.fig.faceBeam,!0),h.addMainOI([N(-C-e.JS1,X,G),N(-C-e.JS1,X,W)]),h.addMainOI([N(D,F+G,G),N(D,F+G,W)]),h.addSecond(ue(0,F+G,D,e.S1,0)),h.addSecond(ue(0,F+G,D,O,0));const Fe=F+G-j,qe=Math.sqrt(D**2+Fe**2),Ze=Math.atan2(Fe,D);t.logstr+=`stopper-rod: L ${m(qe)} mm, A ${m(Ie(Ze))} degree
`,h.addSecond(ue(0,j,qe,e.S1,Ze)),h.addSecond(ue(0,j,qe,O,Ze)),h.addSecond(ue(0,Y,ce,2*E,R)),h.addSecond(ue(0,Y,ce,2*Q,R)),h.addSecond(N(0,j,e.JD3/2)),h.addSecond(N(0,j,e.JD3/2-e.JE3)),h.addSecond(ue(0,y,ee,e.JD4,k)),h.addSecond(ue(0,y,ee,me,k)),c.mergeFigure(h,!0),c.addMainO(N(-C-e.JS1,X,W)),c.addMainO(N(e.S2-G,F+G,W)),S.mergeFigure(de.fig.faceCone,!0),S.mergeFigure(P,!0),S.addMainOI([N(-e.L5/2+G,F+G,G),N(-e.L5/2+G,F+G,W)]),S.addMainOI([N(e.L5/2-G,F+G,G),N(e.L5/2-G,F+G,W)]),L.mergeFigure(de.fig.faceCone,!0),L.mergeFigure(P,!0),L.addSecond(N(-e.L5/2+G,F+G,G)),L.addMainO(N(-e.L5/2+G,F+G,W)),L.addSecond(N(e.L5/2-G,F+G,G)),L.addMainO(N(e.L5/2-G,F+G,W)),w.mergeFigure(de.fig.faceCone,!0),w.mergeFigure(P,!0),w.addMainOI([N(-C-G,0,G),N(-C-G,0,W)]),w.addMainOI([N(C+G,0,G),N(C+G,0,W)]),v.mergeFigure(de.fig.faceCone,!0),v.mergeFigure(P,!0),v.addSecond(N(-C-G,0,G)),v.addMainO(N(-C-G,0,W)),v.addSecond(N(C+G,0,G)),v.addMainO(N(C+G,0,W)),$.mergeFigure(de.fig.faceCone,!0),$.mergeFigure(P),$.addSecond(ue(-U,y,ee,e.JD4,k)),$.addSecond(ue(-U,y,ee,me,k)),$.addSecond(ue(U,y,ee,e.JD4,k)),$.addSecond(ue(U,y,ee,me,k)),$.addSecond(ue(0,j,T,e.JD3,R)),$.addSecond(ue(0,j,T,K,R)),$.addSecond(ue(0,j,T,e.JD3,0)),$.addSecond(ue(0,j,T,K,0)),z.mergeFigure(h,!0),z.addMainOI([N(0,j,e.JD3/2),N(0,j,e.JD3/2-e.JE3)]),I.mergeFigure(f,!0),I.addMainOI([N(0,-U,e.JD4/2),N(0,-U,e.JD4/2-e.JE4)]),I.addMainOI([N(0,U,e.JD4/2),N(0,U,e.JD4/2-e.JE4)]),t.fig={faceCone:o,faceBeam:a,faceBeamHollow:i,faceDisc:r,faceHand:d,faceWing:u,faceWingHollow:l,faceDoor:_,faceStopperTop:f,faceStopperSide:h,faceStopperSideH:c,faceStopperFaceT:S,faceStopperFaceTH:L,faceStopperFaceB:w,faceStopperFaceBH:v,faceLowStopperHolder:$,faceHi1StopperHolder:z,faceHi2StopperHolder:I};const ge=t.partName;t.vol={inherits:[{outName:`inpax_${ge}_rake`,subdesign:"pax_rake",subgeom:de,rotate:[0,0,0],translate:[0,0,0]},{outName:`inpax_${ge}_coneHollow`,subdesign:"subpax_rake_coneHollow",subgeom:de,rotate:[0,0,0],translate:[0,0,0]},{outName:`inpax_${ge}_beamHollow`,subdesign:"subpax_rake_beamHollow",subgeom:de,rotate:[0,0,0],translate:[0,0,0]}],extrudes:[{outName:`subpax_${ge}_stpSide`,face:`${ge}_faceStopperSide`,extrudeMethod:se.eLinearOrtho,length:e.L5,rotate:[Math.PI/2,0,0],translate:[0,e.L5/2,0]},{outName:`subpax_${ge}_stpSideH`,face:`${ge}_faceStopperSideH`,extrudeMethod:se.eLinearOrtho,length:e.L5,rotate:[Math.PI/2,0,0],translate:[0,e.L5/2,0]},{outName:`subpax_${ge}_stpFaceT`,face:`${ge}_faceStopperFaceT`,extrudeMethod:se.eLinearOrtho,length:D,rotate:[Math.PI/2,0,Math.PI/2],translate:[0,0,0]},{outName:`subpax_${ge}_stpFaceTH`,face:`${ge}_faceStopperFaceTH`,extrudeMethod:se.eLinearOrtho,length:D,rotate:[Math.PI/2,0,Math.PI/2],translate:[0,0,0]},{outName:`subpax_${ge}_stpFaceB`,face:`${ge}_faceStopperFaceB`,extrudeMethod:se.eLinearOrtho,length:qe,rotate:[Math.PI/2-Ze,0,Math.PI/2],translate:[0,0,j]},{outName:`subpax_${ge}_stpFaceBH`,face:`${ge}_faceStopperFaceBH`,extrudeMethod:se.eLinearOrtho,length:qe,rotate:[Math.PI/2-Ze,0,Math.PI/2],translate:[0,0,j]},{outName:`subpax_${ge}_lowSH`,face:`${ge}_faceLowStopperHolder`,extrudeMethod:se.eLinearOrtho,length:ce,rotate:[Math.PI/2,0,-Math.PI/2],translate:[0,0,0]},{outName:`subpax_${ge}_Hi1SH1`,face:`${ge}_faceHi1StopperHolder`,extrudeMethod:se.eLinearOrtho,length:T,rotate:[Math.PI/2,0,0],translate:[0,0,0]},{outName:`subpax_${ge}_Hi1SH2`,face:`${ge}_faceHi1StopperHolder`,extrudeMethod:se.eLinearOrtho,length:T,rotate:[Math.PI/2,0,Math.PI],translate:[0,0,0]},{outName:`subpax_${ge}_Hi2SH`,face:`${ge}_faceHi2StopperHolder`,extrudeMethod:se.eLinearOrtho,length:ee,rotate:[0,0,0],translate:[0,0,y]}],volumes:[{outName:`ipax_${ge}_plus`,boolMethod:be.eUnion,inList:[`subpax_${ge}_stpSide`,`subpax_${ge}_stpFaceT`,`subpax_${ge}_stpFaceB`,`subpax_${ge}_lowSH`,`subpax_${ge}_Hi1SH1`,`subpax_${ge}_Hi1SH2`,`subpax_${ge}_Hi2SH`]},{outName:`ipax_${ge}_hollow`,boolMethod:be.eUnion,inList:[`inpax_${ge}_coneHollow`,`inpax_${ge}_beamHollow`,`subpax_${ge}_stpSideH`,`subpax_${ge}_stpFaceTH`,`subpax_${ge}_stpFaceBH`]},{outName:`ipax_${ge}_stopper`,boolMethod:be.eSubstraction,inList:[`ipax_${ge}_plus`,`ipax_${ge}_hollow`]},{outName:`pax_${ge}`,boolMethod:be.eUnion,inList:[`inpax_${ge}_rake`,`ipax_${ge}_stopper`]}]},t.sub={},t.logstr+=`heliostat-rake drawn successfully!
`,t.calcErr=!1}catch(p){t.logstr+=p,console.log(p)}return t}var Xs={pTitle:"Heliostat rake with stopper",pDescription:"The rake-stopper on top of the V-Axis of the heliostat",pDef:wo,pGeom:hr},Ys={partName:"heliostat_2",params:[s("H1","mm",3e3,10,4e4,1),s("H2","mm",2500,50,4e4,1),s("D1","mm",1e3,20,4e3,1),s("D2","mm",700,20,4e3,1),s("E1","mm",30,1,80,1),te("rake"),s("H3","mm",200,1,500,1),s("H4","mm",800,1,4e3,1),s("H5","mm",3e3,50,6e3,1),s("H6","mm",200,1,4e3,1),s("H7","mm",400,1,4e3,1),s("D3","mm",900,20,4e3,1),s("D4","mm",400,20,4e3,1),s("D5","mm",300,20,1e3,1),s("D6","mm",200,10,1e3,1),s("D7","mm",400,10,1e3,1),te("rake diagonal"),s("D9","mm",100,1,1e3,1),s("L7","mm",100,1,1e3,1),s("L8","mm",200,1,1e3,1),te("rake stopper"),s("S1","mm",100,1,800,1),te("swing"),s("L1","mm",12500,100,4e4,1),s("L2","mm",6e3,100,4e4,1),s("L3","mm",100,1,500,1),s("L4","mm",600,1,4e3,1),s("L5","mm",2e3,10,6e3,1),s("L6","mm",2e3,1,6e3,1),s("H9","mm",100,1,400,1),s("S2","mm",10,0,2e3,1),te("motion amplitude"),s("al","degree",80,0,95,1)],paramSvg:{H1:"heliostat_overview.svg",H2:"heliostat_side.svg",H3:"heliostat2_side_sizing.svg",H4:"heliostat2_side_sizing.svg",H5:"heliostat2_side_sizing.svg",H6:"heliostat2_side_sizing.svg",H7:"heliostat2_side_sizing.svg",H9:"heliostat2_side_sizing.svg",D1:"heliostat2_side_sizing.svg",D2:"heliostat2_side_sizing.svg",D3:"heliostat2_side_sizing.svg",D4:"heliostat2_side_sizing.svg",D5:"heliostat2_side_sizing.svg",D6:"heliostat2_side_sizing.svg",D7:"heliostat2_side_sizing.svg",D9:"heliostat2_face_sizing.svg",E1:"heliostat2_side_sizing.svg",L1:"heliostat2_face_sizing.svg",L2:"heliostat2_side_sizing.svg",L3:"heliostat2_face_sizing.svg",L4:"heliostat2_face_sizing.svg",L5:"heliostat2_face_sizing.svg",L6:"heliostat2_face_sizing.svg",L7:"heliostat2_face_sizing.svg",L8:"heliostat2_face_sizing.svg",S1:"heliostat2_side_sizing.svg",S2:"heliostat2_side_sizing.svg",al:"heliostat2_side_sizing.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function fr(n,e,g=""){const t=He(Ys.partName+g),o=J(),a=J(),i=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const r=e.H1+e.H2-e.H3+e.H4+e.H5-e.H6+e.H7;t.logstr+=`heliostat-height: ${m(r)}, diameter ${m(e.D1)} m
`,t.logstr+=`heliostat-swing-length: ${m(e.L1)}, width ${m(e.L2)} m
`;const d=e.al*n/Ys.sim.tMax,u=Pe(d);t.logstr+=`swing position angle: ${m(Ie(u))} degree
`;const l=e.H1+e.H2-e.H3,_=l+e.H4+e.H5-e.H6+e.H7,f=_t(vs.pDef),h=_t(Xs.pDef),c=_t(Ls.pDef);f.setVal("H1",e.H1),f.setVal("H2",e.H2),f.setVal("D1",e.D1),f.setVal("D2",e.D2),f.setVal("D3",e.D1-6*e.E1),f.setVal("E1",e.E1),f.setVal("E2",e.E1);const S=32,L=(e.D1-6*e.E1)/(S*4);f.setVal("N1",S),f.setVal("D5",L),f.setVal("L1",e.E1+L/2),f.setVal("H3",e.H1/4),f.setVal("H4",e.H1/2),f.setVal("D4",e.H1/4),f.setVal("L2",e.H1/80),f.setVal("E3",e.H1/80),f.setVal("holders",0),h.setVal("H1",e.H4),h.setVal("H2",e.H5),h.setVal("H3",e.H4-2*e.E1),h.setVal("D1",e.D3),h.setVal("D2",e.D4),h.setVal("L9",e.D3/2),h.setVal("H7",e.D3/2*1.6),h.setVal("H6",e.D3/20),h.setVal("R9",e.D3/20),h.setVal("E1",e.E1),h.setVal("E3",e.E1),h.setVal("E4",e.E1),h.setVal("E6",e.E1),h.setVal("E7",e.E1);const w=e.D2*.6,v=24,P=w/(v*4);if(h.setVal("D3",w),e.D2>e.D3-2*e.E1)throw`err153: D2 ${e.D2} too large compare to D3 ${e.D3} and E1 ${e.E1}`;if(h.setVal("N1",v),h.setVal("D7",P),h.setVal("L1",P),h.setVal("H4",e.H6),h.setVal("D4",e.D5),h.setVal("L7",e.L7),h.setVal("L8",e.L8),h.setVal("D6",e.D9),h.setVal("H5",e.H7),h.setVal("D5",e.D6),h.setVal("D8",e.D7),e.D6>=e.D7)throw`err164: D6 ${e.D6} too large compare to D7 ${e.D7}`;const $=e.L4-2*e.L3;if(h.setVal("L4",$),$<=0)throw`err169: L3 ${e.L3} too large compare to L4 ${e.L4}`;if(h.setVal("L5",e.L5+2*e.L3),h.setVal("L6",e.L6+2*e.L3),h.setVal("S1",e.S1),h.setVal("S2",e.L2/2),h.setVal("S3",0),h.setVal("S3",0),h.setVal("JD1",e.D3/4),h.setVal("JE1",e.E1),h.setVal("JL1",e.D3/3),h.setVal("JH1",0),h.setVal("JS1",e.S1/2),h.setVal("JS2",e.S1/2),h.setVal("JD3",e.D4/4),h.setVal("JE3",e.E1),h.setVal("JS3",e.D4/4),h.setVal("JD4",e.D4/4),h.setVal("JE4",e.E1),h.setVal("JS4",e.D4/4),c.setVal("L2",e.L2),c.setVal("D1",e.D6),c.setVal("H3",e.H9),c.setVal("H4",e.H9),c.setVal("L1",e.L1),e.L1<4*e.L4+2*e.L6+e.L5+2*e.L3)throw`err185: L1 ${e.L1} too small compare to L4 ${e.L4}, L5 ${e.L5}, L6 ${e.L6}`;c.setVal("H1",e.L3),c.setVal("H2",e.L3),c.setVal("L4",e.L4),c.setVal("L5",e.L5),c.setVal("L6",e.L6),c.setVal("L3",e.D7),c.setVal("S1",e.D6/2),c.setVal("S2",e.S2),c.setVal("R2",0);const z=vs.pGeom(0,f.getParamVal(),f.getSuffix());vt(z),t.logstr+=St(z.logstr,f.getPartNameSuffix());const I=Xs.pGeom(0,h.getParamVal(),h.getSuffix());vt(I),t.logstr+=St(I.logstr,h.getPartNameSuffix());const p=Ls.pGeom(0,c.getParamVal(),c.getSuffix());vt(p),t.logstr+=St(p.logstr,c.getPartNameSuffix()),o.mergeFigure(z.fig.poleCut),o.mergeFigure(I.fig.faceStopperSide.translate(0,l)),o.mergeFigure(p.fig.faceSide.translate(0,_).rotate(0,_,u)),a.mergeFigure(z.fig.poleCut),a.mergeFigure(I.fig.faceStopperFaceT.translate(0,l)),a.mergeFigure(p.fig.faceFace.translate(0,_)),i.mergeFigure(z.fig.poleBottom.translate(0,0)),i.mergeFigure(I.fig.faceStopperTop.translate(0,0)),i.mergeFigure(p.fig.faceTop.rotate(0,0,Math.PI/2)),t.fig={faceSide:o,faceFace:a,faceTop:i};const R=t.partName;t.vol={inherits:[{outName:`inpax_${R}_poleStatic`,subdesign:"pax_pole_static",subgeom:z,rotate:[0,0,0],translate:[0,0,0]},{outName:`inpax_${R}_rake`,subdesign:"pax_rake_stopper",subgeom:I,rotate:[0,0,0],translate:[0,0,l]},{outName:`inpax_${R}_swing`,subdesign:"pax_swing",subgeom:p,rotate:[Math.PI/2,0,0],translate:[0,0,_]}],extrudes:[],volumes:[{outName:`pax_${R}`,boolMethod:be.eUnion,inList:[`inpax_${R}_poleStatic`,`inpax_${R}_rake`,`inpax_${R}_swing`]}]};const k=f.getDesignParamList(),V={partName:f.getPartName(),dparam:k,orientation:[0,0,0],position:[0,0,0]},C={partName:h.getPartName(),dparam:h.getDesignParamList(),orientation:[0,0,0],position:[0,0,l]},M={partName:c.getPartName(),dparam:c.getDesignParamList(),orientation:[0,0,0],position:[0,0,_]};t.sub={pole_static_1:V,rake_1:C,swing_1:M},t.logstr+=`heliostat-2-overview drawn successfully!
`,t.calcErr=!1}catch(r){t.logstr+=r,console.log(r)}return t}var _r={pTitle:"Heliostat-2 overview",pDescription:"The heliostat-2 inclination mechanism",pDef:Ys,pGeom:fr},Ro={partName:"base",params:[s("D1","mm",600,10,4e3,10),s("D2","mm",700,10,4e3,10),s("D3","mm",400,10,4e3,10),s("D4","mm",500,10,4e3,10),s("E1","mm",30,1,80,1),s("E2","mm",30,1,80,1),s("E3","mm",30,1,80,1),s("H1","mm",800,10,4e3,10),s("H2","mm",50,1,4e3,1),te("side holes"),s("H3","mm",400,10,4e3,10),s("N2","",12,1,100,1),s("L2","mm",100,1,400,1),te("base holes"),s("N1","",24,3,100,1),s("D5","mm",40,1,100,1),s("L1","mm",34,1,300,1)],paramSvg:{D1:"base_cut.svg",D2:"base_cut.svg",D3:"base_cut.svg",D4:"base_cut.svg",E1:"base_cut.svg",E2:"base_cut.svg",E3:"base_cut.svg",H1:"base_cut.svg",H2:"base_hollow.svg",H3:"base_hollow.svg",N2:"base_hollow.svg",L2:"base_hollow.svg",N1:"base_top.svg",D5:"base_top.svg",L1:"base_top.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function vr(n,e,g=""){const t=He(Ro.partName+g);let o,a,i;const r=J(),d=J(),u=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const l=e.D1/2,_=e.D2/2,f=e.D3/2,h=e.D4/2,c=e.D5/2,S=e.L2/2;if(_<l)throw`err089: D2 ${e.D2} too small compare to D1 ${e.D1}`;if(h>l-e.E2)throw`err189: D4 ${e.D4} too large compare to D1 ${e.D1} and E2 ${e.E2}`;t.logstr+=`base-height: ${m(e.H1)} mm
`,t.logstr+=`base-external-diameter: ${m(e.D2)} mm
`;const L=e.D1*Math.PI/e.N2-e.L2;if(t.logstr+=`inter-hollow: ${m(L)} mm
`,o=function(M){return B(M*_,0).addSegStrokeA(M*_,e.E3).addSegStrokeA(M*l,e.E3).addSegStrokeA(M*l,e.H1).addSegStrokeA(M*(l-e.E2),e.H1).addSegStrokeA(M*(l-e.E2),e.E3).addSegStrokeA(M*h,e.E3).addSegStrokeA(M*h,0).closeSegStroke()},a=function(M){return B(M*_,0).addSegStrokeA(M*_,e.E3).addSegStrokeA(M*l,e.E3).addSegStrokeA(M*l,e.H1).addSegStrokeA(M*f,e.H1).addSegStrokeA(M*f,e.H1-e.E1).addSegStrokeA(M*(l-e.E2),e.H1-e.E1).addSegStrokeA(M*(l-e.E2),e.E3).addSegStrokeA(M*h,e.E3).addSegStrokeA(M*h,0).closeSegStroke()},e.H1<e.E3+e.H2+e.H3+e.E1)throw`err125: H1 ${e.H1} too small compare to E3 ${e.H3}, H2 ${e.H2}, H3 ${e.H3}, E1 ${e.E1}`;if(e.D5>e.H3)throw`err128: D5 ${e.D5} too large compare to H3 ${e.H3}`;const w=2*Math.asin(S/(l-e.E2));if(e.N2*w>2*Math.PI)throw`err132: N2 ${e.N2} too large compare to L2 ${e.L2}, D1 ${e.D1}, E2 ${e.E2}`;const v=e.E3+e.H2+S;i=function(M){return B(M*S,v).addSegStrokeA(M*S,v+e.H3-e.L2).addPointA(-M*S,v+e.H3-e.L2).addSegArc(S,!1,!0).addSegStrokeA(-M*S,v).closeSegArc(S,!1,!0)},r.addMainO(o(1)),r.addSecond(a(1)),r.addSecond(a(-1)),r.addSecond(i(1));const P=[];if(f+e.L1+c>l-e.E2)throw`err127: D3 ${e.D3} too large compare to D1 ${e.D1}, E2 ${e.E2}, L1 ${e.L1}, R5 ${e.D5}`;if(c>e.L1)throw`err130: D5 ${e.D5} too large compare to L1 ${e.L1}`;const $=2*Math.asin(c/(_+e.L1));if(e.N1*$>2*Math.PI)throw`err134: N1 ${e.N1} too large compare to D5 ${e.D5}, L1 ${e.L1}, D2 ${e.D2}`;P.push(N(0,0,l)),P.push(N(0,0,f));const z=f+e.L1,I=2*Math.PI/e.N1;for(let M=0;M<e.N1;M++){const q=z*Math.cos(M*I),X=z*Math.sin(M*I);P.push(N(q,X,c))}d.addMainOI(P),d.addSecond(N(0,0,l-e.E1)),d.addSecond(N(0,0,_)),d.addSecond(N(0,0,h)),u.addMainO(i(1)),u.addSecond(a(1)),u.addSecond(a(-1)),t.fig={faceCut:r,faceTop:d,faceHollow:u};const p=t.partName,R=2*Math.PI/e.N2,k=[...Array(e.N2).keys()],V=k.map(M=>({outName:`subpax_${p}_hollow_${M}`,face:`${p}_faceHollow`,extrudeMethod:se.eLinearOrtho,length:_+e.E2,rotate:[Math.PI/2,0,M*R],translate:[0,0,0]})),C=k.map(M=>`subpax_${p}_hollow_${M}`);t.vol={extrudes:[{outName:`subpax_${p}_cut`,face:`${p}_faceCut`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[Math.PI/2,0,0]},{outName:`subpax_${p}_top`,face:`${p}_faceTop`,extrudeMethod:se.eLinearOrtho,length:e.E1,rotate:[0,0,0],translate:[0,0,e.H1-e.E1]},...V],volumes:[{outName:`ipax_${p}_hollows`,boolMethod:be.eUnion,inList:[...C]},{outName:`ipax_${p}_cylinder`,boolMethod:be.eSubstraction,inList:[`subpax_${p}_cut`,`ipax_${p}_hollows`]},{outName:`pax_${p}`,boolMethod:be.eUnion,inList:[`ipax_${p}_cylinder`,`subpax_${p}_top`]}]},t.sub={},t.logstr+=`heliostat-base drawn successfully!
`,t.calcErr=!1}catch(l){t.logstr+=l,console.log(l)}return t}var Sr={pTitle:"Heliostat base",pDescription:"The base for the static-pole of the heliostat",pDef:Ro,pGeom:vr},Ao={partName:"vaxis",params:[s("D1","mm",600,1,4e3,1),s("D2","mm",400,1,4e3,1),s("H1","mm",8e3,10,4e4,10),s("E1","mm",5,1,80,1),s("E2","mm",30,1,80,1),te("base holes"),s("N1","",24,3,100,1),s("D3","mm",40,1,100,1),s("L1","mm",45,1,300,1)],paramSvg:{D1:"vaxis_cut.svg",D2:"vaxis_cut.svg",H1:"vaxis_cut.svg",E1:"vaxis_cut.svg",E2:"vaxis_cut.svg",N1:"vaxis_ends.svg",D3:"vaxis_ends.svg",L1:"vaxis_ends.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Lr(n,e,g=""){const t=He(Ao.partName+g);let o;const a=J(),i=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const r=e.D1/2,d=e.D2/2,u=e.D3/2;t.logstr+=`vaxis-height: ${m(e.H1)} mm
`;const l=B(r,0).addSegStrokeA(r,e.H1).addSegStrokeA(r-e.E1,e.H1).addSegStrokeA(r-e.E1,0).closeSegStroke();a.addMainO(l),o=function(S){return B(S*r,0).addSegStrokeA(S*r,e.H1).addSegStrokeA(S*d,e.H1).addSegStrokeA(S*d,e.H1-e.E2).addSegStrokeA(S*(r-e.E1),e.H1-e.E2).addSegStrokeA(S*(r-e.E1),e.E2).addSegStrokeA(S*d,e.E2).addSegStrokeA(S*d,0).closeSegStroke()},a.addSecond(o(1)),a.addSecond(o(-1));const _=[];_.push(N(0,0,r)),_.push(N(0,0,d));const f=d+e.L1,h=2*Math.PI/e.N1;for(let S=0;S<e.N1;S++){const L=f*Math.cos(S*h),w=f*Math.sin(S*h);_.push(N(L,w,u))}i.addSecond(N(0,0,r-e.E1)),i.addMainOI(_),t.fig={faceCut:a,faceBottom:i};const c=t.partName;t.vol={extrudes:[{outName:`subpax_${c}_pole`,face:`${c}_faceCut`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${c}_bottom`,face:`${c}_faceBottom`,extrudeMethod:se.eLinearOrtho,length:e.E2,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${c}_top`,face:`${c}_faceBottom`,extrudeMethod:se.eLinearOrtho,length:e.E2,rotate:[0,0,0],translate:[0,0,e.H1-e.E2]}],volumes:[{outName:`pax_${c}`,boolMethod:be.eUnion,inList:[`subpax_${c}_pole`,`subpax_${c}_bottom`,`subpax_${c}_top`]}]},t.sub={},t.logstr+=`V-Axis drawn successfully!
`,t.calcErr=!1}catch(r){t.logstr+=r,console.log(r)}return t}var pr={pTitle:"Heliostat V-Axis",pDescription:"The vertical axis inside the pole of an heliostat",pDef:Ao,pGeom:Lr},Mo={partName:"ring",params:[s("D1","mm",400,1,2e3,1),s("D3","mm",800,1,4e3,1),s("H1","mm",20,1,100,1),s("H2","mm",100,1,600,1),te("ring holes"),s("N2","",24,3,100,1),s("D2","mm",40,1,100,1),s("L1","mm",45,1,300,1),te("ring fake teeth"),s("N1","",100,3,1e4,1),s("L2","mm",30,1,200,1),s("L3","mm",30,1,200,1)],paramSvg:{D1:"ring_top.svg",D3:"ring_top.svg",H1:"ring_section.svg",H2:"ring_section.svg",N2:"ring_top.svg",D2:"ring_top.svg",L1:"ring_top.svg",N1:"ring_top.svg",L2:"ring_top.svg",L3:"ring_top.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Pr(n,e,g=""){const t=He(Mo.partName+g),o=J(),a=J(),i=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const r=e.D1/2,d=e.D2/2,u=e.D3/2,l=e.H1+e.H2;if(e.L1<d)throw`err203: L1 ${e.L1} too small compare to D2 ${e.D2}`;if(r+e.L1+d>u-e.L2-e.L3)throw`err204: D3 ${e.D3} too small compare to D1 ${e.D1}, L1 ${e.L1}, L2 ${e.L2}, L3 ${e.L3}`;if(2*Math.atan2(d,r+e.L1)>2*Math.PI/e.N2)throw`err205: D2 ${e.D2} too large compare to N2 ${e.N2}`;t.logstr+=`ring-height: ${m(l)} mm
`;const _=u-e.L3,f=_-e.L2,h=2*Math.PI/(2*e.N1),c=B(_,0);for(let R=0;R<e.N1;R++){const k=2*R+1,V=2*R+2,C=f*Math.cos(k*h),M=f*Math.sin(k*h),q=_*Math.cos(V*h),X=_*Math.sin(V*h);c.addSegStrokeA(C,M).addSegStrokeA(q,X)}const S=[];S.push(N(0,0,u)),S.push(N(0,0,r));const L=r+e.L1,w=2*Math.PI/e.N2;for(let R=0;R<e.N2;R++){const k=L*Math.cos(R*w),V=L*Math.sin(R*w);S.push(N(k,V,d)),a.addSecond(N(k,V,d))}o.addSecond(c),o.addMainOI(S);const v=[];v.push(N(0,0,u)),v.push(c),a.addSecond(N(0,0,r)),a.addMainOI(v);const P=B(r,0).addSegStrokeA(-r,0).addSegStrokeA(-r,-e.H1).addSegStrokeA(r,-e.H1).closeSegStroke(),$=function(R){return B(R*(r+e.L1)+d,0).addSegStrokeR(-2*d,0).addSegStrokeR(0,-e.H1).addSegStrokeR(2*d,0).closeSegStroke()},z=function(R){return B(R*(u-e.L3),-e.H1).addSegStrokeR(-R*e.L2,0).addSegStrokeR(0,-e.H2).addSegStrokeR(R*e.L2,0).closeSegStroke()},I=function(R){return B(R*u,0).addSegStrokeR(-R*(u-r),0).addSegStrokeR(0,-e.H1).addSegStrokeR(R*(u-e.L2-e.L3-r),0).addSegStrokeR(0,-e.H2).addSegStrokeR(R*(e.L2+e.L3),0).closeSegStroke()};i.addSecond(P),i.addSecond($(1)),i.addSecond($(-1)),i.addSecond(z(1)),i.addSecond(z(-1)),i.addMainO(I(1)),i.addSecond(I(-1)),t.fig={faceRingBase:o,faceRingTeeth:a,faceSection:i};const p=t.partName;t.vol={extrudes:[{outName:`subpax_${p}_base`,face:`${p}_faceRingBase`,extrudeMethod:se.eLinearOrtho,length:e.H1,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${p}_teeth`,face:`${p}_faceRingTeeth`,extrudeMethod:se.eLinearOrtho,length:l,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${p}`,boolMethod:be.eUnion,inList:[`subpax_${p}_base`,`subpax_${p}_teeth`]}]},t.sub={},t.logstr+=`ring drawn successfully!
`,t.calcErr=!1}catch(r){t.logstr+=r,console.log(r)}return t}var xr={pTitle:"Heliostat ring",pDescription:"The gear ring for adjusting the azimuth of the heliostat",pDef:Mo,pGeom:Pr},yo={partName:"ring_guidance",params:[s("D1","mm",700,5,2500,1),s("N1","legs",6,1,24,1),s("D2","mm",600,5,2e3,1),te("leg details"),s("D3","mm",30,1,200,1),s("D4","mm",50,1,200,1),s("L1","mm",90,1,900,1),s("R5","mm",20,0,500,1),te("inner"),s("D6","mm",300,1,1e3,1),s("N2","motors",8,1,200,1),s("L2","mm",50,1,200,1),s("D7","mm",80,1,200,1),te("thickness"),s("T1","mm",10,1,200,1)],paramSvg:{D1:"ring_guidance_top.svg",D2:"ring_guidance_top.svg",D3:"ring_guidance_top.svg",D4:"ring_guidance_top.svg",R5:"ring_guidance_top.svg",D6:"ring_guidance_top.svg",D7:"ring_guidance_top.svg",N1:"ring_guidance_top.svg",N2:"ring_guidance_top.svg",L1:"ring_guidance_top.svg",L2:"ring_guidance_top.svg",T1:"ring_guidance_top.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function Dr(n,e,g=""){const t=He(yo.partName+g),o=J(),a=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const i=e.D1/2,r=e.D3/2,d=e.D4/2,u=e.D6/2,l=e.D7/2,_=2*Math.PI/e.N2;if(l>e.L2)throw`err461: D7 ${e.D7} is too large compare to L2 ${e.L2}`;if(e.N2*e.D7>(e.D6+2*e.L2)*Math.PI)throw`err462: N2 ${e.N2} is too large compare to D6 ${e.D6}, D7 ${e.D7} and L2 ${e.L2}`;if(e.D2<e.D6+2*e.L2+2*l)throw`err463: D2 ${e.D2} is too small compare to D6 ${e.D6}, L2 ${e.L2} and D7 ${e.D7}`;t.logstr+=`ring_guidance: Dmax ${m(e.D1+2*d)} mm
`;const f=[],[h,c,S]=Do(e);t.logstr+=h,f.push(c),f.push(N(0,0,u));for(let $=0;$<e.N2;$++)f.push(N(u+e.L2,0,l).rotate(0,0,$*_));for(let $=0;$<e.N1;$++)f.push(N(i,0,r).rotate(0,0,$*S));o.addMainOI(f);const L=function($,z,I,p){return B($,z).addSegStrokeR(I,0).addSegStrokeR(0,p).addSegStrokeR(-I,0).closeSegStroke()},w=i-u+d;a.addMainO(L(u,0,w,e.T1)),a.addMainO(L(-u-w,0,w,e.T1)),a.addSecond(L(i-r,0,2*r,e.T1)),a.addSecond(L(-i-r,0,2*r,e.T1));const v=u+e.L2;a.addSecond(L(v-l,0,2*l,e.T1)),a.addSecond(L(-v-l,0,2*l,e.T1)),t.fig={faceTop:o,faceSection:a};const P=t.partName;t.vol={extrudes:[{outName:`subpax_${P}_top`,face:`${P}_faceTop`,extrudeMethod:se.eLinearOrtho,length:e.T1,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${P}`,boolMethod:be.eIdentity,inList:[`subpax_${P}_top`]}]},t.sub={},t.logstr+=`ring_guidance drawn successfully!
`,t.calcErr=!1}catch(i){t.logstr+=i,console.log(i)}return t}var br={pTitle:"Ring-guidance",pDescription:"The guidance of the gear-ring for the heliostat azimuth",pDef:yo,pGeom:Dr},No={partName:"vaxis_guidance",params:[s("D1","mm",700,5,2500,1),s("N1","legs",6,1,24,1),s("D2","mm",600,5,2e3,1),te("leg details"),s("D3","mm",30,1,200,1),s("D4","mm",50,1,200,1),s("L1","mm",90,1,900,1),s("R5","mm",20,0,500,1),te("inner"),s("D6","mm",540,1,1e3,1),s("N2","springs",6,1,24,1),wt("orientation",["ccw","cw","alt"]),s("R7","mm",10,0,100,1),s("L2","mm",100,1,900,1),s("E2","mm",20,1,200,1),te("spring"),s("SA1","degree",0,-45,45,1),s("SE1","mm",10,.1,200,.1),s("SD1","mm",20,1,200,1),s("SD2","mm",10,1,200,1),s("SN1","loops",2,0,8,1),s("SL1","mm",40,1,900,1),s("SL2","mm",70,0,900,1),wt("Send",["round","pike"]),te("thickness"),s("T1","mm",10,1,200,1),s("Dvaxis","mm",260,5,1e3,1)],paramSvg:{D1:"vaxis_guidance_top.svg",N1:"vaxis_guidance_top.svg",D2:"vaxis_guidance_top.svg",D3:"vaxis_guidance_top.svg",D4:"vaxis_guidance_top.svg",L1:"vaxis_guidance_top.svg",R5:"vaxis_guidance_top.svg",D6:"vaxis_guidance_top.svg",N2:"vaxis_guidance_top.svg",orientation:"vaxis_guidance_top.svg",R7:"vaxis_guidance_top.svg",L2:"vaxis_guidance_spring.svg",E2:"vaxis_guidance_spring.svg",SA1:"vaxis_guidance_spring.svg",SE1:"vaxis_guidance_spring.svg",SD1:"vaxis_guidance_spring.svg",SD2:"vaxis_guidance_spring.svg",SN1:"vaxis_guidance_spring.svg",SL1:"vaxis_guidance_spring.svg",SL2:"vaxis_guidance_spring.svg",Send:"vaxis_guidance_spring.svg",T1:"vaxis_guidance_top.svg",Dvaxis:"vaxis_guidance_top.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function Hr(n,e,g=""){const t=He(No.partName+g),o=J(),a=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const i=e.D1/2,r=e.D2/2,d=e.D3/2,u=e.D4/2,l=e.D6/2;if(r<l)throw`err466: D6 ${e.D6} is too large compare to D2 ${e.D2}`;t.logstr+=`vaxis_guidance: Dmax ${m(e.D1+2*u)} mm
`;const _=[],[f,h,c]=Do(e);t.logstr+=f,_.push(h);for(let P=0;P<e.N1;P++)_.push(N(i,0,d).rotate(0,0,P*c));const[S,L]=rr(e);t.logstr+=S,_.push(L),o.addSecond(N(0,0,e.Dvaxis/2)),o.addMainOI(_);const w=i-l+u;a.addMainO(Ve(l,0,w,e.T1)),a.addMainO(Ve(-l-w,0,w,e.T1)),a.addSecond(Ve(i-d,0,2*d,e.T1)),a.addSecond(Ve(-i-d,0,2*d,e.T1)),t.fig={faceTop:o,faceSection:a};const v=t.partName;t.vol={extrudes:[{outName:`subpax_${v}_top`,face:`${v}_faceTop`,extrudeMethod:se.eLinearOrtho,length:e.T1,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${v}`,boolMethod:be.eIdentity,inList:[`subpax_${v}_top`]}]},t.sub={},t.logstr+=`vaxis_guidance drawn successfully!
`,t.calcErr=!1}catch(i){t.logstr+=i,console.log(i)}return t}var mr={pTitle:"Vaxis-guidance",pDescription:"The guidance of the V-Axis for the heliostat azimuth",pDef:No,pGeom:Hr},$o={partName:"haxis_guidance",params:[s("D5","mm",600,1,2e3,1),s("D8","mm",1e3,1,2e3,1),te("outer details"),s("E5","mm",1,0,200,1),s("E8","mm",20,1,200,1),s("L5","mm",20,1,200,1),s("R9","mm",20,0,500,1),te("inner spring"),s("SA1","degree",0,-45,45,1),s("SE1","mm",2,.1,100,.1),s("SD1","mm",20,1,200,1),s("SD2","mm",10,1,200,1),s("SN1","springs",7,1,24,1),s("SL1","mm",60,0,500,1),s("SL2","mm",100,0,500,1),wt("Send",["round","pike"]),te("thickness"),s("L4","mm",400,1,2e3,1)],paramSvg:{D5:"haxis_guidance_outer.svg",D8:"haxis_guidance_outer.svg",E5:"haxis_guidance_outer.svg",E8:"haxis_guidance_outer.svg",L5:"haxis_guidance_outer.svg",R9:"haxis_guidance_outer.svg",SA1:"haxis_guidance_spring.svg",SE1:"haxis_guidance_spring.svg",SD1:"haxis_guidance_spring.svg",SD2:"haxis_guidance_spring.svg",SN1:"haxis_guidance_spring.svg",SL1:"haxis_guidance_spring.svg",SL2:"haxis_guidance_spring.svg",Send:"haxis_guidance_spring.svg",L4:"haxis_guidance_outer.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function kr(n,e,g=""){const t=He($o.partName+g),o=J(),a=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const i=e.D5/2,r=e.D8/2,d=e.SD1/2,u=i+e.E5,l=r-e.E8,_=2*Math.asin(e.L5/(2*u)),f=Math.PI/12+Pe(e.SA1),h=Math.PI/2+_-f,c=Math.PI-f,S=Math.PI/2-Math.PI/6+f;if(u+d+e.SE1>l)throw`err411: D8 ${e.D8} is too small compare to D5 ${e.D5}, E5 ${e.E5}, E8 ${e.E8}`;if(2*Math.PI/3-2*_<e.R9/l)throw`err412: L5 ${e.L5} is too large compare to R9 ${e.R9}`;t.logstr+=`haxis_guidance: Dinner ${m(2*u)} mm
`,o.addSecond(N(0,0,i)),o.addSecond(N(0,0,r));const[L,w]=Ns(e,!1),[,v]=Ns(e,!0);t.logstr+=L;const P=Math.PI/2-_,$=-Math.PI/6+_,z=ie(0,0),I=z.translatePolar(P,u+e.SE1+d),p=I.translatePolar(P-Math.PI/2,d),R=p.translatePolar(P+Math.PI,d+e.SE1),k=p.translatePolar(P+Math.PI,d),V=R.rotate(p,h),C=z.translatePolar($,u+e.SE1+d),M=C.translatePolar($+Math.PI/2,d),q=M.translatePolar($+Math.PI,d+e.SE1),X=M.translatePolar($+Math.PI,d),y=X.rotate(M,-h),F=B(0,u).addSegStrokeA(R.cx,R.cy).addPointA(V.cx,V.cy).addSegArc(d+e.SE1,!1,!0);F.addPartial(w.rotate(0,0,c).translate(V.cx,V.cy)),F.addPointA(k.cx,k.cy).addPointA(I.cx,I.cy).addSegArc2().addSegStrokeAP(P,l).addCornerRounded(e.R9).addPointAP($,l).addSegArc(l,!1,!1).addCornerRounded(e.R9).addSegStrokeA(C.cx,C.cy).addPointA(X.cx,X.cy).addPointA(y.cx,y.cy).addSegArc2(),F.addPartial(v.rotate(0,0,S).translate(y.cx,y.cy)),F.addPointA(q.cx,q.cy).addSegArc(d+e.SE1,!1,!0).addSegStrokeAP(-Math.PI/6,u).addSegStrokeAP(-Math.PI/6,r).addPointAP(Math.PI/2,r).addSegArc(r,!1,!0).closeSegStroke(),o.addMainO(F);const j=r*Math.sin(Math.PI/6);a.addMainO(Ve(0,-j,e.L4,r+j)),a.addSecond(Ve(0,-r,e.L4,2*r)),a.addSecond(Ve(0,-i,e.L4,2*i)),t.fig={faceProfile:o,faceSide:a};const Z=t.partName;t.vol={extrudes:[{outName:`subpax_${Z}_profile`,face:`${Z}_faceProfile`,extrudeMethod:se.eLinearOrtho,length:e.L4,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${Z}`,boolMethod:be.eIdentity,inList:[`subpax_${Z}_profile`]}]},t.sub={},t.logstr+=`haxis_guidance drawn successfully!
`,t.calcErr=!1}catch(i){t.logstr+=i,console.log(i)}return t}var wr={pTitle:"Haxis-guidance",pDescription:"The guidance of the H-Axis for the heliostat inclination",pDef:$o,pGeom:kr},Eo={partName:"rod",params:[s("L1","mm",1e4,100,4e4,10),s("L2","mm",100,2,400,1),s("L3","mm",400,10,1e3,1),s("L4","mm",600,10,1e3,1),s("N1","",10,2,50,1),te("section"),s("H1","mm",200,5,4e3,1),s("E1","mm",2,1,80,1),s("E2","mm",10,1,80,1),te("pad"),s("N3","",2,1,20,1),s("N4","",4,1,20,1),s("R3","mm",100,1,500,1),s("D2","mm",10,1,100,1),s("L7","mm",10,1,300,1)],paramSvg:{L1:"rod_top.svg",L2:"rod_top.svg",L3:"rod_top.svg",L4:"rod_top.svg",H1:"rod_cut.svg",E1:"rod_cut.svg",E2:"rod_cut.svg",N1:"rod_top.svg",N3:"rod_top.svg",N4:"rod_top.svg",R3:"rod_top.svg",D2:"rod_plate.svg",L7:"rod_plate.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Rr(n,e,g=""){const t=He(Eo.partName+g),o=J(),a=J(),i=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const r=e.D2/2,d=e.L3/(e.N3+1),u=e.L4/(e.N4+1);t.logstr+=`rod-length: ${m(e.L1)} mm
`;const l=(e.L1-e.L3)/(e.N1-1);t.logstr+=`space-length: ${m(l)} mm
`;const _=function(p){const R=[],k=B(e.L4/2,p).addCornerRounded(e.R3).addSegStrokeA(e.L4/2,p+e.L3).addCornerRounded(e.R3).addSegStrokeA(-e.L4/2,p+e.L3).addCornerRounded(e.R3).addSegStrokeA(-e.L4/2,p).addCornerRounded(e.R3).closeSegStroke();R.push(k);for(let V=1;V<e.N3+1;V++)R.push(N(e.L4/2-e.L7,p+V*d,r)),R.push(N(-e.L4/2+e.L7,p+V*d,r));for(let V=1;V<e.N4+1;V++)R.push(N(-e.L4/2+V*u,p+e.L7,r)),R.push(N(-e.L4/2+V*u,p+e.L3-e.L7,r));return R},f=function(p,R){return B(e.L2/2,p).addSegStrokeA(e.L2/2,p+R).addSegStrokeA(-e.L2/2,p+R).addSegStrokeA(-e.L2/2,p).closeSegStroke()},h=[],c=e.L2/2,S=e.L4/2,L=(e.L2-2*e.E1)/2,w=e.H1-e.E1,v=B(c,0).addSegStrokeA(c,e.H1).addSegStrokeA(-c,e.H1).addSegStrokeA(-c,0).closeSegStroke(),P=B(L,e.E1).addSegStrokeA(L,w).addSegStrokeA(-L,w).addSegStrokeA(-L,e.E1).closeSegStroke(),$=B(S,e.H1).addSegStrokeA(S,e.H1+e.E2).addSegStrokeA(-S,e.H1+e.E2).addSegStrokeA(-S,e.H1).closeSegStroke();h.push(v),h.push(P),o.addSecond($),o.addMainOI(h),a.addMainOI(_(0)),a.addSecond(f(-e.L3/2,2*e.L3));const z=(e.L1-e.L3)/(e.N1-1);for(let p=0;p<e.N1;p++)i.addMainOI(_(p*z));i.addSecond(f(0,e.L1)),t.fig={faceCut:o,facePlate:a,faceTop:i};const I=t.partName;t.vol={extrudes:[{outName:`subpax_${I}_rod`,face:`${I}_faceCut`,extrudeMethod:se.eLinearOrtho,length:e.L1,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${I}_plates`,face:`${I}_faceTop`,extrudeMethod:se.eLinearOrtho,length:e.E2,rotate:[Math.PI/2,0,0],translate:[0,e.E2+e.H1,0]}],volumes:[{outName:`pax_${I}`,boolMethod:be.eUnion,inList:[`subpax_${I}_rod`,`subpax_${I}_plates`]}]},t.sub={},t.logstr+=`heliostat-rod drawn successfully!
`,t.calcErr=!1}catch(r){t.logstr+=r,console.log(r)}return t}var Ar={pTitle:"Heliostat rod",pDescription:"The rod of an heliostat-surface",pDef:Eo,pGeom:Rr},Co={partName:"trapeze",params:[s("L1","mm",1600,10,4e3,1),s("L2","mm",1e3,10,4e3,1),s("L3","mm",400,5,800,1),s("L4","mm",300,5,800,1),te("outer frame"),s("N1","",7,1,20,1),s("N2","",4,1,20,1),s("D1","mm",10,1,40,1),s("L5","mm",100,1,400,1),s("L6","mm",20,1,400,1),s("R1","mm",60,1,400,1),s("R2","mm",20,1,400,1),te("inner pad"),s("N3","",2,1,20,1),s("N4","",2,1,20,1),s("D2","mm",10,1,40,1),s("L7","mm",20,1,400,1),s("R3","mm",20,1,400,1),te("diagonal shaft"),s("D3","mm",30,1,100,1),s("D4","mm",26,1,100,1),s("H1","mm",300,.5,800,.5),s("H2","mm",2,.5,800,.5),s("H3","mm",5,.5,800,.5)],paramSvg:{L1:"trapeze_top.svg",L2:"trapeze_top.svg",L3:"trapeze_top.svg",L4:"trapeze_top.svg",N1:"trapeze_top.svg",N2:"trapeze_top.svg",N3:"trapeze_top.svg",N4:"trapeze_top.svg",L5:"trapeze_top.svg",L6:"trapeze_top.svg",L7:"trapeze_top.svg",D1:"trapeze_top.svg",D2:"trapeze_top.svg",D3:"trapeze_rod.svg",D4:"trapeze_rod.svg",R1:"trapeze_top.svg",R2:"trapeze_top.svg",R3:"trapeze_top.svg",H1:"trapeze_side.svg",H2:"trapeze_side.svg",H3:"trapeze_side.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Mr(n,e,g=""){const t=He(Co.partName+g);let o,a;const i=J(),r=J(),d=J(),u=J(),l=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{if(e.L3>e.L1-e.L5)throw`err595: L3 ${e.L3} too large compare to L1 ${e.L1} and L5 ${e.L5}`;if(e.L4>e.L2-e.L5)throw`err596: L4 ${e.L4} too large compare to L2 ${e.L2} and L5 ${e.L5}`;if(e.H1-e.H2-e.H3<4*e.D3)throw`err597: H1 ${e.H1} too small compare to H2 ${e.H2}, H3 ${e.H3} and D3 ${e.D3}`;const _=e.R1*(1-1/Math.sqrt(2)),f=e.R3*(1-1/Math.sqrt(2)),h=e.L2/2-_-(e.L4/2-f),c=e.L1/2-_-(e.L3/2-f),S=Math.sqrt(h**2+c**2),L=e.H1-e.H2-e.H3,w=Math.sqrt(S**2+L**2),v=Math.atan2(L,S),P=Math.atan2(c,h);t.logstr+=`rod-slope:  length: ${m(w)} mm,  angle: ${m(Ie(v))} degree
`,t.logstr+=`rod-xy-angle: ${m(Ie(P))} degree
`;const $=e.D3/Math.cos(Math.PI/2-v);t.logstr+=`rod-footprint-length: ${m($)} mm
`;const z=Math.sqrt(($/2)**2+(e.D3/2)**2),I=Math.atan2(e.D3,$);o=function(T,K,ee){return B(T,K).addPointRP(ee+Math.PI-I,z).addSeg2Arcs(ee+Math.PI/2,ee).addPointRP(ee+Math.PI+I,z).addSeg2Arcs(ee+Math.PI,ee+Math.PI/2).addPointRP(ee-I,z).addSeg2Arcs(ee+3*Math.PI/2,ee+Math.PI).addPointRP(ee+I,z).addSeg2Arcs(ee,ee-Math.PI/2)},a=function(T,K,ee){const me=T+z*Math.cos(ee+Math.PI-I),Se=K+z*Math.sin(ee+Math.PI-I);return B(me,Se).addSegStrokeRP(ee+Math.PI,S).addSegStrokeRP(ee-Math.PI/2,e.D3).addSegStrokeRP(ee,S).closeSegStroke()};const p=[];if(e.R1>e.L1/4||e.R1>e.L2/4)throw`err614: R1 ${e.R1} too large compare to L1 ${e.L1} or L2 ${e.L2}`;const R=B(e.L2/2,e.L1/2).addSegStrokeA(-e.L2/2,e.L1/2).addCornerRounded(e.R1).addSegStrokeA(-e.L2/2,-e.L1/2).addCornerRounded(e.R1).addSegStrokeA(e.L2/2,-e.L1/2).addCornerRounded(e.R1).closeSegStroke().addCornerRounded(e.R1);if(e.R2>(e.L1-2*e.L5)/4||e.R2>(e.L2-2*e.L5)/4)throw`err627: R2 ${e.R2} too large compare to L1 ${e.L1}, L2 ${e.L2} and L5 ${e.L5}`;const k=B(e.L2/2-e.L5,e.L1/2-e.L5).addSegStrokeA(-e.L2/2+e.L5,e.L1/2-e.L5).addCornerRounded(e.R2).addSegStrokeA(-e.L2/2+e.L5,-e.L1/2+e.L5).addCornerRounded(e.R2).addSegStrokeA(e.L2/2-e.L5,-e.L1/2+e.L5).addCornerRounded(e.R2).closeSegStroke().addCornerRounded(e.R2);if(e.R3>e.L3/4||e.R3>e.L4/4)throw`err639: R3 ${e.R3} too large compare to L3 ${e.L3} or L4 ${e.L4}`;const V=B(e.L4/2,e.L3/2).addSegStrokeA(-e.L4/2,e.L3/2).addCornerRounded(e.R3).addSegStrokeA(-e.L4/2,-e.L3/2).addCornerRounded(e.R3).addSegStrokeA(e.L4/2,-e.L3/2).addCornerRounded(e.R3).closeSegStroke().addCornerRounded(e.R3);p.push(R),p.push(k),i.addSecond(V);const C=e.L1/(e.N1+1),M=e.L2/(e.N2+1),q=e.L3/(e.N3+1),X=e.L4/(e.N4+1);if(e.L5<e.D1/2+e.L6)throw`err658: L5 ${e.L5} too small compare to D1 ${e.D1} or L6 ${e.L6}`;if(q<e.D2/2+e.L7)throw`err661: D2 ${e.D2} or L7 ${e.L7} too large compare to L3 ${e.l3}`;if(X<e.D2/2+e.L7)throw`err664: D2 ${e.D2} or L7 ${e.L7} too large compare to L4 ${e.l4}`;const y=[];for(let T=1;T<e.N1+1;T++)y.push(N(e.L2/2-e.L6,-e.L1/2+T*C,e.D1/2)),y.push(N(-e.L2/2+e.L6,-e.L1/2+T*C,e.D1/2));for(let T=1;T<e.N2+1;T++)y.push(N(-e.L2/2+T*M,e.L1/2-e.L6,e.D1/2)),y.push(N(-e.L2/2+T*M,-e.L1/2+e.L6,e.D1/2));const F=[];for(let T=1;T<e.N3+1;T++)F.push(N(e.L4/2-e.L7,-e.L3/2+T*q,e.D2/2)),F.push(N(-e.L4/2+e.L7,-e.L3/2+T*q,e.D2/2));for(let T=1;T<e.N4+1;T++)F.push(N(-e.L4/2+T*X,e.L3/2-e.L7,e.D2/2)),F.push(N(-e.L4/2+T*X,-e.L3/2+e.L7,e.D2/2));y.forEach(T=>{p.push(T)}),F.forEach(T=>{i.addSecond(T)}),i.addMainOI(p);const j=[];j.push(o(e.L2/2-_,e.L1/2-_,P)),j.push(o(e.L4/2-f,e.L3/2-f,P)),j.push(o(-e.L2/2+_,e.L1/2-_,Math.PI-P)),j.push(o(-e.L4/2+f,e.L3/2-f,Math.PI-P)),j.push(o(-e.L2/2+_,-e.L1/2+_,Math.PI+P)),j.push(o(-e.L4/2+f,-e.L3/2+f,Math.PI+P)),j.push(o(e.L2/2-_,-e.L1/2+_,-P)),j.push(o(e.L4/2-f,-e.L3/2+f,-P));const Z=[];Z.push(a(e.L2/2-_,e.L1/2-_,P)),Z.push(a(-e.L2/2+_,e.L1/2-_,Math.PI-P)),Z.push(a(-e.L2/2+_,-e.L1/2+_,Math.PI+P)),Z.push(a(e.L2/2-_,-e.L1/2+_,-P)),j.forEach(T=>{i.addSecond(T)}),Z.forEach(T=>{i.addSecond(T)});const G=[];if(G.push(V),F.forEach(T=>{G.push(T)}),r.addSecond(R),r.addSecond(k),y.forEach(T=>{r.addSecond(T)}),j.forEach(T=>{r.addSecond(T)}),Z.forEach(T=>{r.addSecond(T)}),r.addMainOI(G),e.D4>=e.D3)throw`err218: D4 ${e.D4} larger than D3 ${e.D3}`;d.addMainO(N(0,0,e.D3/2)),d.addSecond(N(0,0,e.D4/2)),u.addMainO(N(0,0,e.D4/2)),u.addSecond(N(0,0,e.D3/2));const O=e.D3*Math.cos(v),W=O/Math.tan(v),D=f+($/2+W)*Math.cos(P),Y=f+($/2+W)*Math.sin(P),E=w+2*($+W+O),Q=E+e.L3+e.L4+O,ce=B(Q,Q).addSegStrokeA(-Q,Q).addSegStrokeA(-Q,-Q).addSegStrokeA(Q,-Q).closeSegStroke();l.addMainO(ce),t.fig={faceFrame:i,facePlate:r,faceRod:d,faceRodHollow:u,faceCutRod:l};const U=t.partName;t.vol={extrudes:[{outName:`subpax_${U}_frame`,face:`${U}_faceFrame`,extrudeMethod:se.eLinearOrtho,length:e.H2,rotate:[0,0,0],translate:[0,0,e.H1-e.H2]},{outName:`subpax_${U}_plate`,face:`${U}_facePlate`,extrudeMethod:se.eLinearOrtho,length:e.H3,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${U}_rod1`,face:`${U}_faceRod`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,P],translate:[e.L4/2-D,e.L3/2-Y,e.H3-O]},{outName:`subpax_${U}_rod2`,face:`${U}_faceRod`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,Math.PI-P],translate:[-e.L4/2+D,e.L3/2-Y,e.H3-O]},{outName:`subpax_${U}_rod3`,face:`${U}_faceRod`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,Math.PI+P],translate:[-e.L4/2+D,-e.L3/2+Y,e.H3-O]},{outName:`subpax_${U}_rod4`,face:`${U}_faceRod`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,-P],translate:[e.L4/2-D,-e.L3/2+Y,e.H3-O]},{outName:`subpax_${U}_rodH1`,face:`${U}_faceRodHollow`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,P],translate:[e.L4/2-D,e.L3/2-Y,e.H3-O]},{outName:`subpax_${U}_rodH2`,face:`${U}_faceRodHollow`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,Math.PI-P],translate:[-e.L4/2+D,e.L3/2-Y,e.H3-O]},{outName:`subpax_${U}_rodH3`,face:`${U}_faceRodHollow`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,Math.PI+P],translate:[-e.L4/2+D,-e.L3/2+Y,e.H3-O]},{outName:`subpax_${U}_rodH4`,face:`${U}_faceRodHollow`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,-P],translate:[e.L4/2-D,-e.L3/2+Y,e.H3-O]},{outName:`subpax_${U}_cut1`,face:`${U}_faceCutRod`,extrudeMethod:se.eLinearOrtho,length:Q,rotate:[0,0,0],translate:[0,0,-Q]},{outName:`subpax_${U}_cut2`,face:`${U}_faceCutRod`,extrudeMethod:se.eLinearOrtho,length:Q,rotate:[0,0,0],translate:[0,0,e.H1]}],volumes:[{outName:`ipax_${U}_rawRod`,boolMethod:be.eUnion,inList:[`subpax_${U}_rod1`,`subpax_${U}_rod2`,`subpax_${U}_rod3`,`subpax_${U}_rod4`]},{outName:`ipax_${U}_rodHollow`,boolMethod:be.eUnion,inList:[`subpax_${U}_rodH1`,`subpax_${U}_rodH2`,`subpax_${U}_rodH3`,`subpax_${U}_rodH4`]},{outName:`ipax_${U}_halfRods`,boolMethod:be.eSubstraction,inList:[`ipax_${U}_rawRod`,`subpax_${U}_cut1`]},{outName:`ipax_${U}_rods`,boolMethod:be.eSubstraction,inList:[`ipax_${U}_halfRods`,`subpax_${U}_cut2`]},{outName:`ipax_${U}_plus`,boolMethod:be.eUnion,inList:[`subpax_${U}_frame`,`subpax_${U}_plate`,`ipax_${U}_rods`]},{outName:`pax_${U}`,boolMethod:be.eSubstraction,inList:[`ipax_${U}_plus`,`ipax_${U}_rodHollow`]}]},t.sub={},t.logstr+=`trapeze drawn successfully!
`,t.calcErr=!1}catch(_){t.logstr+=_,console.log(_)}return t}var yr={pTitle:"Heliostat trapeze",pDescription:"The support of one solar panel. Made out of aluminium for lightness and cooling",pDef:Co,pGeom:Mr},Oo={partName:"surface",params:[s("LH","mm",1600,10,4e3,1),s("LV","mm",1e3,10,4e3,1),s("LZ","mm",40,0,100,1),s("nx","",9,1,40,1),s("ny","",9,1,40,1),te("main fantasia"),wt("main_direction",["horizontal","vertical"]),ct("crenel",!1),s("first_row","",9,1,40,1),s("second_row","",9,1,40,1),te("horizontal spacing"),s("EH","mm",10,0,1e3,1),ct("EH_gradient",!1),s("EH_sup","mm",500,0,1e3,1),s("EH_cycle","",1,0,3,.05),s("EH_start","",0,0,1,.05),wt("EH_shape",["sinusoid","triangle","sawUp","sawDown"]),te("vertical spacing"),s("EV","mm",10,0,1e3,1),ct("EV_gradient",!1),s("EV_sup","mm",500,0,1e3,1),s("EV_cycle","",1,0,3,.05),s("EV_start","",0,0,1,.05),wt("EV_shape",["sinusoid","triangle","sawUp","sawDown"]),te("solar power"),s("power_efficiency","%",16,0,100,.1),s("solar_power","W/m2",816,100,2e3,1)],paramSvg:{LH:"surface_main.svg",LV:"surface_main.svg",LZ:"surface_lz.svg",nx:"surface_main.svg",ny:"surface_main.svg",main_direction:"surface_crenel.svg",crenel:"surface_crenel.svg",first_row:"surface_extremities.svg",second_row:"surface_extremities.svg",EH:"surface_main.svg",EH_gradient:"surface_space_evolution.svg",EH_sup:"surface_space_evolution.svg",EH_cycle:"surface_space_evolution.svg",EH_start:"surface_space_evolution.svg",EH_shape:"surface_space_shape.svg",EV:"surface_main.svg",EV_gradient:"surface_space_evolution.svg",EV_sup:"surface_space_evolution.svg",EV_cycle:"surface_space_evolution.svg",EV_start:"surface_space_evolution.svg",EV_shape:"surface_space_shape.svg",power_efficiency:"surface_power.svg",solar_power:"surface_power.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Nr(n,e,g=""){const t=He(Oo.partName+g);let o;const a=J(),i=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const r=e.LH*e.LV/1e6,d=e.solar_power*r*e.power_efficiency/100;t.logstr+=`panel surface: ${m(r)} m2
`,t.logstr+=`panel power: ${m(d)} W
`;const u=e.nx*e.ny;t.logstr+=`max panel number: ${u}
`,t.logstr+=`max panel surface: ${m(u*r)} m2
`,t.logstr+=`max panel power: ${m(u*d)} W
`;const l=e.main_direction===1?e.ny:e.nx,_=e.main_direction===1?e.nx:e.ny,f=e.main_direction===1?e.EV:e.EH,h=e.main_direction===1?e.EV_gradient:e.EH_gradient,c=e.main_direction===1?e.EV_sup:e.EH_sup,S=e.main_direction===1?e.EV_cycle:e.EH_cycle,L=e.main_direction===1?e.EV_start:e.EH_start,w=e.main_direction===1?e.EV_shape:e.EH_shape,v=e.main_direction===0?e.EV:e.EH,P=e.main_direction===0?e.EV_gradient:e.EH_gradient,$=e.main_direction===0?e.EV_sup:e.EH_sup,z=e.main_direction===0?e.EV_cycle:e.EH_cycle,I=e.main_direction===0?e.EV_start:e.EH_start,p=e.main_direction===0?e.EV_shape:e.EH_shape,R=Math.max(_,e.first_row,e.second_row),k=[];for(let E=0;E<l;E++){const Q=(E+1)%2,ce=e.crenel?_-Q:_;k.push(ce)}k[0]=e.first_row,k[k.length-1]=e.first_row,l>2&&(k[1]=e.second_row,k[k.length-2]=e.second_row);let V=0;k.forEach(E=>{V+=E}),t.logstr+=`actual panel number: ${V} (${m(100*V/u)} %)
`,t.logstr+=`actual panel surface: ${m(V*r)} m2
`,t.logstr+=`actual panel power: ${m(V*d)} W
`;const C=[];for(let E=0;E<l-1;E++){let Q=f;if(h===1){const ce=l>2?l-2:1,U=(L+E*S/ce)%1;switch(w){case 0:Q+=c*(1-Math.cos(U*2*Math.PI))/2;break;case 1:Q+=c*(1-2*Math.abs(U-.5));break;case 2:Q+=c*U;break;case 3:Q+=c*(1-U);break;default:Q+=c}}C.push(Q)}let M=0;const q=[];q.push(0),C.forEach(E=>{M+=E,q.push(M)});const X=[];for(let E=0;E<R-1;E++){let Q=v;if(P===1){const ce=R>2?R-2:1,U=(I+E*z/ce)%1;switch(p){case 0:Q+=$*(1-Math.cos(U*2*Math.PI))/2;break;case 1:Q+=$*(1-2*Math.abs(U-.5));break;case 2:Q+=$*U;break;case 3:Q+=$*(1-U);break;default:Q+=$}}X.push(Q)}let y=0;const F=[];F.push(0),X.forEach(E=>{y+=E,F.push(y)});let j=0,Z=0;e.main_direction===0?(j=l*e.LH+M,Z=R*e.LV+y):(j=R*e.LH+y,Z=l*e.LV+M);const G=j*Z/10**6;t.logstr+=`global horizontal width: ${m(j/1e3)} m
`,t.logstr+=`global vertical height: ${m(Z/1e3)} m
`,t.logstr+=`global area: ${m(G)} m2
`,t.logstr+=`area efficiency: ${m(100*V*r/G)} %
`;const O=-j/2,W=-Z/2;o=function(E,Q){return B(E,Q).addSegStrokeA(E+e.LH,Q).addSegStrokeA(E+e.LH,Q+e.LV).addSegStrokeA(E,Q+e.LV).closeSegStroke()};const D=[];k.forEach((E,Q)=>{const ce=(R-E)%2,U=Math.floor((R-E)/2);for(let T=0;T<E;T++){let K=0,ee=0;e.main_direction===0?(K=O+Q*e.LH+q[Q],ee=W+(U+T)*e.LV+F[U+T],ce===1&&(ee+=(e.LV+F[U+T+1]-F[U+T])/2)):(ee=W+Q*e.LV+q[Q],K=O+(U+T)*e.LH+F[U+T],ce===1&&(K+=(e.LH+F[U+T+1]-F[U+T])/2)),D.push([K,ee])}});for(const E of D)a.addMainO(o(E[0],E[1]));i.addMainO(o(0,0)),t.fig={faceSurface:a,faceOnePanel:i};const Y=t.partName;t.vol={extrudes:D.map((E,Q)=>({outName:`subpax_${Y}_panel_${Q}`,face:`${Y}_faceOnePanel`,extrudeMethod:se.eLinearOrtho,length:e.LZ,rotate:[0,0,0],translate:[E[0],E[1],0]})),volumes:[{outName:`pax_${Y}`,boolMethod:be.eUnion,inList:D.map((E,Q)=>`subpax_${Y}_panel_${Q}`)}]},t.sub={},t.logstr+=`panel-surface drawn successfully!
`,t.calcErr=!1}catch(r){t.logstr+=r,console.log(r)}return t}var $r={pTitle:"Heliostat panel-surface",pDescription:"The surface collecting the solar power",pDef:Oo,pGeom:Nr},Zs={partName:"circles",params:[s("angle","degree",15,5,45,1),s("amplitude-offset","mm",1,.5,4,.1),s("amplitude-scale","scalar",.2,.1,.5,.01)],paramSvg:{angle:"circles_angle.svg","amplitude-offset":"circles_amplitude-offset.svg","amplitude-scale":"circles_amplitude-scale.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function Er(n,e,g=""){const t=He(Zs.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=ie(10,10),i=ie(10,30);o.addPoint(i);for(let r=0;r<20;r++)o.addPoint(a.scale(i,e["amplitude-offset"]+e["amplitude-scale"]*r).rotate(i,r*Pe(e.angle)+n*Math.PI/2/Zs.sim.tMax));t.fig={one:o},t.logstr+=`Circles drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var Cr={pTitle:"Circles",pDescription:"A spiral made by points.",pDef:Zs,pGeom:Er},Io={partName:"rectangle",params:[s("width","mm",15,3,40,.5),s("height","mm",10,3,40,.5)],paramSvg:{width:"rectangle_width.svg",height:"rectangle_height.svg"},sim:{tMax:120,tStep:1,tUpdate:500}};function Or(n,e,g=""){const t=He(Io.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=ie(10,10),i=ie(10+e.width,10),r=ie(10+e.width,10+e.height),d=ie(10,10+e.height),u=n*Math.PI/180;o.addPoint(a),o.addPoint(i.rotate(a,u)),o.addPoint(r.rotate(a,u)),o.addPoint(d.rotate(a,u)),t.fig={one:o},t.logstr+=`Rectangle drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var Ir={pTitle:"Rectangle",pDescription:"Just a rectangle.",pDef:Io,pGeom:Or},zo={partName:"voila",params:[s("H1","mm",40,1,4e3,1),s("H2","mm",50,1,4e3,1),s("radius","mm",10,1,4e3,1),te("corners"),s("Rc","mm",10,0,400,1)],paramSvg:{H1:"voila_face.svg",H2:"voila_face.svg",radius:"voila_face.svg",Rc:"voila_face.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function zr(n,e,g=""){const t=He(zo.partName+g),o=J();t.logstr+=`${t.partName} simTime: ${n}
`;try{const a=[],i=B(-e.H1/2,-e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(e.H1/2,-e.H2/2).addSegStrokeA(e.H1/2,e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(-e.H1/2,e.H2/2).closeSegStroke();a.push(i),a.push(N(0,0,e.radius)),o.addMainOI(a),t.fig={faceVoila:o};const r=t.partName;t.vol={extrudes:[{outName:`subpax_${r}_top`,face:`${r}_faceVoila`,extrudeMethod:se.eLinearOrtho,length:10,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${r}`,boolMethod:be.eIdentity,inList:[`subpax_${r}_top`]}]},t.sub={},t.logstr+=`voila drawn successfully!
`,t.calcErr=!1}catch(a){t.logstr+=a,console.log(a)}return t}var Vr={pTitle:"voila",pDescription:"A simple design for testing exports",pDef:zo,pGeom:zr},Vo={partName:"verify_point",params:[s("p1x","mm",30,-200,200,1),s("p1y","mm",50,-200,200,1),s("p2a","degree",30,-200,200,1),s("p2l","mm",60,0,200,1),s("rotateOrig","degree",45,-200,200,1),s("scaleOrig","scalar",1.5,.1,2,.1)],paramSvg:{p1x:"verify_point_p1x.svg",p1y:"verify_point_p1x.svg",p2a:"verify_point_p1x.svg",p2l:"verify_point_p1x.svg",rotateOrig:"verify_point_p1x.svg",scaleOrig:"verify_point_p1x.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function Tr(n,e,g=""){const t=He(Vo.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=ie(e.p1x,e.p1y+n),i=ie(0,0).setPolar(Pe(e.p2a),e.p2l),r=a.rotateOrig(Pe(e.rotateOrig)),d=a.scaleOrig(e.scaleOrig);o.addPoint(a),o.addPoint(i),o.addPoint(r),o.addPoint(d),t.fig={one:o},t.logstr+=`verify_point drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var Fr={pTitle:"Verify point",pDescription:"Debugging point.ts",pDef:Vo,pGeom:Tr},To={partName:"verify_point_2",params:[s("p1x","mm",30,-200,200,1),s("p1y","mm",50,-200,200,1),s("p2x","mm",-10,-200,200,1),s("p2y","mm",60,-200,200,1),s("p3x","mm",70,-200,200,1),s("p3y","mm",-20,-200,200,1),s("dist","mm",50,0,200,1)],paramSvg:{p1x:"verify_line_p1x.svg",p1y:"verify_line_p1x.svg",p2x:"verify_line_p1x.svg",p2y:"verify_line_p1x.svg",p3x:"verify_line_p1x.svg",p3y:"verify_line_p1x.svg",dist:"default_param_blank.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function Br(n,e,g=""){const t=He(To.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=ie(e.p1x,e.p1y+n),i=ie(e.p2x,e.p2y),r=ie(e.p3x,e.p3y),d=a.middlePoint(i),u=a.equidistantPoint(i,e.dist,r);o.addPoint(a),o.addPoint(i),o.addPoint(r),o.addPoint(d),o.addPoint(u),t.fig={one:o},t.logstr+=`verify_point_2 drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var Gr={pTitle:"Verify point 2",pDescription:"Debugging more point.ts",pDef:To,pGeom:Br},Fo={partName:"verify_line",params:[s("p1x","mm",30,-200,200,1),s("p1y","mm",50,-200,200,1),s("p2x","mm",40,-200,200,1),s("p2y","mm",-20,-200,200,1),s("p3x","mm",-30,-200,200,1),s("p3y","mm",30,-200,200,1)],paramSvg:{p1x:"verify_line_p1x.svg",p1y:"verify_line_p1x.svg",p2x:"verify_line_p1x.svg",p2y:"verify_line_p1x.svg",p3x:"verify_line_p1x.svg",p3y:"verify_line_p1x.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function Jr(n,e,g=""){const t=He(Fo.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=ie(e.p1x,e.p1y+n),i=ie(e.p2x,e.p2y),r=ie(e.p3x,e.p3y);o.addPoint(a),o.addPoint(i),o.addPoint(r);const d=Gs(0,0,0).setFromPoints(a,i);o.addLine(d),o.addPoint(ie(d.getAxisXIntersection(),0)),o.addPoint(ie(0,d.getAxisYIntersection()));const u=d.projectOrig();o.addPoint(u);const l=ie(0,0);if(!l.isEqual(u)){const _=on(l,u);o.addLine(_)}o.addLine(d.lineOrthogonal(r)),o.addLine(d.lineParallel(r)),o.addPoint(d.projectPoint(r)),t.fig={one:o},t.logstr+=`dist(l1, p3) = ${d.distanceToPoint(r)}
`,t.logstr+=`verify_line drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var Ur={pTitle:"Verify line",pDescription:"Debugging line.ts",pDef:Fo,pGeom:Jr},Bo={partName:"verify_line_2",params:[s("l1cx","mm",10,-200,200,1),s("l1cy","mm",20,-200,200,1),s("l1ca","degree",15,-200,200,1),s("l2cx","mm",30,-200,200,1),s("l2cy","mm",50,-200,200,1),s("l2ca","degree",35,-200,200,1),s("p3x","mm",-30,-200,200,1),s("p3y","mm",30,-200,200,1)],paramSvg:{l1cx:"verify_line_2_l1cx.svg",l1cy:"verify_line_2_l1cx.svg",l1ca:"verify_line_2_l1cx.svg",l2cx:"verify_line_2_l1cx.svg",l2cy:"verify_line_2_l1cx.svg",l2ca:"verify_line_2_l1cx.svg",p3x:"verify_line_2_l1cx.svg",p3y:"verify_line_2_l1cx.svg"},sim:{tMax:100,tStep:.1,tUpdate:500}};function jr(n,e,g=""){const t=He(Bo.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=ie(e.l1cx,e.l1cy),i=ie(e.l2cx,e.l2cy),r=ie(e.p3x,e.p3y);o.addPoint(a),o.addPoint(i),o.addPoint(r);const d=Gs(e.l1cx,e.l1cy,Pe(e.l1ca+n)),u=Gs(e.l2cx,e.l2cy,Pe(e.l2ca));o.addLine(d),o.addLine(u),o.addPoint(d.intersection(u)),o.addPoint(d.projectPoint(r)),t.logstr+=`dist(l1, p3) = ${d.distanceToPoint(r)}
`,o.addPoint(u.projectPoint(r)),t.logstr+=`dist(l2, p3) = ${u.distanceToPoint(r)}
`;const l=d.bisector(u,r),_=ie(l.cx,l.cy).translatePolar(l.ca,30);o.addPoint(_),t.fig={one:o},t.logstr+=`verify_line_2 drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var Wr={pTitle:"Verify line 2",pDescription:"Debugging more line.ts",pDef:Bo,pGeom:jr},Go={partName:"verify_line_3",params:[s("p1x","mm",30,-200,200,1),s("p1y","mm",50,-200,200,1),s("p2x","mm",40,-200,200,1),s("p2y","mm",-20,-200,200,1),s("p3x","mm",-30,-200,200,1),s("p3y","mm",30,-200,200,1)],paramSvg:{p1x:"verify_line_p1x.svg",p1y:"verify_line_p1x.svg",p2x:"verify_line_p1x.svg",p2y:"verify_line_p1x.svg",p3x:"verify_line_p1x.svg",p3y:"verify_line_p1x.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function qr(n,e,g=""){const t=He(Go.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=ie(e.p1x,e.p1y+n),i=ie(e.p2x,e.p2y),r=ie(e.p3x,e.p3y);o.addPoint(a),o.addPoint(i),o.addPoint(r);const d=nn(a,i);o.addLine(d);const u=rn(a,i,r);o.addPoint(u),t.fig={one:o},t.logstr+=`verify_line_3 drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var Xr={pTitle:"Verify line 3",pDescription:"Debugging more more line.ts",pDef:Go,pGeom:qr},Jo={partName:"verify_vector",params:[s("p1x","mm",30,-200,200,1),s("p1y","mm",50,-200,200,1),s("p2x","mm",80,-200,200,1),s("p2y","mm",-30,-200,200,1),s("v1a","degree",30,-200,200,1),s("v1l","mm",60,0,200,1),s("v2a","degree",30,-200,200,1),s("v2l","mm",60,0,200,1)],paramSvg:{p1x:"verify_vector_p1x.svg",p1y:"verify_vector_p1x.svg",p2x:"verify_vector_p1x.svg",p2y:"verify_vector_p1x.svg",v1a:"verify_vector_p1x.svg",v1l:"verify_vector_p1x.svg",v2a:"verify_vector_p1x.svg",v2l:"verify_vector_p1x.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function Yr(n,e,g=""){const t=He(Jo.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=ie(e.p1x,e.p1y+n),i=ie(e.p2x,e.p2y),r=oo(Pe(e.v1a),e.v1l,a),d=oo(Pe(e.v2a),e.v2l,a);o.addPoint(a),o.addPoint(i),o.addVector(r),o.addVector(d);const u=r.add(d),l=u.translatePoint(i);o.addVector(u),o.addPoint(l),t.fig={one:o},t.logstr+=`verify_vector drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var Zr={pTitle:"Verify vector",pDescription:"Debugging vector.ts",pDef:Jo,pGeom:Yr},Uo={partName:"verify_contour_1",params:[s("r1","mm",30,10,200,1),s("d1","mm",20,10,200,1),s("w1","mm",100,10,200,1),s("r2","mm",60,10,200,1),s("l1","mm",10,5,200,1),s("l2","mm",30,5,200,1)],paramSvg:{r1:"verify_contour_1_r1.svg",d1:"verify_contour_1_r1.svg",w1:"verify_contour_1_r1.svg",r2:"verify_contour_1_r1.svg",l1:"verify_contour_1_l1.svg",l2:"verify_contour_1_l1.svg"},sim:{tMax:10,tStep:.5,tUpdate:500}};function Kr(n,e,g=""){const t=He(Uo.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=e.r1,i=e.d1,r=e.w1,d=e.r2,u=e.l1,l=e.l2,_=6*a+4*i,f=r/2,h=i+a,c=2*a+i,S=h+c,L=h+2*c,w=B(0,0);w.addSegStrokeA(r,0),w.addSegStrokeA(r,_),w.addSegStrokeA(0,_),w.closeSegStroke(),w.check(),o.addMainOI([w,N(f,h,a),N(f,S,a+n),N(f,L,a)]);const v=N(r+d,3*h,d);v.check(),o.addSecond(v);const P=B(200+u,200).addSegStrokeA(200+u+l,200).addSegStrokeR(0,u).addSegStrokeRP(0,u).addSegStrokeRP(Math.PI/2,l).addSegStrokeAP(Math.PI/4,Math.sqrt(2)*(200+u+l)).addSegStrokeA(200+u+l,200+2*u+l).addSegStrokeR(-l,0).addSegStrokeR(0,-u).addSegStrokeR(-u,0).addSegStrokeRP(-Math.PI/2,l).addSegStrokeR(u,0).closeSegStroke();P.check(),o.addSecond(P),t.fig={one:o},t.logstr+=`verify_contour_1 drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var Qr={pTitle:"Verify contour 1",pDescription:"Debugging contour.ts",pDef:Uo,pGeom:Kr},jo={partName:"verify_contour_2",params:[s("r1","mm",20,5,200,1),s("a1","deg",30,-200,200,1),s("at1","deg",30,-200,200,1),s("at2","deg",50,-200,200,1)],paramSvg:{r1:"verify_contour_1_r1.svg",a1:"verify_contour_1_r1.svg",at1:"verify_contour_1_r1.svg",at2:"verify_contour_1_r1.svg"},sim:{tMax:10,tStep:.5,tUpdate:500}};function ei(n,e,g=""){const t=He(jo.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=[],a=J(),i=e.r1+n,r=e.a1+n,d=e.at1+n,u=e.at2+n,l=B(20,20);l.addSegStrokeA(40,20),l.addPointA(60,20).addSegArc(i,!0,!0),l.addPointA(80,20).addSegArc(i,!0,!1),l.addPointA(100,20).addSegArc(i,!1,!0),l.addPointA(120,20).addSegArc(i,!1,!1),l.addSegStrokeA(140,20),l.addSegStrokeA(140,40),l.addPointA(140,60).addSegArc(i,!0,!0),l.addPointA(140,80).addSegArc(i,!0,!1),l.addPointA(140,100).addSegArc(i,!1,!0),l.addPointA(140,120).addSegArc(i,!1,!1),l.addSegStrokeA(140,140),l.addSegStrokeA(120,140),l.addPointA(100,140).addSegArc(i,!0,!0),l.addPointA(80,140).addSegArc(i,!0,!1),l.addPointA(60,140).addSegArc(i,!1,!0),l.addPointA(40,140).addSegArc(i,!1,!1),l.addSegStrokeA(20,140),l.addSegStrokeA(20,120),l.addPointA(20,100).addSegArc(i,!0,!0),l.addPointA(20,80).addSegArc(i,!0,!1),l.addPointA(20,60).addSegArc(i,!1,!0),l.addPointA(20,40).addSegArc(i,!1,!1),l.closeSegStroke(),l.check(),o.push(l),a.addMainOI(o);const _=B(20,-20);_.addSegStrokeA(40,-40),_.addPointA(60,-60).addSegArc(i,!0,!0),_.addPointA(80,-80).addSegArc(i,!0,!1),_.addPointA(100,-100).addSegArc(i,!1,!0),_.addPointA(120,-120).addSegArc(i,!1,!1),_.addSegStrokeA(140,-140),_.addSegStrokeR(20,20).addPointR(20,20).addSegArc(i,!1,!1).addPointRP(Math.PI/4,28).addSegArc(i,!1,!0).addPointRP(Math.PI/4,28).addSegArc(i,!0,!0).addPointRP(Math.PI/4,28).addSegArc(i,!0,!1).addSegStrokeRP(Math.PI/4,20).addSegStrokeRP(-Math.PI/4,20).addPointR(10,-9).addPointR(20,-20).addSegArc2().addPointR(20,-9).addPointR(20,-20).addSegArc2().addPointR(9,-6).addPointR(20,-20).addSegArc2().addPointR(9,-14).addPointR(20,-20).addSegArc2().addPointR(9,0).addPointR(20,-20).addSegArc2().addSegStrokeR(20,-20).addSegStrokeR(20,20).addPointR(9,20).addPointR(20,20).addSegArc2().addPointR(20,10).addPointR(20,20).addSegArc2().addPointR(9,6).addPointR(20,20).addSegArc2().addPointR(9,14).addPointR(20,20).addSegArc2().addPointR(9,0).addPointR(20,20).addSegArc2().addSegStrokeR(20,20).addSegStrokeR(0,20).addPointR(15,8).addPointR(0,20).addSegArc2().addPointR(-15,8).addPointR(0,20).addSegArc2().addPointR(5,8).addPointR(0,20).addSegArc2().addPointR(-5,8).addPointR(0,20).addSegArc2().addSegStrokeR(0,20).addSegStrokeR(20,0).addPointR(8,15).addPointR(20,0).addSegArc2().addPointR(8,-15).addPointR(20,0).addSegArc2().addPointR(8,5).addPointR(20,0).addSegArc2().addPointR(8,-5).addPointR(20,0).addSegArc2().addSegStrokeR(20,0).addSegStrokeR(0,-20).addPointR(15,-8).addPointR(0,-20).addSegArc2().addPointR(-15,-8).addPointR(0,-20).addSegArc2().addPointR(5,-8).addPointR(0,-20).addSegArc2().addPointR(-5,-8).addPointR(0,-20).addSegArc2().addSegStrokeR(0,-20).addSegStrokeR(-20,0).addPointR(-8,15).addPointR(-20,0).addSegArc2().addPointR(-8,-15).addPointR(-20,0).addSegArc2().addPointR(-8,5).addPointR(-20,0).addSegArc2().addPointR(-8,-5).addPointR(-20,0).addSegArc2().addSegStrokeR(-20,0).closeSegStroke(),_.check(),a.addMainO(_);const f=B(200,200).addSegStrokeR(20,0).addPointR(20,0).addSegArc3(Pe(r),!0).addSegStrokeR(20,0).addPointR(20,0).addSegArc3(Pe(r),!1).addSegStrokeR(20,0).addSegStrokeR(0,20).addPointR(0,20).addSegArc3(Pe(r),!0).addSegStrokeR(0,20).addPointR(0,20).addSegArc3(Pe(r),!1).addSegStrokeR(0,20).addSegStrokeR(-20,0).addPointR(-20,0).addSegArc3(Pe(r),!0).addSegStrokeR(-20,0).addPointR(-20,0).addSegArc3(Pe(r),!1).addSegStrokeR(-20,0).addSegStrokeR(0,-20).addPointR(0,-20).addSegArc3(Pe(r),!0).addSegStrokeR(0,-20).addPointR(0,-20).addSegArc3(Pe(r),!1).addSegStrokeR(0,-20);f.check(),a.addMainO(f);const h=B(600,200).addSegStrokeR(20,20).addPointR(20,20).addSegArc3(Pe(r),!0).addSegStrokeR(20,20).addPointR(20,20).addSegArc3(Pe(r),!1).addSegStrokeR(20,20).addSegStrokeR(-20,20).addPointR(-20,20).addSegArc3(Pe(r),!0).addSegStrokeR(-20,20).addPointR(-20,20).addSegArc3(Pe(r),!1).addSegStrokeR(-20,20).addSegStrokeR(-20,-20).addPointR(-20,-20).addSegArc3(Pe(r),!0).addSegStrokeR(-20,-20).addPointR(-20,-20).addSegArc3(Pe(r),!1).addSegStrokeR(-20,-20).addSegStrokeR(20,-20).addPointR(20,-20).addSegArc3(Pe(r),!0).addSegStrokeR(20,-20).addPointR(20,-20).addSegArc3(Pe(r),!1).addSegStrokeR(20,-20);h.check(),a.addMainO(h);const c=B(100,500);for(let S=0;S<8;S++){const L=S*45,w=Pe(L);c.addSegStrokeRP(w,20).addPointRP(w,20).addSeg2Arcs(Pe(L+d),Pe(180+L-u)).addSegStrokeRP(w,20).addPointRP(w,20).addSeg2Arcs(Pe(L-d),Pe(180+L+u)).addSegStrokeRP(w,20)}c.check(),a.addMainO(c),t.fig={one:a},t.logstr+=`verify_contour_2 drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var ti={pTitle:"Verify contour 2",pDescription:"Debugging more contour.ts",pDef:jo,pGeom:ei},Wo={partName:"verify_contour_3",params:[s("r1","mm",10,0,200,1),s("r2","mm",10,0,200,1),s("r3","mm",10,0,200,1),s("r4","mm",10,0,200,1),s("r5","mm",10,0,200,1),s("r6","mm",5,0,200,1)],paramSvg:{r1:"verify_contour_1_r1.svg",r2:"verify_contour_1_r1.svg",r3:"verify_contour_1_r1.svg",r4:"verify_contour_1_r1.svg",r5:"verify_contour_1_r1.svg",r6:"verify_contour_1_r1.svg"},sim:{tMax:10,tStep:.5,tUpdate:500}};function si(n,e,g=""){const t=He(Wo.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=e.r1+n,i=e.r2+n,r=e.r3+n,d=e.r4+n,u=e.r5+n,l=e.r6+n,_=B(100,0).addSegStrokeR(30,200).addCornerRounded(a).addSegStrokeR(200,30).addCornerRounded(a).addSegStrokeR(-200,30).addCornerRounded(a).addSegStrokeR(-30,200).addCornerRounded(a).addSegStrokeR(-30,-200).addCornerRounded(a).addSegStrokeR(-200,-30).addCornerRounded(a).addSegStrokeR(200,-30).addCornerRounded(a).closeSegStroke().addCornerRounded(a);t.logstr+=_.check(),o.addMainO(_);const f=100,h=B(300,0);for(let K=0;K<4;K++){const ee=90*(1-K);h.addSegStrokeRP(Pe(ee),f).addCornerRounded(i).addSegStrokeRP(Pe(ee-45),f).addCornerRounded(i).addSegStrokeRP(Pe(ee+45),f).addCornerRounded(i).addSegStrokeRP(Pe(ee),f).addCornerRounded(i)}t.logstr+=h.check(),o.addMainO(h);const c=100,S=70,L=B(0,600).addSegStrokeR(c,c);for(let K=0;K<3;K++){const ee=(K&1)!==0,me=(K&2)!==0;L.addSegStrokeR(c,0).addSegStrokeR(0,c).addCornerRounded(r).addPointR(c,0).addSegArc(S,ee,me).addCornerRounded(r).addSegStrokeR(0,-c)}for(let K=0;K<8;K++){const ee=(K&4)===0?1:-1,me=(K&2)!==0,Se=(K&1)!==0;L.addSegStrokeR(c,0).addCornerRounded(r).addPointR(c,0).addSegArc(S,me,Se).addCornerRounded(r).addSegStrokeR(c,0),L.addSegStrokeR(c,-ee*c/8).addCornerRounded(r).addPointR(c,ee*c/4-3*n).addSegArc(S,me,Se).addCornerRounded(r).addSegStrokeR(c,-ee*c/8)}L.addSegStrokeR(c,0).addSegStrokeR(c,-c).closeSegStroke(),t.logstr+=L.check(),o.addMainO(L);const w=B(0,900).addCornerRounded(r).addPointR(c,c).addSegArc(c,!1,!0).addSegStrokeR(0,2*c).addCornerRounded(r).addPointR(c,-c).addSegArc(c,!1,!0).addSegStrokeR(c,0).addCornerRounded(r).addPointR(c,c).addSegArc(c,!1,!1).addCornerRounded(r).addSegStrokeR(0,2*c).addCornerRounded(r).addPointR(-c,c).addSegArc(c,!1,!1).addPointR(c,c).addSegArc(c,!1,!1).addCornerRounded(r).addSegStrokeR(0,3*c).addCornerRounded(r).addPointR(-c,-c).addSegArc(c,!1,!1).addPointR(-c,c).addSegArc(c,!1,!1).addCornerRounded(r).addSegStrokeR(0,-3*c).addCornerRounded(r).addPointR(-c,c).addSegArc(c,!1,!0).addSegStrokeR(-c,0).closeSegStroke();t.logstr+=w.check(),o.addMainO(w);const v=200,P=180,$=B(0,2e3).addPointR(v,0).addSegArc(P,!1,!0).addCornerRounded(d).addPointR(0,v).addSegArc(P,!1,!0).addCornerRounded(d).addPointR(-v,-v).addSegArc(1.4*P,!1,!0).addCornerRounded(d);t.logstr+=$.check(),o.addMainO($);const z=B(400,2e3).addPointR(0,1.7*v).addSegArc(2.3*P,!1,!1).addCornerRounded(d).addPointR(v,-.7*v).addSegArc(P,!1,!1).addCornerRounded(d).addPointR(-v,-v).addSegArc(1.4*P,!1,!1).addCornerRounded(d);t.logstr+=z.check(),o.addMainO(z);const I=B(1e3,2e3).addPointR(v,0).addSegArc(.6*P,!0,!0).addCornerRounded(d).addPointR(0,v).addSegArc(P,!0,!0).addCornerRounded(d).addPointR(-v,-v).addSegArc(1.4*P,!0,!0).addCornerRounded(d);t.logstr+=I.check(),o.addMainO(I);const p=B(3e3,2e3).addPointR(0,1.7*v).addSegArc(2.3*P,!0,!1).addCornerRounded(d).addPointR(v,-.7*v).addSegArc(P,!0,!1).addCornerRounded(d).addPointR(-v,-v).addSegArc(1.1*P,!0,!1).addCornerRounded(d);t.logstr+=p.check(),o.addMainO(p);const R=3*v,k=3*P,V=B(3800,2e3).addPointR(R,0).addSegArc(k,!1,!1).addCornerRounded(d).addPointR(0,R).addSegArc(k,!1,!1).addCornerRounded(d).addPointR(-R,0).addSegArc(k,!1,!1).addCornerRounded(d).addPointR(0,-R).addSegArc(k,!1,!1).addCornerRounded(d);t.logstr+=V.check(),o.addMainO(V);const C=B(4500,2e3).addPointR(v,v).addSegArc(v,!1,!1).addPointR(v,-v).addSegArc(v,!1,!1).addCornerRounded(d).addPointR(-v,1.6*v).addSegArc(1.1*P,!1,!0).addCornerRounded(d).addPointR(-v,-1.6*v).addSegArc(1.2*P,!1,!0).addCornerRounded(d);t.logstr+=C.check(),o.addMainO(C);const M=B(5200,2e3).addPointR(v,0).addSegArc(.9*v,!1,!1).addCornerRounded(d).addPointR(v,0).addSegArc(.9*v,!1,!1).addCornerRounded(d).addPointR(-2*v,0).addSegArc(1.3*v,!0,!0).addCornerRounded(d);t.logstr+=M.check(),o.addMainO(M);const q=.999,X=B(6e3,2e3).addPointR(2*v,2*v).addSegArc(1.5*v,!1,!1).addCornerRounded(d).addPointR(2*v,-2*v).addSegArc(1.5*v,!1,!1).addCornerRounded(d).addPointR(-v,v).addSegArc(v,!1,!0).addPointR(-v,-q*v).addSegArc(v,!1,!0).addCornerRounded(d).addPointR(-v,q*v).addSegArc(v,!1,!0).addPointR(-v,-v).addSegArc(v,!1,!0).addCornerRounded(d);t.logstr+=X.check(),o.addMainO(X);const y=200,F=180,j=B(0,3e3).addSegStrokeR(y,0).addCornerWidened(u).addSegStrokeR(0,y).addCornerWidened(u).closeSegStroke().addCornerWidened(u);t.logstr+=j.check(),o.addMainO(j);const Z=B(400,3e3).addSegStrokeR(y,0).addCornerWidened(u).addPointR(0,y).addSegArc(F,!1,!0).addCornerWidened(u).addPointR(-y,0).addSegArc(F,!1,!1).addCornerWidened(u).closeSegStroke().addCornerWidened(u);t.logstr+=Z.check(),o.addMainO(Z);const G=B(3e3,3e3).addPointR(0,1.7*y).addSegArc(2.3*F,!0,!1).addCornerWidened(u).addPointR(y,-.7*y).addSegArc(F,!0,!1).addCornerWidened(u).addPointR(-y,-y).addSegArc(1.1*F,!0,!1).addCornerWidened(u);t.logstr+=G.check(),o.addMainO(G);const O=B(3800,3e3).addPointR(y,0).addSegArc(F,!1,!1).addCornerWidened(u).addPointR(0,y).addSegArc(F,!1,!1).addCornerWidened(u).addPointR(-y,0).addSegArc(F,!1,!1).addCornerWidened(u).addPointR(0,-y).addSegArc(F,!1,!1).addCornerWidened(u);t.logstr+=O.check(),o.addMainO(O);const W=B(4500,3e3).addPointR(y,y).addSegArc(y,!1,!1).addPointR(y,-y).addSegArc(y,!1,!1).addCornerWidened(u).addPointR(-y,1.6*y).addSegArc(1.1*F,!1,!0).addCornerWidened(u).addPointR(-y,-1.6*y).addSegArc(1.2*F,!1,!0).addCornerWidened(u);t.logstr+=W.check(),o.addMainO(W);const D=200,Y=180,E=B(0,4e3).addSegStrokeR(D,0).addCornerWideAcc(l).addSegStrokeR(0,D).addCornerWideAcc(l).closeSegStroke().addCornerWideAcc(l);t.logstr+=E.check(),o.addMainO(E);const Q=B(400,4e3).addSegStrokeR(D,0).addCornerWideAcc(l).addPointR(0,D).addSegArc(Y,!1,!0).addCornerWideAcc(l).addPointR(-D,0).addSegArc(Y,!1,!1).addCornerWideAcc(l).closeSegStroke().addCornerWideAcc(l);t.logstr+=Q.check(),o.addMainO(Q);const ce=B(3e3,4e3).addPointR(0,1.7*D).addSegArc(2.3*Y,!0,!1).addCornerWideAcc(l).addPointR(D,-.7*D).addSegArc(Y,!0,!1).addCornerWideAcc(l).addPointR(-D,-D).addSegArc(1.1*Y,!0,!1).addCornerWideAcc(l);t.logstr+=ce.check(),o.addMainO(ce);const U=B(3800,4e3).addPointR(D,0).addSegArc(Y,!1,!1).addCornerWideAcc(l).addPointR(0,D).addSegArc(Y,!1,!1).addCornerWideAcc(l).addPointR(-D,0).addSegArc(Y,!1,!1).addCornerWideAcc(l).addPointR(0,-D).addSegArc(Y,!1,!1).addCornerWideAcc(l);t.logstr+=U.check(),o.addMainO(U);const T=B(4500,4e3).addPointR(D,D).addSegArc(D,!1,!1).addPointR(D,-D).addSegArc(D,!1,!1).addCornerWideAcc(l).addPointR(-D,1.6*D).addSegArc(1.1*Y,!1,!0).addCornerWideAcc(l).addPointR(-D,-1.6*D).addSegArc(1.2*Y,!1,!0).addCornerWideAcc(l);t.logstr+=T.check(),o.addMainO(T),t.fig={one:o},t.logstr+=`verify_contour_3 drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var oi={pTitle:"Verify contour 3",pDescription:"Debugging contour.ts for rounded corners and widened corners",pDef:Wo,pGeom:si},qo={partName:"verify_contour_4",params:[s("n1","scalar",16,1,50,1),s("n2","scalar",6,3,50,1),s("r1","mm",5,0,20,1)],paramSvg:{n1:"verify_contour_1_r1.svg",n2:"verify_contour_1_r1.svg",r1:"verify_contour_1_r1.svg"},sim:{tMax:10,tStep:.5,tUpdate:500}};function ni(n,e,g=""){const t=He(qo.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=e.n1,i=e.n2,r=e.r1,d=50+n,u=2*Math.PI/(i*3),l=B(d,0).addSegStrokeAP(u,1.5*d).addCornerRounded(r).addPointAP(2*u,d).addSegArc(.45*d,!1,!0).addCornerWidened(r).addSegStrokeAP(3*u,1.2*d),_=B(d,0),f=l.clone().addCornerRounded(r);for(let v=0;v<a;v++){const P=f.rotate(0,0,v*3*u).scale(0,0,1+v*.2,!0);_.addPartial(P)}_.closeSegStroke(),t.logstr+=_.check(),o.addMainO(_);const h=B(d,0);for(let v=0;v<a;v++)h.addPartial(f.rotate(0,0,v*3*u).scale(0,0,1+v*.2,!1));h.closeSegStroke(),t.logstr+=h.check(),o.addMainO(h.translate(-10*d,0));const c=l.generateContour(),S=c.clone();for(let v=1;v<a;v++)S.addPartial(c.rotate(0,0,v*3*u).scale(0,0,1+v*.2));S.closeSegStroke();const L=S.translate(10*d,0);t.logstr+=L.check(),o.addMainO(L);const w=S.translatePolar(Math.PI/3,10*d);t.logstr+=w.check(),o.addMainO(w),t.fig={one:o},t.logstr+=`verify_contour_4 drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var ri={pTitle:"Verify contour 4",pDescription:"Debugging contour.ts for addPartial",pDef:qo,pGeom:ni},Xo={partName:"verify_contour_5",params:[s("L1","mm",100,10,200,1),s("L2","mm",100,10,200,1),s("R1","mm",10,0,100,1),s("R2","mm",10,0,100,1)],paramSvg:{L1:"verify_contour_1_r1.svg",L2:"verify_contour_1_r1.svg",R1:"verify_contour_1_r1.svg",R2:"verify_contour_1_r1.svg"},sim:{tMax:10,tStep:.5,tUpdate:500}};function ii(n,e,g=""){const t=He(Xo.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J(),a=B(0,0).addSegStrokeR(e.L1,0).addCornerRounded(e.R1).addSegStrokeR(0,e.L2).addCornerRounded(e.R2).closeSegStroke();t.logstr+=a.check(),o.addMainO(a);const i=a.generateRevertOrientation().translate(300,0);t.logstr+=i.check(),o.addMainO(i);const r=B(0,300).addSegStrokeR(e.L1,0).addCornerRounded(e.R1).addSegStrokeR(0,e.L2).closeSegStroke().addCornerRounded(e.R2);t.logstr+=r.check(),o.addMainO(r);const d=r.generateRevertOrientation().translate(300,0);t.logstr+=d.check(),o.addMainO(d);const u=B(0,600).addCornerRounded(e.R2).addSegStrokeR(e.L1,0).addCornerRounded(e.R1).addSegStrokeR(0,e.L2).closeSegStroke();t.logstr+=u.check(),o.addMainO(u);const l=u.generateRevertOrientation().translate(300,0);t.logstr+=l.check(),o.addMainO(l);const _=B(0,900).addSegStrokeR(e.L1,0).addCornerRounded(e.R1).addPointR(0,e.L2).addSegArc(e.L2,!1,!1).addCornerRounded(e.R2).closeSegStroke();t.logstr+=_.check(),o.addMainO(_);const f=_.generateRevertOrientation().translate(300,0);t.logstr+=f.check(),o.addMainO(f);const h=B(0,1200).addSegStrokeR(e.L1,0).addCornerRounded(e.R1).addPointR(0,e.L2).addSegArc(e.L2,!1,!1).closeSegArc(e.L1+e.L2,!1,!0).addCornerRounded(e.R2);t.logstr+=h.check(),o.addMainO(h);const c=h.generateRevertOrientation().translate(300,0);t.logstr+=c.check(),o.addMainO(c),t.fig={one:o},t.logstr+=`verify_contour_5 drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var ai={pTitle:"Verify contour 5",pDescription:"Debugging contour.ts for revert-contour",pDef:Xo,pGeom:ii},Yo={partName:"verify_exports_1",params:[ct("circle",!0),s("circle-size","mm",100,1,1e3,1),ct("contour",!0),s("contour-size","mm",30,1,1e3,1),ct("contour-arc-large",!1)],paramSvg:{circle:"default_param_blank.svg","circle-size":"default_param_blank.svg",contour:"default_param_blank.svg","contour-size":"default_param_blank.svg","contour-arc-large":"default_param_blank.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function di(n,e,g=""){const t=He(Yo.partName+g);t.logstr+=`${t.partName} simTime: ${n}
`;try{const o=J();if(e.circle===1){const i=N(0,0,e["circle-size"]);o.addMainO(i)}if(e.contour===1){const i=e["contour-size"],r=e["contour-arc-large"]===1,d=B(0,0).addSegStrokeA(i,0).addPointA(i,i).addSegArc(i*.8,r,!0).closeSegStroke();o.addMainO(d)}t.fig={one:o};const a=t.partName;t.vol={extrudes:[{outName:`subpax_${a}_one`,face:`${a}_one`,extrudeMethod:se.eLinearOrtho,length:10,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${a}`,boolMethod:be.eIdentity,inList:[`subpax_${a}_one`]}]},t.logstr+=`verify_exports_1 drawn successfully!
`,t.calcErr=!1}catch(o){t.logstr+=o,console.log(o)}return t}var li={pTitle:"Verify exports 1",pDescription:"For dev & debug of Openscad export",pDef:Yo,pGeom:di};const ci="/docs/apidoc/",$s=[{category:"",pages:[{path:"/",page:null,svg:"page_index.svg"}]},{category:"Gears",pages:[{path:"/gear/gear_wheel",page:Zn,svg:"page_gearwheel.svg"},{path:"/gear/gear_bar",page:Qn,svg:"page_gearbar.svg"},{path:"/gear/gear_ring",page:tr,svg:"page_gearring.svg"},{path:"/gear/gear_epicycloid",page:or,svg:"page_epicycloid.svg"}]},{category:"Heliostat",pages:[{path:"/heliostat/heliostat",page:ur,svg:"page_heliostat.svg"},{path:"/heliostat/heliostat_2",page:_r,svg:"page_heliostat.svg"},{path:"/heliostat/base",page:Sr,svg:"page_base.svg"},{path:"/heliostat/pole_static",page:vs,svg:"page_pole_static.svg"},{path:"/heliostat/vaxis",page:pr,svg:"page_vaxis.svg"},{path:"/heliostat/ring",page:xr,svg:"page_vaxis.svg"},{path:"/heliostat/vaxis_holder",page:Ft,svg:"page_vaxis.svg"},{path:"/heliostat/ring_guidance",page:br,svg:"page_vaxis.svg"},{path:"/heliostat/vaxis_guidance",page:mr,svg:"page_vaxis.svg"},{path:"/heliostat/rake",page:Ss,svg:"page_rake.svg"},{path:"/heliostat/rake_stopper",page:Xs,svg:"page_rake.svg"},{path:"/heliostat/haxis_guidance",page:wr,svg:"page_vaxis.svg"},{path:"/heliostat/spider",page:Ws,svg:"page_spider.svg"},{path:"/heliostat/swing",page:Ls,svg:"page_swing.svg"},{path:"/heliostat/rod",page:Ar,svg:"page_rod.svg"},{path:"/heliostat/trapeze",page:yr,svg:"page_trapeze.svg"},{path:"/heliostat/surface",page:$r,svg:"page_surface.svg"}]},{category:"Junk designs",pages:[{path:"/junk/circles",page:Cr,svg:"page_circles.svg"},{path:"/junk/rectangle",page:Ir,svg:"page_rectangle.svg"},{path:"/junk/voila",page:Vr,svg:"page_rectangle.svg"}]},{category:"Geometrix verification",pages:[{path:"/dev/verify_point",page:Fr,svg:"page_verify_point.svg"},{path:"/dev/verify_point_2",page:Gr,svg:"page_verify_point.svg"},{path:"/dev/verify_line",page:Ur,svg:"page_verify_line.svg"},{path:"/dev/verify_line_2",page:Wr,svg:"page_verify_line.svg"},{path:"/dev/verify_line_3",page:Xr,svg:"page_verify_line.svg"},{path:"/dev/verify_vector",page:Zr,svg:"page_verify_line.svg"},{path:"/dev/verify_contour_1",page:Qr,svg:"page_verify_line.svg"},{path:"/dev/verify_contour_2",page:ti,svg:"page_verify_line.svg"},{path:"/dev/verify_contour_3",page:oi,svg:"page_verify_line.svg"},{path:"/dev/verify_contour_4",page:ri,svg:"page_verify_line.svg"},{path:"/dev/verify_contour_5",page:ai,svg:"page_verify_line.svg"},{path:"/dev/verify_exports_1",page:li,svg:"page_verify_line.svg"}]},{category:"Dynamic design import",pages:[{path:"/import",page:null,svg:"page_about.svg"}]},{category:"Docs",pages:[{path:ci,page:null,svg:"page_about.svg"},{path:"/docs/readme",page:null,svg:"page_readme.svg"},{path:"/docs/concept",page:null,svg:"page_concept.svg"},{path:"/docs/geom-dev",page:null,svg:"page_geom.svg"},{path:"/docs/geom-user",page:null,svg:"page_geom.svg"},{path:"/docs/geom-tutorial",page:null,svg:"page_geom.svg"},{path:"/docs/ui",page:null,svg:"page_ui.svg"},{path:"/docs/lists",page:null,svg:"page_geom.svg"},{path:"/docs/prez-1",page:null,svg:"page_concept.svg"},{path:"/docs/prez-2",page:null,svg:"page_concept.svg"},{path:"/docs/prez-2-fr",page:null,svg:"page_concept.svg"},{path:"/docs/prez-3",page:null,svg:"page_concept.svg"},{path:"/docs/js-app",page:null,svg:"page_jsapp.svg"},{path:"/docs/motors",page:null,svg:"page_gears.svg"},{path:"/docs/gears",page:null,svg:"page_gears.svg"},{path:"/docs/involute",page:null,svg:"page_gears.svg"},{path:"/docs/magnetic",page:null,svg:"page_magnetic.svg"},{path:"/docs/axis",page:null,svg:"page_axis.svg"},{path:"/docs/cad-ecosystem",page:null,svg:"page_concept.svg"}]},{category:"",pages:[{path:"/about",page:null,svg:"page_about.svg"}]}],Oe=Bt({});function gi(n){for(const e of Object.keys(n)){const g={};for(const t of n[e].pDef.params)g[t.name]=t.init;Oe[e]=g}}function Zo(n,e,g){if(Object.keys(Oe).includes(n)){const o=Oe[n],a=Object.keys(o);for(const i of Object.keys(e))a.includes(i)?g&&(o[i]=e[i]):o[i]=e[i];Oe[n]=o}else Oe[n]=e}function $a(n){const e=n.pDef.partName,g={};for(const t of n.pDef.params)g[t.name]=t.init;Zo(e,g,!1)}var ui=Me('<aside class="backdrop svelte-qoipkr"><div class="dialog svelte-qoipkr"><button class="svelte-qoipkr"><img/></button></div></aside>');function Ko(n,e){st(e,!0);let g=at(e,"modalOpen",15);function t(){g(!1)}var o=Qs(),a=Pt(o);{var i=r=>{var d=ui(),u=b(d),l=b(u),_=b(l);x(l),x(u),x(d),Ge(()=>{$e(_,"src",e.svgPath),$e(_,"alt",e.svgPath)}),oe("click",l,t),De(r,d)};ps(a,r=>{g()&&r(i)})}De(n,o),ot()}Lt(["click"]);var hi=Me('<button class="svelte-12sscyt"><img class="svelte-12sscyt"/></button>'),fi=Me('<section class="svelte-12sscyt"><!> <!></section>');function Ea(n,e){st(e,!0);function g(l){const _=[];for(const f of Object.values(l.paramSvg))_.includes(f)||_.push(f);return _}let t=Ce(!1),o=Ce(""),a=Qe(()=>g(e.pDef).map(l=>Us(`/pgdsvg/${l}`)));function i(l){ae(o,l,!0),ae(t,!0)}var r=fi(),d=b(r);Ko(d,{get svgPath(){return A(o)},get modalOpen(){return A(t)},set modalOpen(l){ae(t,l,!0)}});var u=H(d,2);gt(u,16,()=>A(a),l=>l,(l,_)=>{var f=hi(),h=b(f);x(f),Ge(()=>{$e(h,"src",_),$e(h,"alt",_)}),oe("click",f,()=>i(_)),De(l,f)}),x(r),De(n,r),ot()}Lt(["click"]);var _i=Me('<aside class="backdrop svelte-c5gucl"><div><article class="question svelte-c5gucl"><!></article> <footer class="svelte-c5gucl"><button class="cancel svelte-c5gucl">Cancel</button> <button class="ok svelte-c5gucl"> </button></footer></div></aside>');function fs(n,e){st(e,!0);let g=at(e,"okName",3,"Ok"),t=at(e,"modalOpen",15),o=at(e,"sizeLarge",3,!1);function a(){t(!1)}function i(){e.okFunc(),t(!1)}var r=Qs(),d=Pt(r);{var u=l=>{var _=_i(),f=b(_);let h;var c=b(f),S=b(c);En(S,()=>e.children),x(c);var L=H(c,2),w=b(L),v=H(w,2),P=b(v,!0);x(v),x(L),x(f),x(_),Ge(()=>{h=tt(f,1,"dialog svelte-c5gucl",null,h,{sizeLarge:o()}),ve(P,g())}),oe("click",w,a),oe("click",v,i),De(l,_)};ps(d,l=>{t()&&l(u)})}De(n,r),ot()}Lt(["click"]);var vi=Me('<p class="diagItem svelte-bifaxb"> </p>'),Si=Me('<p class="diagTitle svelte-bifaxb">Do you really want to delete the following localStorage keys?</p> <!>',1),Li=Me('<tr class="svelte-bifaxb"><td><input type="checkbox"/></td><td class="svelte-bifaxb"><button class="svelte-bifaxb"> </button></td><td> </td></tr>'),pi=Me('<div class="deleteKeys svelte-bifaxb"><button class="svelte-bifaxb">Delete</button> <!> <table class="svelte-bifaxb"><thead class="svelte-bifaxb"><tr><td>Delete</td><td>Key name</td><td>Last modification</td></tr><tr><td><input type="checkbox"/></td><td class="instruction">delete all</td><td></td></tr></thead><tbody class="svelte-bifaxb"></tbody></table></div>');function Qo(n,e){st(e,!0);let g=at(e,"storeName",15),t=at(e,"localKeys",15),o=Ce(Bt({})),a=Ce(!1),i=Ce(!1);function r(){let p=[];const R=new RegExp(`^${e.pageName}_`);return p=Object.keys(window.localStorage).filter(V=>R.test(V)).map(V=>V.replace(R,"")),p.sort(),p}t(r());function d(p){g(p)}function u(p){let R={};for(const k of p){let V="";const C=`${e.pageName}_${k}`,M=window.localStorage.getItem(C);M!==null&&(V=JSON.parse(M).lastModif),R[k]=V}return R}let l=Qe(()=>u(t()));function _(p){let R={};for(const k of p)R[k]=!1;return R}ae(o,_(t()),!0);function f(){for(const p of t())A(o)[p]=A(a)}function h(){for(const p of t())if(A(o)[p]){const R=`${e.pageName}_${p}`;window.localStorage.removeItem(R)}ae(a,!1),t(r())}var c=pi(),S=b(c),L=H(S,2);fs(L,{okName:"Confirm",okFunc:h,get modalOpen(){return A(i)},set modalOpen(p){ae(i,p,!0)},children:(p,R)=>{var k=Si(),V=H(Pt(k),2);gt(V,16,t,C=>C,(C,M)=>{var q=Qs(),X=Pt(q);{var y=F=>{var j=vi(),Z=b(j,!0);x(j),Ge(()=>ve(Z,M)),De(F,j)};ps(X,F=>{A(o)[M]&&F(y)})}De(C,q)}),De(p,k)},$$slots:{default:!0}});var w=H(L,2),v=b(w),P=H(b(v)),$=b(P),z=b($);Je(z),x($),rt(2),x(P),x(v);var I=H(v);gt(I,20,t,p=>p,(p,R)=>{var k=Li(),V=b(k),C=b(V);Je(C),x(V);var M=H(V),q=b(M),X=b(q,!0);x(q),x(M);var y=H(M),F=b(y,!0);x(y),x(k),Ge(()=>{ve(X,R),ve(F,A(l)[R])}),it(C,()=>A(o)[R],j=>A(o)[R]=j),oe("click",q,()=>d(R)),De(p,k)}),x(I),x(w),x(c),oe("click",S,()=>{ae(i,!0)}),oe("change",z,f),it(z,()=>A(a),p=>ae(a,p)),De(n,c),ot()}Lt(["click","change"]);var Pi=Me('<p class="warnMsg svelte-8w4g7s"> </p>'),xi=Me('<!> <div class="svelte-8w4g7s"><label for="storName" class="svelte-8w4g7s">Give a name to your parameter-set:</label> <input type="text" id="storName" required="" minlength="4" maxlength="30" size="32" class="svelte-8w4g7s"/> <!></div>',1);function Di(n,e){st(e,!0);let g=at(e,"storeName",15),t=Ce(Bt([]));function o(f){const h=/[-:]/g,c=/\..*$/,S=new Date().toISOString().replace(h,"").replace(c,"").replace("T","_");return`${f}_${S}`}g(o(e.pageName));let a=Qe(()=>A(t).includes(g()));var i=xi(),r=Pt(i);Qo(r,{get pageName(){return e.pageName},get storeName(){return g()},set storeName(f){g(f)},get localKeys(){return A(t)},set localKeys(f){ae(t,f,!0)}});var d=H(r,2),u=H(b(d),2);Je(u);var l=H(u,2);{var _=f=>{var h=Pi(),c=b(h);x(h),Ge(()=>ve(c,`Warning: name ${g()??""} already used`)),De(f,h)};ps(l,f=>{A(a)&&f(_)})}x(d),Xt(u,g),De(n,i),ot()}var bi=Me('<!> <div class="svelte-74yr5r"><label for="storName" class="svelte-74yr5r">Select a parameter-set:</label> <input type="text" id="storName" readonly="" minlength="4" maxlength="30" size="32" class="svelte-74yr5r"/></div>',1);function Hi(n,e){st(e,!0);let g=at(e,"storeName",15),t=Ce(Bt([]));function o(u){let l=g();return!u.includes(l)&&(u.length>0?l=u[0]:l=""),l}eo(()=>{g(o(A(t)))});var a=bi(),i=Pt(a);Qo(i,{get pageName(){return e.pageName},get storeName(){return g()},set storeName(u){g(u)},get localKeys(){return A(t)},set localKeys(u){ae(t,u,!0)}});var r=H(i,2),d=H(b(r),2);Je(d),x(r),Ge(()=>Ms(d,g())),De(n,a),ot()}const fe=Bt({dLayers:ln(),zAdjust:dn(),canvasZWidth:0});var mi=Me('<canvas class="mini svelte-1a2f2q3"></canvas>');function _o(n,e){st(e,!0);const g=200,t=.6;let o;function a(d,u,l,_){const f=cn(_);f.ruler=!1;let h;if(o){const c=o.getContext("2d");c.clearRect(0,0,c.canvas.width,c.canvas.height);const S=c.canvas.width;try{e.full?h=d.getAdjustFull(c.canvas.width,c.canvas.height):h=gn(l,S,u),d.draw(c,h,f)}catch(L){console.log(L)}}}eo(()=>{a(e.pFig,fe.zAdjust,fe.canvasZWidth,fe.dLayers)});function i(d){const u=d.offsetX,l=d.offsetY,_=o.getContext("2d"),f=_.canvas.width/2,h=_.canvas.height/2;if(d.button===0){let c=1;u>f&&(c+=1*t),l>h&&(c+=2*t),_.canvas.width=c*g,_.canvas.height=c*g,a(e.pFig,fe.zAdjust,fe.canvasZWidth,fe.dLayers)}}var r=mi();$e(r,"width",g),$e(r,"height",g),ys(r,d=>o=d,()=>o),oe("click",r,i),De(n,r),ot()}Lt(["click"]);function ki(n,e){const g=document.createElement("a");g.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),g.setAttribute("download",n),g.click(),g.remove()}function wi(n,e,g){const t=/[-:]/g,o=/\..*$/,a=new Date().toISOString().replace(t,"").replace(o,"").replace("T","_");return Ks(a,n,e,g)}function to(n,e,g){const t=/[-:]/g,o=/\..*$/,a=new Date().toISOString().replace(t,"").replace(o,"").replace("T","_"),i=`px_${n}_${a}.json`,r=Ks(a,n,e,g);ki(i,r)}function Ri(n,e,g){const t=new URL(n),o=2e3;let a=t.toString().length;for(const i of Object.keys(e)){const r=e[i].toString(),d=2+i.length+r.length;t.searchParams.append(encodeURIComponent(i),encodeURIComponent(r)),a+=d}return a>=o&&console.log(`warn547: generateUrl: strLength ${a} larger than strLengthLimit ${o}`),t.toString()}const Ai=Symbol();class Mi extends URLSearchParams{#e=Ce(0);#o=Ni();#t=!1;#s(){if(!this.#o||this.#t)return;this.#t=!0;const e=this.toString();this.#o.search=e&&`?${e}`,this.#t=!1}[Ai](e){if(!this.#t){this.#t=!0;for(const g of[...super.keys()])super.delete(g);for(const[g,t]of e)super.append(g,t);hs(this.#e),this.#t=!1}}append(e,g){super.append(e,g),this.#s(),hs(this.#e)}delete(e,g){var t=super.has(e,g);super.delete(e,g),t&&(this.#s(),hs(this.#e))}get(e){return A(this.#e),super.get(e)}getAll(e){return A(this.#e),super.getAll(e)}has(e,g){return A(this.#e),super.has(e,g)}keys(){return A(this.#e),super.keys()}set(e,g){var t=super.getAll(e).join("");super.set(e,g),t!==super.getAll(e).join("")&&(this.#s(),hs(this.#e))}sort(){super.sort(),this.#s(),hs(this.#e)}toString(){return A(this.#e),super.toString()}values(){return A(this.#e),super.values()}entries(){return A(this.#e),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return A(this.#e),super.size}}let yi=null;function Ni(){return yi}var $i=Me('<input type="number" class="input-number svelte-e6cp59"/> <input type="range" class="svelte-e6cp59"/>',1),Ei=Me("<option> </option>"),Ci=Me("<select></select>"),Oi=Me("<option> </option>"),Ii=Me("<select></select>"),zi=Me('<tr><td class="svelte-e6cp59"> </td><td class="svelte-e6cp59"><button class="svelte-e6cp59"> </button></td><td class="svelte-e6cp59"><!></td><td> </td><td> </td><td class="svelte-e6cp59"> </td><td class="svelte-e6cp59"> </td><td> </td></tr>'),Vi=Me('<tbody class="svelte-e6cp59"><tr class="separator svelte-e6cp59"><td class="svelte-e6cp59"> </td><td class="svelte-e6cp59"> </td><td class="svelte-e6cp59"><label class="svelte-e6cp59"><input type="checkbox" class="svelte-e6cp59"/> <span class="svelte-e6cp59"></span></label></td></tr></tbody> <tbody></tbody>',1),Ti=Me('<p>Copy this URL and send it to your friends!</p> <p class="cUrl svelte-e6cp59"> </p>',1),Fi=Me('<section class="svelte-e6cp59"><h2 class="svelte-e6cp59">Parameters</h2> <main class="svelte-e6cp59"><label for="loadFParams" class="fileUpload svelte-e6cp59">Load Params from File</label> <input id="loadFParams" type="file" accept="text/plain, application/json" class="svelte-e6cp59"/> <button class="svelte-e6cp59">Set Params Default</button> <button class="svelte-e6cp59">Load Params from localStorage</button> <!> <!> <textarea rows="3" cols="80" readonly="" wrap="soft"></textarea> <table class="svelte-e6cp59"><thead class="svelte-e6cp59"><tr class="svelte-e6cp59"><td class="svelte-e6cp59">&#35;</td><td class="svelte-e6cp59">Parameter name</td><td class="svelte-e6cp59">Value<span class="svelte-e6cp59"><button class="svelte-e6cp59">&minus;</button><button class="svelte-e6cp59">+</button></span></td><td>Unit</td><td>Default</td><td class="svelte-e6cp59">Min</td><td class="svelte-e6cp59">Max</td><td>Step</td></tr></thead><!></table> <div class="comment svelte-e6cp59"><label for="inComment">Comment:</label> <input type="text" id="inComment" maxlength="150"/></div> <button class="svelte-e6cp59">Save Parameters to File</button> <button class="svelte-e6cp59">Save Parameters as URL</button> <button class="svelte-e6cp59">Save Parameters to localStorage</button> <!> <!></main> <!> <button class="side-img svelte-e6cp59"><img class="svelte-e6cp59"/></button> <div class="mini-canvas svelte-e6cp59"><!></div> <div class="mini-canvas svelte-e6cp59"><!></div></section>');function Bi(n,e){st(e,!0);let g=Ce(""),t=Ce(!1),o=Ce(""),a=Ce(!1),i=Ce(!1),r=Ce(!1),d=Ce(!1),u=Ce(!1),l=Ce(""),_=Ce(""),f=Ce("");const h=e.pDef;let c=Ce(Bt(X(h.params[0].name))),S=Ce(!1),L=Ce(Bt(Z(j(h.params))));vo(()=>{ae(c,X(e.pDef.params[0].name),!0),ae(L,Z(j(e.pDef.params)),!0)});function w(ne,re){let pe="",we=!1;ne!==e.pDef.partName&&(pe+=`warn361: read partName: '${ne}'  expected partName: '${e.pDef.partName}'
`,we=!0);let Te=0,Xe=0,lt=0;const Ut=[];for(const Ye of e.pDef.params)Ut.push(Ye.name),Object.hasOwn(re,Ye.name)?(Te+=1,Oe[e.pDef.partName][Ye.name]===re[Ye.name]?lt+=1:Oe[e.pDef.partName][Ye.name]=re[Ye.name]):Xe+=1;let nt=0;for(const Ye of Object.keys(re))Ut.includes(Ye)||(nt+=1,pe+=`warn363: parameter ${Ye} not in the scope of the design (${nt})
`);const Qt=nt>0,Mt=new Date().toLocaleTimeString();return pe+=`Params loaded at ${Mt} :`,pe+=` def-nb: ${Object.keys(e.pDef.params).length}`,pe+=`, cover-nb: ${Te}, uncover-nb: ${Xe}
`,pe+=` load-nb: ${Object.keys(re).length}`,pe+=`, equal-nb: ${lt}, changed-nb: ${Te-lt}`,pe+=`, out-of-scope: ${nt}`,[pe,we||Qt]}async function v(ne){try{const re=await fetch(ne);if(!re.ok)throw`err627: error while fetching ${ne}`;const pe=await re.text(),[we]=no(pe);(Te=>{var Xe=As(Te,2);ae(o,Xe[0],!0),ae(a,Xe[1],!0)})(w(we.partName,we.pVal)),ae(g,we.comment,!0)}catch(re){let pe=`err223: error by fetching px file
`;pe+=re,ae(o,pe,!0),ae(a,!0)}}async function P(){{const ne=new Mi(go.url.search),re="pxUrl";if(ne.has(re)){const we=ne.get(re);ne.delete(re),we?await v(we):(ae(o,`err123: error by parsing URL-search-params
`),ae(a,!0))}const pe={};for(const[we,Te]of ne){const Xe=Number(Te);isNaN(Xe)||(pe[we]=Xe)}Object.keys(pe).length>0&&(we=>{var Te=As(we,2);ae(o,Te[0],!0),ae(a,Te[1],!0)})(w(e.pDef.partName,pe))}}P();function $(ne){try{const[re]=no(ne);(pe=>{var we=As(pe,2);ae(o,we[0],!0),ae(a,we[1],!0)})(w(re.partName,re.pVal)),ae(g,re.comment,!0)}catch(re){let pe=`err723: error by parsing parameter file
`;pe+=re,ae(o,pe,!0),ae(a,!0)}}async function z(ne){const re=await ne.text();$(re)}function I(ne){if(ne.target){const re=ne.target.files;re&&z(re[0])}}function p(){to(e.pDef.partName,Oe[e.pDef.partName],A(g))}function R(){const ne={};for(const re of e.pDef.params)ne[re.name]=re.init;(re=>{var pe=As(re,2);ae(o,pe[0],!0),ae(a,pe[1],!0)})(w(e.pDef.partName,ne))}function k(){if(A(l)!==void 0&&A(l)!==""){const ne=`${e.pDef.partName}_${A(l)}`;{const re=window.localStorage.getItem(ne);re===null?(ae(o,`Warn157: localStorage key ${ne} is null`),ae(a,!0)):$(re)}}else ae(o,"Warn239: No valid name for loading from localStorage!"),ae(a,!0)}function V(){if(A(_)!==void 0&&A(_)!==""){const ne=`${e.pDef.partName}_${A(_)}`,re=/\..*$/,pe=new Date().toISOString().replace(re,""),we=Ks(pe,e.pDef.partName,Oe[e.pDef.partName],A(g));window.localStorage.setItem(ne,we)}else console.log("Warn639: No valid name for writing to localStorage!")}function C(){return Ri(go.url.href,Oe[e.pDef.partName]).toString()}function M(){ae(f,C(),!0),ae(d,!0)}function q(){}function X(ne){let re=Us("/pgdsvg/default_param_blank.svg");return Object.keys(e.pDef.paramSvg).includes(ne)&&(re=Us(`/pgdsvg/${e.pDef.paramSvg[ne]}`)),re}function y(ne){ae(c,X(ne),!0)}function F(){ae(S,!0)}function j(ne){const re=[];let we={sectionName:"main",sectionID:"g0main",sectionVisCollapse:!1,params:[]},Te=0;for(const Xe of ne)Xe.pType===ws.eSectionSeparator?(re.push(we),Te+=1,we={sectionName:Xe.name,sectionID:`g${Te}${Xe.name}`,sectionVisCollapse:!0,params:[]}):we.params.push(Xe);return re.push(we),re}function Z(ne){const re={};for(const pe of ne)re[pe.sectionID]=pe.sectionVisCollapse;return re}let G=Qe(()=>j(e.pDef.params));function O(){ae(t,!0)}function W(){ae(t,!1)}let D=Qe(()=>A(t)?2:4),Y=Qe(()=>A(t)?2:3),E=Qe(()=>A(t)?50:70);var Q=Fi(),ce=H(b(Q),2),U=H(b(ce),2),T=H(U,2),K=H(T,2),ee=H(K,2);fs(ee,{okName:"Overwrite Parameters",okFunc:R,get modalOpen(){return A(i)},set modalOpen(ne){ae(i,ne,!0)},children:(ne,re)=>{rt();var pe=ao("Load the default parameters ?");De(ne,pe)},$$slots:{default:!0}});var me=H(ee,2);fs(me,{okName:"Load Parameters",okFunc:k,get modalOpen(){return A(r)},set modalOpen(ne){ae(r,ne,!0)},children:(ne,re)=>{Hi(ne,{get pageName(){return e.pDef.partName},get storeName(){return A(l)},set storeName(pe){ae(l,pe,!0)}})},$$slots:{default:!0}});var Se=H(me,2);Js(Se);let Ee;var _e=H(Se,2),de=b(_e),Fe=b(de),qe=H(b(Fe),2),Ze=H(b(qe)),ge=b(Ze),Ct=H(ge);x(Ze),x(qe);var ut=H(qe);let Rt;var Gt=H(ut);let Ot;var It=H(Gt,3);let xt;x(Fe),x(de);var Dt=H(de);gt(Dt,19,()=>A(G),ne=>ne.sectionName,(ne,re,pe)=>{var we=Vi(),Te=Pt(we),Xe=b(Te),lt=b(Xe),Ut=b(lt,!0);x(lt);var nt=H(lt),Qt=b(nt,!0);x(nt);var Mt=H(nt),es=b(Mt),Ye=b(es);Je(Ye),rt(2),x(es),x(Mt),x(Xe),x(Te);var zt=H(Te,2);let xs;gt(zt,23,()=>A(re).params,kt=>kt.name,(kt,Ne,ts)=>{var jt=zi();let ss;var os=b(jt),ns=b(os);x(os);var Vt=H(os),rs=b(Vt),is=b(rs,!0);x(rs),x(Vt);var as=H(Vt),ds=b(as);{var Cs=he=>{var Ae=$i(),ze=Pt(Ae);Je(ze);var je=H(ze,2);Je(je),Ge(()=>{$e(ze,"min",A(Ne).min),$e(ze,"max",A(Ne).max),$e(ze,"step",A(Ne).step),$e(je,"min",A(Ne).min),$e(je,"max",A(Ne).max),$e(je,"step",A(Ne).step)}),Xt(ze,()=>Oe[e.pDef.partName][A(Ne).name],Ke=>Oe[e.pDef.partName][A(Ne).name]=Ke),Xt(je,()=>Oe[e.pDef.partName][A(Ne).name],Ke=>Oe[e.pDef.partName][A(Ne).name]=Ke),De(he,Ae)},Ds=he=>{var Ae=Ci();gt(Ae,22,()=>["Off","On"],ze=>ze,(ze,je,Ke)=>{var Be=Ei(),ht=b(Be,!0);x(Be);var ft={};Ge(()=>{ve(ht,je),ft!==(ft=A(Ke))&&(Be.value=(Be.__value=A(Ke))??"")}),De(ze,Be)}),x(Ae),uo(Ae,()=>Oe[e.pDef.partName][A(Ne).name],ze=>Oe[e.pDef.partName][A(Ne).name]=ze),De(he,Ae)},Os=he=>{var Ae=Ii();gt(Ae,22,()=>A(Ne).dropdown,ze=>ze,(ze,je,Ke)=>{var Be=Oi(),ht=b(Be,!0);x(Be);var ft={};Ge(()=>{ve(ht,je),ft!==(ft=A(Ke))&&(Be.value=(Be.__value=A(Ke))??"")}),De(ze,Be)}),x(Ae),uo(Ae,()=>Oe[e.pDef.partName][A(Ne).name],ze=>Oe[e.pDef.partName][A(Ne).name]=ze),De(he,Ae)},bs=he=>{var Ae=ao("unknown");De(he,Ae)};ps(ds,he=>{A(Ne).pType===ws.eNumber?he(Cs):A(Ne).pType===ws.eCheckbox?he(Ds,1):A(Ne).pType===ws.eDropdown?he(Os,2):he(bs,!1)})}x(as);var yt=H(as);let Hs;var ls=b(yt,!0);x(yt);var Wt=H(yt);let cs;var Is=b(Wt,!0);x(Wt);var Nt=H(Wt),gs=b(Nt,!0);x(Nt);var us=H(Nt),zs=b(us,!0);x(us);var le=H(us);let ke;var Re=b(le,!0);x(le),x(jt),Ge(()=>{ss=tt(jt,1,"svelte-e6cp59",null,ss,{changed:Oe[e.pDef.partName][A(Ne).name]!==A(Ne).init}),ve(ns,`${A(pe)+1}.${A(ts)+1}`),ve(is,A(Ne).name),Hs=tt(yt,1,"svelte-e6cp59",null,Hs,{hideColumn:A(t)}),ve(ls,A(Ne).unit),cs=tt(Wt,1,"svelte-e6cp59",null,cs,{hideColumn:A(t)}),ve(Is,A(Ne).init),ve(gs,A(Ne).min),ve(zs,A(Ne).max),ke=tt(le,1,"svelte-e6cp59",null,ke,{hideColumn:A(t)}),ve(Re,A(Ne).step)}),oe("click",rs,()=>y(A(Ne).name)),De(kt,jt)}),x(zt),Ge(()=>{ve(Ut,A(pe)+1),$e(nt,"colspan",A(D)),ve(Qt,A(re).sectionName),$e(Mt,"colspan",A(Y)),xs=tt(zt,1,"svelte-e6cp59",null,xs,{collaps:A(L)[A(re).sectionID]})}),it(Ye,()=>A(L)[A(re).sectionID],kt=>A(L)[A(re).sectionID]=kt),De(ne,we)}),x(_e);var dt=H(_e,2),At=H(b(dt),2);Je(At),x(dt);var bt=H(dt,2),Ht=H(bt,2),pt=H(Ht,2),Le=H(pt,2);fs(Le,{okName:"Done",okFunc:q,sizeLarge:!0,get modalOpen(){return A(d)},set modalOpen(ne){ae(d,ne,!0)},children:(ne,re)=>{var pe=Ti(),we=H(Pt(pe),2),Te=b(we,!0);x(we),Ge(()=>ve(Te,A(f))),De(ne,pe)},$$slots:{default:!0}});var Jt=H(Le,2);fs(Jt,{okName:"Save into localStorage",okFunc:V,get modalOpen(){return A(u)},set modalOpen(ne){ae(u,ne,!0)},children:(ne,re)=>{Di(ne,{get pageName(){return e.pDef.partName},get storeName(){return A(_)},set storeName(pe){ae(_,pe,!0)}})},$$slots:{default:!0}}),x(ce);var xe=H(ce,2);Ko(xe,{get svgPath(){return A(c)},get modalOpen(){return A(S)},set modalOpen(ne){ae(S,ne,!0)}});var et=H(xe,2),mt=b(et);x(et);var Yt=H(et,2),Zt=b(Yt);_o(Zt,{get pFig(){return e.pFig},full:!0}),x(Yt);var Ps=H(Yt,2),Kt=b(Ps);_o(Kt,{get pFig(){return e.pFig},full:!1}),x(Ps),x(Q),Ge(()=>{Ms(Se,A(o)),Ee=tt(Se,1,"svelte-e6cp59",null,Ee,{colorWarn:A(a)}),Rt=tt(ut,1,"svelte-e6cp59",null,Rt,{hideColumn:A(t)}),Ot=tt(Gt,1,"svelte-e6cp59",null,Ot,{hideColumn:A(t)}),xt=tt(It,1,"svelte-e6cp59",null,xt,{hideColumn:A(t)}),$e(At,"size",A(E)),$e(mt,"src",A(c)),$e(mt,"alt",A(c))}),oe("change",U,I),oe("click",T,()=>{ae(i,!0)}),oe("click",K,()=>{ae(r,!0)}),oe("click",ge,O),oe("click",Ct,W),Xt(At,()=>A(g),ne=>ae(g,ne)),oe("click",bt,p),oe("click",Ht,M),oe("click",pt,()=>{ae(u,!0)}),oe("click",et,F),De(n,Q),ot()}Lt(["change","click"]);var Gi=Me('<nav class="svelte-p0ndb1"><button class="svelte-p0ndb1">0</button> <button class="svelte-p0ndb1">&lt-</button> <button class="svelte-p0ndb1">|&lt</button> <button class="svelte-p0ndb1">||</button> <button class="svelte-p0ndb1">&gt|</button> <button class="svelte-p0ndb1">-&gt</button> <input type="range" min="0" class="svelte-p0ndb1"/> <input type="number" min="0" class="svelte-p0ndb1"/></nav>');function Ji(n,e){st(e,!0);let g=at(e,"tMax",3,10),t=at(e,"tStep",3,.1),o=at(e,"tUpdate",3,500),a=at(e,"simTime",15,0),i=null,r=0,d;const u=4;function l(){i!==null&&(clearInterval(i),i=null)}function _(){d<0&&a()<=0?a(g()):d>0&&a()>=g()?a(0):a(a()+d)}function f(){const M=o()/2**(Math.abs(r)-1);d=r<0?-t():t(),i=setInterval(_,M)}function h(){l(),a(0),r=0}function c(){l(),r=0,d=-t(),_()}function S(){l(),r=0,d=t(),_()}function L(){l(),r=Math.max(r-1,-u),f()}function w(){l(),r=Math.min(r+1,u),f()}function v(){l(),r=0}On(()=>{l()});var P=Gi(),$=b(P),z=H($,2),I=H(z,2),p=H(I,2),R=H(p,2),k=H(R,2),V=H(k,2);Je(V);var C=H(V,2);Je(C),x(P),Ge(()=>{$e(V,"max",g()),$e(V,"step",t()),$e(C,"max",g()),$e(C,"step",t())}),oe("click",$,h),oe("click",z,L),oe("click",I,c),oe("click",p,v),oe("click",R,S),oe("click",k,w),Xt(V,a),Xt(C,a),De(n,P),ot()}Lt(["click"]);var Ui=Me('<nav class="svelte-1iutb4n"><button aria-labelledby="zoomInit" class="svelte-1iutb4n"><div class="zero svelte-1iutb4n"></div></button><button aria-labelledby="zoomIn" class="svelte-1iutb4n"><div class="zoomin svelte-1iutb4n"></div></button><button aria-labelledby="zoomOut" class="svelte-1iutb4n"><div class="zoomout svelte-1iutb4n"></div></button><button aria-labelledby="moveLeft" class="svelte-1iutb4n"><div class="arrowleft svelte-1iutb4n"></div></button><button aria-labelledby="moveRight" class="svelte-1iutb4n"><div class="arrowright svelte-1iutb4n"></div></button><button aria-labelledby="moveUp" class="svelte-1iutb4n"><div class="arrowup svelte-1iutb4n"></div></button><button aria-labelledby="moveDown" class="svelte-1iutb4n"><div class="arrowdown svelte-1iutb4n"></div></button></nav>');function ji(n,e){st(e,!0);var g=Ui(),t=b(g),o=H(t),a=H(o),i=H(a),r=H(i),d=H(r),u=H(d);x(g),oe("click",t,()=>e.zoomClick("zoomInit")),oe("click",o,()=>e.zoomClick("zoomIn")),oe("click",a,()=>e.zoomClick("zoomOut")),oe("click",i,()=>e.zoomClick("moveLeft")),oe("click",r,()=>e.zoomClick("moveRight")),oe("click",d,()=>e.zoomClick("moveUp")),oe("click",u,()=>e.zoomClick("moveDown")),De(n,g),ot()}Lt(["click"]);var ye=Fn(()=>fe),Wi=Me('<div class="svelte-1u36vsa"><label class="svelte-1u36vsa"><input type="checkbox" class="svelte-1u36vsa"/>main part</label> <label class="svelte-1u36vsa"><input type="checkbox" class="svelte-1u36vsa"/>main skeleton</label> <label class="svelte-1u36vsa"><input type="checkbox" class="svelte-1u36vsa"/>second parts</label> <label class="svelte-1u36vsa"><input type="checkbox" class="svelte-1u36vsa"/>second skeletons</label> <label class="svelte-1u36vsa"><input type="checkbox" class="svelte-1u36vsa"/>dynamics</label> <label class="svelte-1u36vsa"><input type="checkbox" class="svelte-1u36vsa"/>ruler</label> <label class="svelte-1u36vsa"><input type="checkbox" class="svelte-1u36vsa"/>frame of reference</label> <label class="svelte-1u36vsa"><input type="checkbox" class="svelte-1u36vsa"/>points</label> <label class="svelte-1u36vsa"><input type="checkbox" class="svelte-1u36vsa"/>lines</label> <label class="svelte-1u36vsa"><input type="checkbox" class="svelte-1u36vsa"/>vectors</label></div>');function qi(n,e){st(e,!1),zn();var g=Wi(),t=b(g),o=b(t);Je(o),rt(),x(t);var a=H(t,2),i=b(a);Je(i),rt(),x(a);var r=H(a,2),d=b(r);Je(d),rt(),x(r);var u=H(r,2),l=b(u);Je(l),rt(),x(u);var _=H(u,2),f=b(_);Je(f),rt(),x(_);var h=H(_,2),c=b(h);Je(c),rt(),x(h);var S=H(h,2),L=b(S);Je(L),rt(),x(S);var w=H(S,2),v=b(w);Je(v),rt(),x(w);var P=H(w,2),$=b(P);Je($),rt(),x(P);var z=H(P,2),I=b(z);Je(I),rt(),x(z),x(g),it(o,()=>ye().dLayers.main,p=>ye(ye().dLayers.main=p)),it(i,()=>ye().dLayers.mainB,p=>ye(ye().dLayers.mainB=p)),it(d,()=>ye().dLayers.second,p=>ye(ye().dLayers.second=p)),it(l,()=>ye().dLayers.secondB,p=>ye(ye().dLayers.secondB=p)),it(f,()=>ye().dLayers.dynamics,p=>ye(ye().dLayers.dynamics=p)),it(c,()=>ye().dLayers.ruler,p=>ye(ye().dLayers.ruler=p)),it(L,()=>ye().dLayers.refframe,p=>ye(ye().dLayers.refframe=p)),it(v,()=>ye().dLayers.points,p=>ye(ye().dLayers.points=p)),it($,()=>ye().dLayers.lines,p=>ye(ye().dLayers.lines=p)),it(I,()=>ye().dLayers.vectors,p=>ye(ye().dLayers.vectors=p)),De(n,g),ot()}var Xi=Me('<section class="svelte-n9qac9"><!> <div class="rack svelte-n9qac9"><canvas class="full svelte-n9qac9"></canvas> <!></div> <div class="rack svelte-n9qac9"><canvas class="zoom svelte-n9qac9"></canvas> <!></div></section>');function Yi(n,e){st(e,!0);let g=at(e,"simTime",15,0);const t=400,o=1200;let a=Ce(t),i,r,d;function u(O,W){if(i){const D=i.getContext("2d");D.clearRect(0,0,D.canvas.width,D.canvas.height);try{d=O.getAdjustFull(D.canvas.width,D.canvas.height),O.draw(D,d,W)}catch(Y){console.log(Y)}}}function l(O,W,D){if(r){const Y=r.getContext("2d");Y.clearRect(0,0,Y.canvas.width,Y.canvas.height);try{(W===void 0||W.init===0)&&(W=O.getAdjustZoom(Y.canvas.width,Y.canvas.height)),O.draw(Y,W,D)}catch(E){console.log(E)}}}function _(){const O=i.getContext("2d"),W=r.getContext("2d"),D=Math.min(Math.max(.4*A(a),t),o);O.canvas.width=D,O.canvas.height=D,W.canvas.width=D,W.canvas.height=D,fe.canvasZWidth=D,fe.zAdjust.init===0&&(fe.zAdjust=e.pFig.getAdjustZoom(W.canvas.width,W.canvas.height))}function f(){_(),u(e.pFig,fe.dLayers),l(e.pFig,fe.zAdjust,fe.dLayers)}function h(O,W,D){u(O,D),l(O,W,D)}In(()=>{_()}),eo(()=>{h(e.pFig,fe.zAdjust,fe.dLayers)});function c(O){const W=r.getContext("2d");switch(O){case"zoomInit":fe.zAdjust=e.pFig.getAdjustZoom(W.canvas.width,W.canvas.height);break;case"zoomIn":fe.zAdjust=Rs(.7,fe.zAdjust);break;case"zoomOut":fe.zAdjust=Rs(1.3,fe.zAdjust);break;case"moveLeft":fe.zAdjust.xMin+=-.2*fe.zAdjust.xyDiff;break;case"moveRight":fe.zAdjust.xMin+=.2*fe.zAdjust.xyDiff;break;case"moveUp":fe.zAdjust.yMin+=.2*fe.zAdjust.xyDiff;break;case"moveDown":fe.zAdjust.yMin+=-.2*fe.zAdjust.xyDiff;break;default:console.log(`ERR423: ${O} has no case!`)}l(e.pFig,fe.zAdjust,fe.dLayers)}const S=3e3,L=10,w=3;let v={timestamp:0,offsetX:0,offsetY:0};function P(O){O.button===0&&(v.timestamp=Date.now(),v.offsetX=O.offsetX,v.offsetY=O.offsetY)}function $(O){if(O.button===0)if(Date.now()-v.timestamp<S){const W=Math.abs(v.offsetX-O.offsetX),D=Math.abs(v.offsetY-O.offsetY);if(W<L&&D<L){const[Y,E]=Tt(O.offsetX,O.offsetY,d);fe.zAdjust=un(Y,E,fe.zAdjust),h(e.pFig,fe.zAdjust,fe.dLayers)}if(W>L&&D>L){const Y=W/D,E=1/Y;if(Y<w&&E<w){const[Q,ce]=Tt(O.offsetX,O.offsetY,d),[U,T]=Tt(v.offsetX,v.offsetY,d),ee=r.getContext("2d").canvas.width;fe.zAdjust=hn(Q,ce,U,T,ee,ee),h(e.pFig,fe.zAdjust,fe.dLayers)}}}else console.log(`Warn205: ignore ${O.offsetX} ${O.offsetY} because too slow`)}function z(O){if(i){const W=i.getContext("2d");if(O.buttons===1){const D=O.offsetX-v.offsetX,Y=O.offsetY-v.offsetY;u(e.pFig,fe.dLayers),W.beginPath(),W.rect(v.offsetX,v.offsetY,D,Y),W.strokeStyle=Fs.mouse,W.stroke()}if(fe.dLayers.ruler){const[D,Y]=Tt(O.offsetX,O.offsetY,d);W.clearRect(5,5,200,25),W.font="15px Arial",W.fillStyle=Fs.ruler,W.fillText(`x: ${D.toFixed(4)} y: ${Y.toFixed(4)}`,5,20)}}}let I,p,R;function k(O){if(O.button===0){const[W,D]=Tt(O.offsetX,O.offsetY,fe.zAdjust);I=W,p=D,R=fn(fe.zAdjust)}}function V(O){if(O.buttons===1){const[W,D]=Tt(O.offsetX,O.offsetY,R);fe.zAdjust=_n(I,p,W,D,R),l(e.pFig,fe.zAdjust,fe.dLayers)}else if(fe.dLayers.ruler&&r){const W=r.getContext("2d"),[D,Y]=Tt(O.offsetX,O.offsetY,fe.zAdjust);W.clearRect(5,5,200,25),W.font="15px Arial",W.fillStyle=Fs.ruler,W.fillText(`x: ${D.toFixed(4)} y: ${Y.toFixed(4)}`,5,20)}}function C(O){O.preventDefault(),O.deltaY>0?fe.zAdjust=Rs(.7,fe.zAdjust):fe.zAdjust=Rs(1.3,fe.zAdjust),l(e.pFig,fe.zAdjust,fe.dLayers)}var M=Xi();lo("resize",yn,f);var q=b(M);qi(q,{});var X=H(q,2),y=b(X);$e(y,"width",t),$e(y,"height",t),ys(y,O=>i=O,()=>i);var F=H(y,2);Ji(F,{get tMax(){return e.pDefSim.tMax},get tStep(){return e.pDefSim.tStep},get tUpdate(){return e.pDefSim.tUpdate},get simTime(){return g()},set simTime(O){g(O)}}),x(X);var j=H(X,2),Z=b(j);$e(Z,"width",t),$e(Z,"height",t),ys(Z,O=>r=O,()=>r);var G=H(Z,2);ji(G,{zoomClick:c}),x(j),x(M),Tn("innerWidth",O=>ae(a,O,!0)),oe("mousedown",y,P),oe("mouseup",y,$),oe("mousemove",y,z),oe("mousedown",Z,k),oe("mousemove",Z,V),lo("wheel",Z,C),De(n,M),ot()}Lt(["mousedown","mouseup","mousemove"]);var Zi=Me("<tr><td> </td><td> </td><td> </td><td><i> </i></td><td><i> </i></td></tr>"),Ki=Me('<li class="svelte-xyzrxn"><input type="checkbox" class="toggle svelte-xyzrxn"/> <label class="label svelte-xyzrxn"><div class="arrow svelte-xyzrxn"></div> </label> <button class="svelte-xyzrxn"> </button> <button class="svelte-xyzrxn">Export parameters</button> <div class="nested svelte-xyzrxn"><article class="svelte-xyzrxn"> <strong> </strong> </article> <table class="svelte-xyzrxn"><thead class="svelte-xyzrxn"><tr><td>Num</td><td>Name</td><td>Value</td><td>Init</td><td>Set?</td></tr></thead><tbody class="svelte-xyzrxn"></tbody></table></div></li>'),Qi=Me('<section class="svelte-xyzrxn"><h2 class="svelte-xyzrxn">Sub-designs <span class="svelte-xyzrxn"> </span></h2> <ol class="svelte-xyzrxn"></ol></section>');function ea(n,e){st(e,!0);const g=Qe(()=>Object.keys(e.subD));async function t(h){const c=e.subD[h];Zo(c.partName,ro(c.dparam),!0);const S=$n(`/${e.pLink[c.partName]}`);Cn(S)}function o(h){const c=e.subD[h].partName,S=e.subD[h].dparam,L=`sub-design parameters of ${c} from ${e.origPartName}`;to(c,ro(S),L)}function a(h){let c="[ ";return c+=`${m(Ie(h[0]))}, `,c+=`${m(Ie(h[1]))}, `,c+=`${m(Ie(h[2]))} ]`,c}function i(h){let c="[ ";return c+=`${m(h[0])}, `,c+=`${m(h[1])}, `,c+=`${m(h[2])} ]`,c}function r(h){return h?"Yes":""}var d=Qi(),u=b(d),l=H(b(u)),_=b(l);x(l),x(u);var f=H(u,2);gt(f,20,()=>A(g),h=>h,(h,c)=>{var S=Ki(),L=b(S);Je(L),Nn(L,!1);var w=H(L,2),v=H(b(w));x(w);var P=H(w,2),$=b(P);x(P);var z=H(P,2),I=H(z,2),p=b(I),R=b(p),k=H(R),V=b(k,!0);x(k);var C=H(k);x(p);var M=H(p,2),q=H(b(M));gt(q,22,()=>Object.keys(e.subD[c].dparam),X=>X,(X,y,F)=>{var j=Zi();let Z;var G=b(j),O=b(G,!0);x(G);var W=H(G),D=b(W,!0);x(W);var Y=H(W),E=b(Y,!0);x(Y);var Q=H(Y),ce=b(Q),U=b(ce,!0);x(ce),x(Q);var T=H(Q),K=b(T),ee=b(K,!0);x(K),x(T),x(j),Ge(me=>{Z=tt(j,1,"svelte-xyzrxn",null,Z,{changed:e.subD[c].dparam[y].chg}),ve(O,A(F)+1),ve(D,y),ve(E,e.subD[c].dparam[y].val),ve(U,e.subD[c].dparam[y].init),ve(ee,me)},[()=>r(e.subD[c].dparam[y].chg)]),De(X,j)}),x(q),x(M),x(I),x(S),Ge((X,y,F)=>{$e(L,"id",`cb_${c??""}`),$e(w,"for",`cb_${c??""}`),ve(v,` ${c??""}`),ve($,`Go to ${e.pLink[e.subD[c].partName]??""}`),ve(R,`${X??""} parameters of `),ve(V,e.subD[c].partName),ve(C,` with orientation ${y??""} (degree) at position
						${F??""} (mm)`)},[()=>Object.keys(e.subD[c].dparam).length,()=>a(e.subD[c].orientation),()=>i(e.subD[c].position)]),oe("click",P,()=>t(c)),oe("click",z,()=>o(c)),De(h,S)}),x(f),x(d),Ge(()=>ve(_,`(Number of sub-instances: ${A(g).length??""})`)),De(n,d),ot()}Lt(["click"]);var ta=Me("<button> </button>"),sa=Me('<tr class="svelte-zsilp8"><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">2d- svg</td><td class="svelte-zsilp8"><button class="svelte-zsilp8">preview</button></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr>'),oa=Me('<tr class="svelte-zsilp8"><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">2d- dxf</td><td class="svelte-zsilp8"><button class="svelte-zsilp8">preview</button></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr>'),na=Me('<!> <section class="svelte-zsilp8"><h2 class="svelte-zsilp8">Log</h2> <textarea rows="5" cols="94" readonly="" wrap="soft"></textarea></section> <section class="svelte-zsilp8"><h2 class="svelte-zsilp8">2D Drawings : <!> <button>All faces merged</button></h2></section> <!> <section class="svelte-zsilp8"><h2 class="svelte-zsilp8">Export</h2> <table class="svelte-zsilp8"><caption class="svelte-zsilp8">Output files</caption><thead class="svelte-zsilp8"><tr class="svelte-zsilp8"><th class="svelte-zsilp8">#</th><th class="svelte-zsilp8">Filename</th><th class="svelte-zsilp8">Type</th><th class="svelte-zsilp8">Preview</th><th class="svelte-zsilp8">Download</th></tr></thead><tbody class="svelte-zsilp8"><tr class="svelte-zsilp8"><td class="svelte-zsilp8">1</td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">0-params- pxJson</td><td class="svelte-zsilp8"><button class="svelte-zsilp8">preview</button></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr><tr class="svelte-zsilp8"><td class="svelte-zsilp8">2</td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">1-log- txtLog</td><td class="svelte-zsilp8"><button class="svelte-zsilp8">preview</button></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr><!><tr class="svelte-zsilp8"><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">2d- svg</td><td class="svelte-zsilp8"><button class="svelte-zsilp8">preview</button></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr><!><tr class="svelte-zsilp8"><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">2d- dxf</td><td class="svelte-zsilp8"><button class="svelte-zsilp8">preview</button></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr><tr class="svelte-zsilp8"><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">4-pax- paxJson</td><td class="svelte-zsilp8"><button class="svelte-zsilp8">preview</button></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr><tr class="svelte-zsilp8"><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">5-script- scad</td><td class="svelte-zsilp8"><button class="svelte-zsilp8">preview</button></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr><tr class="svelte-zsilp8"><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">5-script- jsCad</td><td class="svelte-zsilp8"><button class="svelte-zsilp8">preview</button></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr><tr class="svelte-zsilp8"><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">5-script- pyFreecad</td><td class="svelte-zsilp8"><button class="svelte-zsilp8">preview</button></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr><tr class="svelte-zsilp8"><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8"> </td><td class="svelte-zsilp8">6-zip- zip</td><td class="svelte-zsilp8"></td><td class="svelte-zsilp8"><button class="svelte-zsilp8">download</button></td></tr></tbody></table> <dialog id="dBview" class="svelte-zsilp8"><textarea readonly="" wrap="soft" class="svelte-zsilp8"></textarea> <button class="bback svelte-zsilp8">close - back - escape</button></dialog> <!></section>',1);function Ca(n,e){st(e,!0);const g="ParametrixAll";function t(le){let ke=!0;const Re=/warn/i;return le.search(Re)<0&&(ke=!1),ke}function o(le,ke){let Re=ke;if(le.length===0)console.log("warn404: Drawing has an empty face list");else{const he=le.slice();he.push(g),he.includes(Re)||(Re=le[0])}return Re}function a(le,ke){let Re;const he=Object.keys(le),Ae=o(he,ke);return he.includes(Ae)?Re=le[Ae]:Re=vn(le),Re}let i=Ce(0),r=Ce(g);vo(()=>{ae(r,o(Object.keys(e.fgeom(0,Oe[e.pDef.partName]).fig),""),!0)});let d=Qe(()=>e.fgeom(A(i),Oe[e.pDef.partName])),u=Qe(()=>{const le=new Date().toLocaleTimeString();let ke=`Geometry ${e.pDef.partName} computed at ${le}
`;return ke+=A(d).logstr,ke}),l=Qe(()=>Object.keys(A(d).fig)),_=Qe(()=>A(d).calcErr),f=Qe(()=>t(A(d).logstr)),h=Qe(()=>a(A(d).fig,A(r))),c=Qe(()=>A(d).sub);function S(le,ke){const Re=document.createElement("a"),he=URL.createObjectURL(ke);Re.setAttribute("href",he),Re.setAttribute("download",le),Re.click(),Re.remove(),URL.revokeObjectURL(he)}function L(le,ke,Re){const he=document.createElement("a"),Ae="data:"+Re+";utf-8,"+encodeURIComponent(ke);he.setAttribute("href",Ae),he.setAttribute("download",le),he.click(),he.remove()}function w(){const le=/[-:]/g,ke=/\..*$/;return new Date().toISOString().replace(le,"").replace(ke,"").replace("T","_")}async function v(le){const ke=/^svg_/,Re=/^dxf_/;let he=Ue.eSVG,Ae="all";le.match(ke)?(he=Ue.eSVG,Ae=le.replace(ke,"")):le.match(Re)?(he=Ue.eDXF,Ae=le.replace(Re,"")):le==="allsvg"?he=Ue.eSVGALL:le==="alldxf"?he=Ue.eDXFALL:le==="compute_log"?he=Ue.eTXTLOG:le==="pax"?he=Ue.ePAX:le==="oscad"?he=Ue.eOPENSCAD:le==="ojscad"?he=Ue.eJSCAD:le==="freecad"?he=Ue.eFREECAD:le==="zip"?he=Ue.eZIP:console.log(`err883: downloadExport iExportFace ${le} invalid`);const ze=Ln(he),je=Pn(he),Ke=pn(he),Be=e.pDef.partName+"_"+Ae+"_"+w()+ze;if(Ke){const ht=await Sn(e.fgeom,A(i),Oe[e.pDef.partName],e.pDef,he);S(Be,ht)}else{const ht=io(e.fgeom,Oe[e.pDef.partName],e.pDef,Ae,he);L(Be,ht,je)}}async function P(){to(e.pDef.partName,Oe[e.pDef.partName],"")}let $,z=Ce("");function I(le){ae(z,le,!0),$.showModal()}function p(le,ke){I(io(e.fgeom,Oe[e.pDef.partName],e.pDef,le,ke))}function R(){$.close()}var k=na(),V=Pt(k);Bi(V,{get pDef(){return e.pDef},get pFig(){return A(h)}});var C=H(V,2),M=H(b(C),2);Js(M);let q;x(C);var X=H(C,2),y=b(X),F=H(b(y));gt(F,16,()=>A(l),le=>le,(le,ke)=>{var Re=ta(),he=b(Re,!0);x(Re),Ge(()=>{tt(Re,1,co({theFace:A(r)===ke}),"svelte-zsilp8"),ve(he,ke)}),oe("click",Re,()=>{ae(r,ke,!0)}),De(le,Re)});var j=H(F,2);x(y),x(X);var Z=H(X,2);Yi(Z,{get pDefSim(){return e.pDef.sim},get pFig(){return A(h)},get simTime(){return A(i)},set simTime(le){ae(i,le,!0)}});var G=H(Z,2),O=H(b(G),2),W=H(b(O),2),D=b(W),Y=H(b(D)),E=b(Y);x(Y);var Q=H(Y,2),ce=b(Q);x(Q);var U=H(Q),T=b(U);x(U),x(D);var K=H(D),ee=H(b(K)),me=b(ee);x(ee);var Se=H(ee,2),Ee=b(Se);x(Se);var _e=H(Se),de=b(_e);x(_e),x(K);var Fe=H(K);gt(Fe,18,()=>A(l),le=>le,(le,ke,Re)=>{var he=sa(),Ae=b(he),ze=b(Ae,!0);x(Ae);var je=H(Ae),Ke=b(je);x(je);var Be=H(je,2),ht=b(Be);x(Be);var ft=H(Be),Vs=b(ft);x(ft),x(he),Ge(()=>{ve(ze,3+A(Re)),ve(Ke,`${e.pDef.partName??""}_${ke??""}.svg`)}),oe("click",ht,()=>{p(ke,Ue.eSVG)}),oe("click",Vs,async()=>{await v(`svg_${ke}`)}),De(le,he)});var qe=H(Fe),Ze=b(qe),ge=b(Ze,!0);x(Ze);var Ct=H(Ze),ut=b(Ct);x(Ct);var Rt=H(Ct,2),Gt=b(Rt);x(Rt);var Ot=H(Rt),It=b(Ot);x(Ot),x(qe);var xt=H(qe);gt(xt,18,()=>A(l),le=>le,(le,ke,Re)=>{var he=oa(),Ae=b(he),ze=b(Ae,!0);x(Ae);var je=H(Ae),Ke=b(je);x(je);var Be=H(je,2),ht=b(Be);x(Be);var ft=H(Be),Vs=b(ft);x(ft),x(he),Ge(()=>{ve(ze,4+A(l).length+A(Re)),ve(Ke,`${e.pDef.partName??""}_${ke??""}.dxf`)}),oe("click",ht,()=>{p(ke,Ue.eDXF)}),oe("click",Vs,async()=>{await v(`dxf_${ke}`)}),De(le,he)});var Dt=H(xt),dt=b(Dt),At=b(dt,!0);x(dt);var bt=H(dt),Ht=b(bt);x(bt);var pt=H(bt,2),Le=b(pt);x(pt);var Jt=H(pt),xe=b(Jt);x(Jt),x(Dt);var et=H(Dt),mt=b(et),Yt=b(mt,!0);x(mt);var Zt=H(mt),Ps=b(Zt);x(Zt);var Kt=H(Zt,2),ne=b(Kt);x(Kt);var re=H(Kt),pe=b(re);x(re),x(et);var we=H(et),Te=b(we),Xe=b(Te,!0);x(Te);var lt=H(Te),Ut=b(lt);x(lt);var nt=H(lt,2),Qt=b(nt);x(nt);var Mt=H(nt),es=b(Mt);x(Mt),x(we);var Ye=H(we),zt=b(Ye),xs=b(zt,!0);x(zt);var kt=H(zt),Ne=b(kt);x(kt);var ts=H(kt,2),jt=b(ts);x(ts);var ss=H(ts),os=b(ss);x(ss),x(Ye);var ns=H(Ye),Vt=b(ns),rs=b(Vt,!0);x(Vt);var is=H(Vt),as=b(is);x(is);var ds=H(is,2),Cs=b(ds);x(ds);var Ds=H(ds),Os=b(Ds);x(Ds),x(ns);var bs=H(ns),yt=b(bs),Hs=b(yt,!0);x(yt);var ls=H(yt),Wt=b(ls);x(ls);var cs=H(ls,3),Is=b(cs);x(cs),x(bs),x(W),x(O);var Nt=H(O,2),gs=b(Nt);Js(gs);var us=H(gs,2);x(Nt),ys(Nt,le=>$=le,()=>$);var zs=H(Nt,2);ea(zs,{get subD(){return A(c)},get origPartName(){return e.pDef.partName},get pLink(){return e.pLink}}),x(G),Ge(()=>{Ms(M,A(u)),q=tt(M,1,"svelte-zsilp8",null,q,{colorErr:A(_),colorWarn:A(f)}),tt(j,1,co({theFace:A(r)===g}),"svelte-zsilp8"),ve(E,`px_${e.pDef.partName??""}.json`),ve(me,`${e.pDef.partName??""}_all.log`),ve(ge,3+A(l).length),ve(ut,`${e.pDef.partName??""}_all.svg`),ve(At,4+2*A(l).length),ve(Ht,`${e.pDef.partName??""}_all.dxf`),ve(Yt,5+2*A(l).length),ve(Ps,`${e.pDef.partName??""}_all.pax.json`),ve(Xe,6+2*A(l).length),ve(Ut,`${e.pDef.partName??""}_all_noarc_openscad.scad`),ve(xs,7+2*A(l).length),ve(Ne,`${e.pDef.partName??""}_all_noarc_jscad.js`),ve(rs,8+2*A(l).length),ve(as,`${e.pDef.partName??""}_all_freecad.py`),ve(Hs,9+2*A(l).length),ve(Wt,`${e.pDef.partName??""}_all.zip`),Ms(gs,A(z))}),oe("click",j,()=>{ae(r,g)}),oe("click",ce,()=>{I(wi(e.pDef.partName,Oe[e.pDef.partName],""))}),oe("click",T,P),oe("click",Ee,()=>{p("all",Ue.eTXTLOG)}),oe("click",de,async()=>{await v("compute_log")}),oe("click",Gt,()=>{p("all",Ue.eSVGALL)}),oe("click",It,async()=>{await v("allsvg")}),oe("click",Le,()=>{p("all",Ue.eDXFALL)}),oe("click",xe,async()=>{await v("alldxf")}),oe("click",ne,()=>{p("all",Ue.ePAX)}),oe("click",pe,async()=>{await v("pax")}),oe("click",Qt,()=>{p("all",Ue.eOPENSCAD)}),oe("click",es,async()=>{await v("oscad")}),oe("click",jt,()=>{p("all",Ue.eJSCAD)}),oe("click",os,async()=>{await v("ojscad")}),oe("click",Cs,()=>{p("all",Ue.eFREECAD)}),oe("click",Os,async()=>{await v("freecad")}),oe("click",Is,async()=>{await v("zip")}),oe("click",us,R),De(n,k),ot()}Lt(["click"]);function Es(n){const e=/^.*\//g;let g=n.replace(e,"");return g===""&&(g="index"),g}function ra(n){const e=[];for(const g of n){const t={category:g.category,pages:[]};for(const o of g.pages){const a={path:o.path,page:o.page,svg:o.svg,label:Es(o.path)};t.pages.push(a)}e.push(t)}return e}function ia(n){const e={};for(const g of n)for(const t of g.pages)if(t.page!=null){const o=Es(t.path);e[o]=t.page}return e}function aa(n){const e={};for(const g of n)for(const t of g.pages)if(t.page!=null){const o=Es(t.path);e[o]=t.path}return e}function da(n){const e=/\/$/;return n.replace(e,"")}function la(n){let e=n;return(e==="/index"||e==="/index.html")&&(e="/"),e}function ca(n){let e=n;return e===""&&(e="/"),e}function ga(n){let e=n;return e=da(e),e=ca(e),e=la(e),e}const en={path:"",page:null,svg:"page_index.svg",label:"index"},ua={path:"/about",page:null,svg:"page_about.svg",label:"about"},ha={category:"",pages:[en,ua]};function fa(n,e){const g=ga(e);let t=0;e:for(const[a,i]of n.entries())for(const r of i.pages)if(g===r.path){t=a;break e}let o=ha;if(t>0&&t<n.length-1){const a=n[t];o={category:a.category,pages:[]},o.pages.push(en);for(const i of a.pages){const r={path:i.path,page:i.page,svg:i.svg,label:Es(i.path)};o.pages.push(r)}}return o}function Oa(n){return fa($s,n)}const Ia=ra($s),_a=ia($s),za=aa($s);gi(_a);export{Ea as D,Ca as P,ci as a,za as b,ga as c,_a as d,$a as i,Oa as l,Ia as m};

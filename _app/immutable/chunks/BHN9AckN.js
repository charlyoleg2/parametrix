import{p as o,a as oe,b as ct,d as At,f as be,g as xe,h as G,j as p,k as B,E as pe,l as se,m as $,r as Ce,n as ft,o as vt,q as St,s as en,t as ae,u as ts,w as Oe,x as tn,y as ge,z as Ct,A as zo,B as on,C as sn,D as nn,F as os,G as Je,H as bo,I as wo,J as Fo,S as eo,K as rn,e as lt,L as an,M as dn,N as cn,O as ln,P as Zo,Q as Ro,R as ss,T as Ao,U as Gt,V as gn,W as hn,X as un,Y as _n,Z as Bo,_ as ns,$ as ze,a0 as fn,a1 as rs,a2 as vn,a3 as Sn,a4 as Ln,a5 as xn}from"./dtMORap4.js";import"./DsnmJJEf.js";import{W as Pn,a0 as Dn,aY as Hn,aZ as kn,ag as mn,am as de,K as A,au as pn,an as Wt,p as Ke,aj as Lo,a as dt,b as De,c as Qe,f as Re,d as k,r as H,t as je,s as m,ak as $e,al as qe,n as st,F as Ko,a_ as fo,a$ as Mo,aO as as,aD as bn}from"./DDEMFpgR.js";import{l as wn,b as Rn,w as An,d as Lt,s as _e,r as Go,e as is}from"./BRgS8L5A.js";import{s as Ne,r as Be,a as yo,b as Mn}from"./BjLAz-Yc.js";import{i as Ut}from"./D8pUSFuR.js";import{p as rt}from"./CNFyQYs2.js";import{b as No}from"./Cwx_AFnf.js";import{s as Ze,c as ds}from"./CmkgGMsS.js";import{b as $o}from"./DUuSZ-Xf.js";import{a as nt,b as to}from"./DlhdsPri.js";import{s as yn}from"./D3sJ-qen.js";import{p as cs}from"./C4bb5HuL.js";import{a as _s,g as Nn}from"./DyenI_Ai.js";import{a as $n,o as En}from"./Bz0lglAr.js";import"./KVwREm06.js";import{i as Cn}from"./DXJ4dJjp.js";function fs(s,e,d=!1){if(s.multiple){if(e==null)return;if(!Dn(e))return Hn();for(var t of s.options)t.selected=e.includes(So(t));return}for(t of s.options){var n=So(t);if(kn(n,e)){t.selected=!0;return}}(!d||e!==void 0)&&(s.selectedIndex=-1)}function On(s){var e=new MutationObserver(()=>{fs(s,s.__value)});e.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),mn(()=>{e.disconnect()})}function ls(s,e,d=e){var t=!0;wn(s,"change",n=>{var i=n?"[selected]":":checked",a;if(s.multiple)a=[].map.call(s.querySelectorAll(i),So);else{var r=s.querySelector(i)??s.querySelector("option:not([disabled])");a=r&&So(r)}d(a)}),Pn(()=>{var n=e();if(fs(s,n,t),t&&n===void 0){var i=s.querySelector(":checked");i!==null&&(n=So(i),d(n))}s.__value=n,t=!1}),On(s)}function So(s){return"__value"in s?s.__value:s.value}function In(s,e){Rn(window,["resize"],()=>An(()=>e(window[s])))}function Vn(s){var e=pn(0);return function(){return arguments.length===1?(de(e,A(e)+1),arguments[0]):(A(e),s())}}var Tn=class{base_center_x;base_center_y;base_radius;initial_angle;right_nleft;constructor(s,e,d,t,n){this.base_center_x=s,this.base_center_y=e,this.base_radius=d,this.initial_angle=t,this.right_nleft=n}angleSign(){return this.right_nleft?1:-1}lFromU(s){return this.base_radius*Math.sqrt(1+s**2)}wFromU(s){if(s<0)throw`err729: involute parameter au ${s} is negative`;if(Math.abs(s)>Math.PI/2)throw`err730: involute parameter au ${s} is larger than PI/2`;return this.angleSign()*(s-Math.atan(s))}w2FromU(s){return this.initial_angle+this.wFromU(s)}ptc(s){const e=this.lFromU(s),d=this.w2FromU(s),t=this.base_center_x+Math.cos(d)*e,n=this.base_center_y+Math.sin(d)*e;return[t,n]}ptcta(s){return this.initial_angle+this.angleSign()*s}uFromL(s){return Math.sqrt(s**2/this.base_radius**2-1)}uFromWslow(s){let d=Math.PI/3,t=d/2,n=this.wFromU(d),i=0;for(;Math.abs(n-s)>1e-4;)n<s?d+=t:d-=t,n=this.wFromU(d),t=t/2,i+=1;return console.log(`dbg072: uFromWslow itcnt ${i}`),d}laptc(s,e,d,t){if(Math.sign(e)*this.angleSign()<0)throw`err904: Invole.laptc angle-of-pressure ${e} not compatible with right_nleft ${this.right_nleft}`;const n=s+e,i=this.base_center_x+Math.cos(n)*this.base_radius,a=this.base_center_y+Math.sin(n)*this.base_radius,r=n-this.angleSign()*Math.PI/2,c=d*this.base_radius,h=i+Math.cos(r)*c,l=a+Math.sin(r)*c,_=this.lFromU(d)*t,u=d,g=Math.cos(u)*_,S=Math.sin(u)*_;return[h,l,g,S]}};function Ot(s,e,d,t,n){return new Tn(s,e,d,t,n)}var jn=class{mod=1;TN=23;as=1;cx=0;cy=0;brr=50;blr=50;ar=54;pr=53;dr=52;br=51;bRound=1;adt=.5;initAngle=0;axisAngle=0;involArcPairs=1;skinThickness=0;involuteR=Ot(0,0,50,0,!0);involuteL=Ot(0,0,50,0,!1);rud=0;rup=0;rua=0;rwd=0;rwp=0;rwa=0;lud=0;lup=0;lua=0;lwd=0;lwp=0;lwa=0;msg;initStep=0;constructor(){this.mod=1,this.msg="",this.initStep=0}incInitStep(s){if(this.initStep+1!==s)throw`err834: incInitStep initStep ${this.initStep} and target ${s} are not compatible`;this.initStep=s}checkInitStep(s,e){if(this.initStep<s)throw`err835: checkInitStep for ${e} initStep ${this.initStep} is too small compare to targetMin ${s}`}set1ModuleToothNumber(s,e){this.incInitStep(1),this.mod=s,this.TN=e,this.pr=this.mod*this.TN/2,this.as=2*Math.PI/this.TN}set2CenterPosition(s,e){this.incInitStep(2),this.cx=s,this.cy=e}set3CircleRadius(s,e,d,t){this.incInitStep(3),this.ar=this.pr+this.mod*s,this.dr=this.pr-this.mod*e,this.br=this.dr-this.mod*d,this.bRound=t}set4BaseCircles(s,e){this.incInitStep(4),this.brr=s,this.blr=e}set5AddendumThickness(s){this.incInitStep(5),this.adt=s/100}set6Angles(s,e){this.incInitStep(6),this.initAngle=s,this.axisAngle=e}set7InvoluteDetails(s,e){this.incInitStep(7),this.involArcPairs=s,this.skinThickness=e}getRefCircles(){return this.checkInitStep(4,"getRefCircles"),[$(this.cx,this.cy,this.ar,"Azure"),$(this.cx,this.cy,this.pr,"Azure"),$(this.cx,this.cy,this.dr,"Azure"),$(this.cx,this.cy,this.br,"Azure"),$(this.cx,this.cy,this.brr,"CornFlowerBlue"),$(this.cx,this.cy,this.blr,"Crimson")]}calcInvoluteAngles(){this.checkInitStep(4,"calcInvoluteAngles"),this.involuteR=Ot(this.cx,this.cy,this.brr,0,!0),this.dr>this.brr?this.rud=this.involuteR.uFromL(this.dr):this.rud=0,this.rup=this.involuteR.uFromL(this.pr),this.rua=this.involuteR.uFromL(this.ar),this.rwd=this.involuteR.wFromU(this.rud),this.rwp=this.involuteR.wFromU(this.rup),this.rwa=this.involuteR.wFromU(this.rua),this.involuteL=Ot(this.cx,this.cy,this.blr,0,!1),this.dr>this.blr?this.lud=this.involuteL.uFromL(this.dr):this.lud=0,this.lup=this.involuteL.uFromL(this.pr),this.lua=this.involuteL.uFromL(this.ar),this.lwd=this.involuteL.wFromU(this.lud),this.lwp=this.involuteL.wFromU(this.lup),this.lwa=this.involuteL.wFromU(this.lua)}checkProfileConditions(){const s=this.as*this.adt,e=this.rwa-this.rwp,d=Math.abs(this.lwa-this.lwp),t=s-e-d;if(t<0)throw`err554: No remaining Addendum reserve ${p(t)}
`;const n=this.as*(1-this.adt),i=this.rwp-this.rwd,a=Math.abs(this.lwp-this.lwd),r=n-i-a;if(r<2*Math.atan2(this.bRound,this.br))throw`err555: No remaining Dedendum reserve ${p(r)} compare to bRound ${p(this.bRound)}
`}getToothRef(){const s=6*this.involArcPairs,e=0;this.checkInitStep(7,"getProfile"),this.calcInvoluteAngles();const d=(this.rua-this.rud)/s,t=(this.lua-this.lud)/s,n=this.initAngle+e*this.as,i=Ot(this.cx,this.cy,this.brr,n-this.rwp,!0),[a,r]=i.ptc(this.rud+0*d),c=B(a,r,"Gold");for(let f=0;f<s;f++){const[_,u]=i.ptc(this.rud+(f+1)*d);c.addSegStrokeA(_,u)}const h=n+this.as*this.adt,l=Ot(this.cx,this.cy,this.blr,h-this.lwp,!1);for(let f=0;f<s+1;f++){const[_,u]=l.ptc(this.lud+(s-f)*t);c.addSegStrokeA(_,u)}return c.closeSegStroke(),c}getProfile(){this.checkInitStep(7,"getProfile"),this.calcInvoluteAngles(),this.checkProfileConditions();const s=this.rwd-this.rwp,e=this.lwd-this.lwp,d=this.dr>this.brr?this.dr:this.brr,t=this.dr>this.blr?this.dr:this.blr;if(this.bRound>d-this.br)throw`err409: getProfile bRound ${p(this.bRound)} too large for erdr ${p(d)} and br ${p(this.br)}`;if(this.bRound>t-this.br)throw`err408: getProfile bRound ${p(this.bRound)} too large for eldr ${p(t)} and br ${p(this.br)}`;const n=(this.rua-this.rud)/this.involArcPairs,i=(this.lua-this.lud)/this.involArcPairs,a=ae(this.cx,this.cy),r=a.translatePolar(this.initAngle+s,this.br),c=B(r.cx,r.cy);for(let h=0;h<this.TN;h++){const l=this.initAngle+h*this.as,f=a.translatePolar(l+s,this.br);c.addSegStrokeA(f.cx,f.cy).addCornerRounded(this.bRound);const _=Ot(this.cx,this.cy,this.brr,l-this.rwp,!0),[u,g]=_.ptc(this.rud),S=_.ptcta(this.rud),L=ae(u,g).translatePolar(S-Math.PI/2,this.skinThickness);c.addSegStrokeA(L.cx,L.cy);for(let b=0;b<this.involArcPairs;b++){const j=this.rud+b*n,[O,y]=_.ptc(j+n),q=_.ptcta(j),X=_.ptcta(j+n)+Math.PI,N=ae(O,y).translatePolar(q-Math.PI/2,this.skinThickness);c.addPointA(N.cx,N.cy).addSeg2Arcs(q,X)}const R=l+this.as*this.adt,v=Ot(this.cx,this.cy,this.blr,R-this.lwp,!1),x=this.lud+this.involArcPairs*i,[C,T]=v.ptc(x),w=v.ptcta(x)+Math.PI,P=ae(C,T).translatePolar(w-Math.PI/2,this.skinThickness);c.addSegStrokeA(P.cx,P.cy);for(let b=0;b<this.involArcPairs;b++){const j=this.lud+(this.involArcPairs-b)*i,[O,y]=v.ptc(j-i),q=v.ptcta(j)+Math.PI,X=v.ptcta(j-i),N=ae(O,y).translatePolar(q-Math.PI/2,this.skinThickness);c.addPointA(N.cx,N.cy).addSeg2Arcs(q,X)}const M=a.translatePolar(R+e,this.br);c.addSegStrokeA(M.cx,M.cy).addCornerRounded(this.bRound)}return c.closeSegStroke(),c}getMsg(){return this.msg}};function gs(){return new jn}function Fn(s,e,d,t){s.checkInitStep(1,"helper.gw2center-1"),e.checkInitStep(1,"helper.gw2center-2");const n=s.pr+e.pr+t,i=s.cx+n*Math.cos(d),a=s.cy+n*Math.sin(d);return[i,a,n]}function Bn(s,e,d,t,n,i,a,r,c,h,l){s.checkInitStep(3,"helper.baseCircles-1"),e.checkInitStep(3,"helper.baseCircles-2");let f=d,_=n,u=t,g=i;const S=s.pr+e.pr,L=h,R=l;switch(L){case 0:e.TN>s.TN?(f=s.dr,_=f*e.TN/s.TN):(_=e.dr,f=_*s.TN/e.TN);break;case 1:_=f*e.TN/s.TN;break;case 2:f=_*s.TN/e.TN;break;case 3:f=S*s.TN/(s.TN+e.TN)*Math.cos(xe(a)),_=f*e.TN/s.TN;break;case 4:break;default:console.log(`err337: involROpt2 case ${L} is not implemented!`)}switch(R){case 0:e.TN>s.TN?(u=s.dr,g=u*e.TN/s.TN):(g=e.dr,u=g*s.TN/e.TN);break;case 1:g=u*e.TN/s.TN;break;case 2:u=g*s.TN/e.TN;break;case 3:u=S*s.TN/(s.TN+e.TN)*Math.cos(xe(r)),g=u*e.TN/s.TN;break;case 4:break;default:console.log(`err358: involLOpt2 case ${R} is not implemented!`)}return c===1&&(u=f,g=_),[f,u,_,g]}var zn=class{gw1;gw2;initAngle1;angleCenterCenter;interAxis;rightLeftCenter2;msg;apr;apl;lBDr=0;lBDl=0;laStartRr1=0;laStartRr2=0;laStartRl1=0;laStartRl2=0;aFODr1=0;aFODr2=0;aFODl1=0;aFODl2=0;lasr1=0;lasr2=0;lasl1=0;lasl2=0;firstToothUr1=0;firstToothUl1=0;ftdr1=0;ftdl1=0;constructor(s,e,d,t,n,i){this.gw1=s,this.gw2=e,this.initAngle1=d,this.angleCenterCenter=t,this.interAxis=n,this.rightLeftCenter2=i,this.msg="",this.apr=0,this.apl=0}check1(){this.gw1.checkInitStep(4,"ActionLine.check1-1"),this.gw2.checkInitStep(4,"ActionLine.check1-2"),this.interAxis>this.gw1.ar+this.gw2.ar&&(this.msg+=`warn333: initAngle2 interAxis ${p(this.interAxis)} is too large compare to gw1.ar ${p(this.gw1.ar)} and gw2.ar ${p(this.gw2.ar)}
`),Je(this.gw1.brr*this.gw2.TN-this.gw2.brr*this.gw1.TN)!==0&&(this.msg+=`warn407: right ratios differ N1/N2 = ${this.gw1.TN} / ${this.gw2.TN} = ${p(this.gw1.TN/this.gw2.TN)} and brr1/brr2 = ${p(this.gw1.brr)}/${p(this.gw2.brr)} = ${p(this.gw1.brr/this.gw2.brr)}
`),Je(this.gw1.blr*this.gw2.TN-this.gw2.blr*this.gw1.TN)!==0&&(this.msg+=`warn408: left ratios differ N1/N2 = ${this.gw1.TN} / ${this.gw2.TN} = ${p(this.gw1.TN/this.gw2.TN)} and blr1/blr2 = ${p(this.gw1.blr)}/${p(this.gw2.blr)} = ${p(this.gw1.blr/this.gw2.blr)}
`)}check2(){this.gw1.checkInitStep(5,"ActionLine.check2-1"),this.gw2.checkInitStep(5,"ActionLine.check2-2"),Je(this.gw1.adt+this.gw2.adt-1)>0&&(this.msg+=`warn281: addendum thickness too large: adt1 ${p(this.gw1.adt)} adt2 ${p(this.gw2.adt)}
`);const s=this.gw1.ar-this.gw1.pr,e=this.gw1.pr-this.gw1.dr,d=this.gw2.ar-this.gw2.pr,t=this.gw2.pr-this.gw2.dr;Je(t-s)<0&&(this.msg+=`warn282: addendum-1 ${p(s)} larger than dedendum-2 ${p(t)}
`),Je(e-d)<0&&(this.msg+=`warn283: addendum-2 ${p(d)} larger than dedendum-1 ${p(e)}
`)}calcActionLine(){this.gw1.checkInitStep(4,"ActionLine.calcActionLine-1"),this.gw2.checkInitStep(4,"ActionLine.calcActionLine-2"),this.gw1.calcInvoluteAngles(),this.gw2.calcInvoluteAngles();const s=this.interAxis*this.gw1.brr/(this.gw1.brr+this.gw2.brr),e=this.interAxis*this.gw1.blr/(this.gw1.blr+this.gw2.blr),d=this.interAxis-s,t=this.interAxis-e;this.apr=Math.acos((this.gw1.brr+this.gw2.brr)/this.interAxis),this.apl=Math.acos((this.gw1.blr+this.gw2.blr)/this.interAxis),this.msg+=`Pressure angular: right: ${p(Ce(this.apr))} left: ${p(Ce(this.apl))} degree
`,this.lBDr=this.interAxis*Math.sin(this.apr),this.lBDl=this.interAxis*Math.sin(this.apl),this.msg+=`Line of Action Maximum length: right: ${p(this.lBDr)} left: ${p(this.lBDl)} mm
`;const n=Math.PI/2+this.apr,i=bo(this.gw1.ar,s,n);this.aFODr1=Math.PI-n-i;const a=this.gw1.rua-this.apr-this.gw1.rwa;if(Je(this.aFODr1-a)!==0)throw`dbg378: aFODr1 ${this.aFODr1} and aFODr1Alt ${a} differ`;const r=wo(s,this.gw1.ar,this.aFODr1),c=n,h=bo(this.gw2.ar,d,c);this.aFODr2=Math.PI-c-h;const l=this.gw2.rua-this.apr-this.gw2.rwa;if(Je(this.aFODr2-l)!==0)throw`dbg379: aFODr2 ${this.aFODr2} and aFODr2Alt ${l} differ`;const f=wo(d,this.gw2.ar,this.aFODr2),_=r+f,u=_/this.gw1.brr,g=_/this.gw2.brr,S=this.gw1.rua-u,L=this.gw2.rua-g;this.laStartRr1=this.gw1.involuteR.lFromU(S),this.laStartRr2=this.gw2.involuteR.lFromU(L);const R=Math.PI/2+this.apl,v=bo(this.gw1.ar,e,R);this.aFODl1=Math.PI-R-v;const x=this.gw1.lua-this.apl+this.gw1.lwa;if(Je(this.aFODl1-x)!==0)throw`dbg388: aFODl1 ${this.aFODl1} and aFODl1Alt ${x} differ`;const C=wo(e,this.gw1.ar,this.aFODl1),T=R,w=bo(this.gw2.ar,t,T);this.aFODl2=Math.PI-T-w;const P=this.gw2.lua-this.apl+this.gw2.lwa;if(Je(this.aFODl2-P)!==0)throw`dbg389: aFODl2 ${this.aFODl2} and aFODl2Alt ${P} differ`;const M=wo(t,this.gw2.ar,this.aFODl2),b=C+M,j=b/this.gw1.blr,O=b/this.gw2.blr,y=this.gw1.lua-j,q=this.gw2.lua-O;this.laStartRl1=this.gw1.involuteL.lFromU(y),this.laStartRl2=this.gw2.involuteL.lFromU(q),this.msg+=`Line of Action Effective length: right: ${p(_)} left: ${p(b)} mm
`,this.msg+=`Line of Action Effective rotation angle: right-1: ${p(Ce(u))} right-2: ${p(Ce(g))} left-1: ${p(Ce(j))} left-2: ${p(Ce(O))} degree
`,this.msg+=`Line of Action Effective height: right-1: ${p(this.gw1.ar-this.laStartRr1)} right-2: ${p(this.gw2.ar-this.laStartRr2)} left-1: ${p(this.gw1.ar-this.laStartRl1)} left-2: ${p(this.gw2.ar-this.laStartRl2)} mm
`,this.lasr1=2*Math.PI/this.gw1.TN*this.gw1.brr,this.lasr2=2*Math.PI/this.gw2.TN*this.gw2.brr,this.msg+=`Line of Action right: step length: 1: ${p(this.lasr1)} 2: ${p(this.lasr2)} mm
`,this.msg+=`Line of Action right: nb of contact point: 1: ${p(_/this.lasr1)} 2: ${p(_/this.lasr2)}
`,this.lasl1=2*Math.PI/this.gw1.TN*this.gw1.blr,this.lasl2=2*Math.PI/this.gw2.TN*this.gw2.blr,this.msg+=`Line of Action left: step length: 1: ${p(this.lasl1)} 2: ${p(this.lasl2)} mm
`,this.msg+=`Line of Action left: nb of contact point: 1: ${p(b/this.lasl1)} 2: ${p(b/this.lasl2)}
`}calcContactPoint1(){for(this.gw1.checkInitStep(5,"ActionLine.calcContactPoint1"),this.firstToothUr1=Fo(this.apr-(this.initAngle1-this.angleCenterCenter)+this.gw1.rwp);Je(this.firstToothUr1-this.gw1.as)>=0;)this.firstToothUr1=Je(this.firstToothUr1-this.gw1.as);for(this.firstToothUl1=Fo(this.apl+(this.initAngle1-this.angleCenterCenter)+this.gw1.as*this.gw1.adt-this.gw1.lwp);Je(this.firstToothUl1-this.gw1.as)>=0;)this.firstToothUl1=Je(this.firstToothUl1-this.gw1.as);this.ftdr1=this.gw1.brr*this.firstToothUr1,this.ftdl1=this.gw1.blr*this.firstToothUl1}prepare(){this.check1(),this.check2(),this.calcActionLine(),this.calcContactPoint1()}oneContactSpeed(s,e,d,t,n,i,a,r,c,h){const f=Math.floor(e/(2*d)),_=(t+f*d)/n,u=s?1:-1,[g,S,L,R]=i.laptc(a,u*r,_,.4);this.msg+=`speed ${c}: vx ${p(L)} vy: ${p(R)} m/s
`;const v=ae(g,S),x=a+u*r,C=B(g,S,h),T=v.translatePolar(x,-R);C.addSegStrokeA(T.cx,T.cy);const w=T.translatePolar(x-u*Math.PI/2,L);return C.addSegStrokeA(w.cx,w.cy),C.closeSegStroke(),C}getContactSpeed(){const s=this.oneContactSpeed(!0,this.lBDr,this.lasr1,this.ftdr1,this.gw1.brr,this.gw1.involuteR,this.angleCenterCenter,this.apr,"R1","Black"),e=this.oneContactSpeed(!1,this.lBDl,this.lasl1,this.ftdl1,this.gw1.blr,this.gw1.involuteL,this.angleCenterCenter,this.apl,"L1","Black"),d=[];return d.push(s),d.push(e),d}getContours(){const s=[];s.push($(this.gw1.cx,this.gw1.cy,this.laStartRr1,"SkyBlue")),s.push($(this.gw1.cx,this.gw1.cy,this.laStartRl1,"SlateBlue")),s.push($(this.gw2.cx,this.gw2.cy,this.laStartRr2,"SkyBlue")),s.push($(this.gw2.cx,this.gw2.cy,this.laStartRl2,"SlateBlue"));const e=ae(this.gw1.cx,this.gw1.cy),d=ae(this.gw2.cx,this.gw2.cy),t=e.translatePolar(this.angleCenterCenter+this.apr,this.gw1.brr),n=d.translatePolar(this.angleCenterCenter+Math.PI+this.apr,this.gw2.brr),i=B(t.cx,t.cy,"YellowGreen");i.addSegStrokeA(n.cx,n.cy),i.closeSegStroke(),s.push(i);const a=e.translatePolar(this.angleCenterCenter-this.aFODr1,this.gw1.ar),r=d.translatePolar(this.angleCenterCenter+Math.PI-this.aFODr2,this.gw2.ar),c=B(a.cx,a.cy,"Yellow");c.addSegStrokeA(r.cx,r.cy),c.closeSegStroke(),s.push(c);const h=e.translatePolar(this.angleCenterCenter-this.apl,this.gw1.blr),l=d.translatePolar(this.angleCenterCenter+Math.PI-this.apl,this.gw2.blr),f=B(h.cx,h.cy,"YellowGreen");f.addSegStrokeA(l.cx,l.cy),f.closeSegStroke(),s.push(f);const _=e.translatePolar(this.angleCenterCenter+this.aFODl1,this.gw1.ar),u=d.translatePolar(this.angleCenterCenter+Math.PI+this.aFODl2,this.gw2.ar),g=B(_.cx,_.cy,"Yellow");return g.addSegStrokeA(u.cx,u.cy),g.closeSegStroke(),s.push(g),s.push(...this.getContactSpeed()),s}getContactPoint(){const s=[],e=ae(this.gw1.cx,this.gw1.cy),d=e.translatePolar(this.angleCenterCenter+this.apr,this.gw1.brr),t=e.translatePolar(this.angleCenterCenter-this.apl,this.gw1.blr);s.push(ae(d.cx,d.cy,eo.eBigSquare)),s.push(ae(t.cx,t.cy,eo.eBigSquare));const n=this.angleCenterCenter+this.apr-Math.PI/2,i=this.angleCenterCenter-this.apl+Math.PI/2,a=d.translatePolar(n,this.ftdr1),r=t.translatePolar(i,this.ftdl1);s.push(ae(a.cx,a.cy,eo.eBigSquare)),s.push(ae(r.cx,r.cy,eo.eBigSquare));let c=this.ftdr1;for(;c+this.lasr1<this.lBDr;){c+=this.lasr1;const l=d.translatePolar(n,c);s.push(ae(l.cx,l.cy,eo.eBigSquare))}let h=this.ftdl1;for(;h+this.lasl1<this.lBDl;){h+=this.lasl1;const l=t.translatePolar(i,h);s.push(ae(l.cx,l.cy,eo.eBigSquare))}return s}getMsg(){return this.msg}getInitAngle2(){let s=this.lBDr-this.ftdr1;for(;Je(s-this.lasr2)>=0;)s=Je(s-this.lasr2);let e=this.lBDl-this.ftdl1;for(;Je(e-this.lasl2)>=0;)e=Je(e-this.lasl2);const d=s/this.gw2.brr,t=e/this.gw2.blr,n=this.angleCenterCenter+Math.PI+this.apr-d+this.gw2.rwp,a=this.angleCenterCenter+Math.PI-this.apl+t+this.gw2.lwp-this.gw2.as*this.gw2.adt;let r=2*Math.PI+Fo(a);for(;Je(r-this.gw2.as-n)>=0;)r=Je(r-this.gw2.as);const c=r-n,h=c*this.gw2.brr/this.gw1.brr,l=c*this.gw2.brr,f=c*this.gw2.blr;this.msg+=`slack angle: 1: ${p(Ce(h))} 2: ${p(Ce(c))} degree
`,this.msg+=`slack on action line: right-2: ${p(l)} left-2: ${p(f)} mm
`;let _=0;if(this.rightLeftCenter2===0)_=n;else if(this.rightLeftCenter2===1)_=a;else if(this.rightLeftCenter2===2)_=n+c/2;else throw`err221: initAngle2 rightLeftCenter2 ${this.rightLeftCenter2} has an unkown value`;return rn(_)}};function Gn(s,e,d,t,n,i){return new zn(s,e,d,t,n,i)}function Jn(s,e,d,t,n,i,a,r,c){let h=$(s,e,d);if(t>0){if(n>2*d)throw`err383: axisTorque ribWidth ${p(n)} larger than 2x axisRadius ${p(d)}`;const l=Math.asin(n/(2*d)),f=2*Math.PI/t;if(f-2.5*l<0)throw`err384: axisTorque ribWidth ${p(n)} or ribNb ${t} are too large`;if(a>n/2)throw`err385: axisTorque ribRound1 ${p(a)} too large compare to ribWidth ${p(n)}`;if(a+r>i)throw`err386: axisTorque ribRound12 ${p(a)} ${p(r)} too large compare to ribHeight ${p(n)}`;const _=f-2*l>Math.PI,u=ae(s,e),S=u.translatePolar(c,d+i).translatePolar(c+Math.PI/2,n/2);h=B(S.cx,S.cy);for(let L=0;L<t;L++){const R=c+L*f,v=R+f,x=u.translatePolar(R+l,d),C=u.translatePolar(v-l,d),w=u.translatePolar(R,d+i).translatePolar(R+Math.PI/2,n/2),M=u.translatePolar(v,d+i).translatePolar(v-Math.PI/2,n/2);h.addSegStrokeA(w.cx,w.cy).addCornerRounded(a),h.addSegStrokeA(x.cx,x.cy).addCornerRounded(r),h.addPointA(C.cx,C.cy).addSegArc(d,_,!0).addCornerRounded(r),h.addSegStrokeA(M.cx,M.cy).addCornerRounded(a)}h.closeSegStroke()}return h}function Un(s,e,d,t,n,i,a,r){const c=2*Math.PI/n,h=Math.asin(i/(2*t)),l=Math.asin(i/(2*d));if(i>2*t)throw`err905: hollowStraight spokeWidth ${p(i)} too large for hollowInt ${p(t)}`;if(d-t<2.1*a)throw`err906: hollowStraight hollowExt ${p(d)}, hollowInt ${p(t)} and spokeRound ${p(a)} do not fit`;if(c-2*l<2.5*Math.asin(a/d))throw`err907: hollowStraight spokeNb ${n}, spokeWidth ${p(i)} or spokeRound ${p(a)} are too large`;const f=i/(2*Math.sin(c/2)),_=c-2*h<2.1*Math.asin(a/t),u=c-2*l>Math.PI,g=ae(s,e),S=[];for(let L=0;L<n;L++){const R=r+L*c,v=R+c,x=R+c/2,C=g.translatePolar(R+l,d),T=g.translatePolar(v-l,d),w=g.translatePolar(v-h,t),P=g.translatePolar(R+h,t),M=g.translatePolar(x,f),b=B(C.cx,C.cy);b.addCornerRounded(a),b.addPointA(T.cx,T.cy).addSegArc(d,u,!0).addCornerRounded(a),_?b.addSegStrokeA(M.cx,M.cy).addCornerRounded(a):(b.addSegStrokeA(w.cx,w.cy).addCornerRounded(a),b.addPointA(P.cx,P.cy).addSegArc(t,u,!1).addCornerRounded(a)),b.closeSegStroke(),S.push(b)}return S}function hs(s,e,d,t,n,i,a,r,c,h){const l=h?1:-1,f=s/2,_=f+e,u=_+d,g=B(0,-u);return g.addSegStrokeA(l*t,-u).addCornerRounded(a).addSegStrokeA(l*t,-_).addCornerRounded(r).addSegStrokeA(l*n,-_).addSegStrokeA(l*i,-f).addCornerRounded(c).addSegStrokeA(l*i,f).addCornerRounded(c).addSegStrokeA(l*n,_).addSegStrokeA(l*t,_).addCornerRounded(r).addSegStrokeA(l*t,u).addCornerRounded(a).addSegStrokeA(0,u).closeSegStroke(),g}var vs={partName:"gear_wheel",params:[o("module","mm",10,.1,100,.1),o("N1","scalar",23,3,1e3,1),o("N2","scalar",19,3,1e3,1),o("angleCenterCenter","degree",0,-180,180,1),o("addInterAxis","mm",0,0,100,.05),o("c1x","mm",0,-200,200,1),o("c1y","mm",0,-200,200,1),oe("Tooth addendum dedendum"),o("ah1","scalar",1,.1,2,.05),o("dh1","scalar",1,.1,2,.05),o("bh1","scalar",.25,.1,2,.05),o("bRound1","mm",2,0,50,.1),o("ah2","scalar",1,.1,2,.05),o("dh2","scalar",1,.1,2,.05),o("bh2","scalar",.25,.1,2,.05),o("bRound2","mm",2,0,50,.1),o("at1","%",50,10,90,.5),o("at2","%",50,10,90,.5),oe("Tooth involute of circle"),ct("involSym",!0),At("involROpt",["Optimum","Base-1","Base-2","PressureAngle","FreeBase-12"]),At("involLOpt",["Optimum","Base-1","Base-2","PressureAngle","FreeBase-12"]),o("brr1","mm",102.9,10,2e3,.05),o("blr1","mm",102.9,10,2e3,.05),o("brr2","mm",85,10,2e3,.05),o("blr2","mm",85,10,2e3,.05),o("rightPressureAngle","degree",26,1,45,.5),o("leftPressureAngle","degree",26,1,45,.5),o("involArcPairs1","scalar",2,1,40,1),o("involArcPairs2","scalar",2,1,40,1),o("skinThickness1","mm",0,-3,3,.01),o("skinThickness2","mm",0,-3,3,.01),o("initAngle1","degree",0,-180,180,1),At("gw2Position",["right","left","center"]),oe("Inner"),ct("centralAxis",!0),o("axisRadius","mm",10,.1,200,.1),o("ribNb","scalar",5,0,32,1),o("ribWidth","mm",8,1,100,.1),o("ribHeight","mm",8,1,100,.1),o("ribRound1","mm",2,0,20,.1),o("ribRound2","mm",2,0,20,.1),ct("hollow",!0),o("materialHeightExt","mm",20,1,200,.5),o("materialHeightInt","mm",15,1,200,.5),o("spokeNb","scalar",5,1,18,1),o("spokeWidth","mm",15,1,200,.1),o("spokeRound","mm",10,0,20,.1),oe("Axis"),ct("wheelAxis",!0),o("wheelHeight","mm",40,.1,400,.1),o("wheelMidExtra","mm",6,0,10,.1),o("wheelAxisLength","mm",40,0,400,.1),o("wheelAxisRadius","mm",20,0,200,.1),o("wheelMidRadius","mm",60,0,200,.1),o("wheelRadiusExtra","mm",1,0,20,.1),o("wheelAxisExtRound","mm",4,0,20,.1),o("wheelAxisIntRound","mm",0,0,20,.1),o("wheelExtraRound","mm",4,0,20,.1)],paramSvg:{module:"gearwheel_params_main.svg",N1:"gearwheel_params_main.svg",N2:"gearwheel_params_main.svg",angleCenterCenter:"gearwheel_params_interaxis.svg",addInterAxis:"gearwheel_params_interaxis.svg",c1x:"gearwheel_params_main.svg",c1y:"gearwheel_params_main.svg",ah1:"gearwheel_params_teeth_height.svg",dh1:"gearwheel_params_teeth_height.svg",bh1:"gearwheel_params_teeth_height.svg",bRound1:"gearwheel_params_teeth_height.svg",ah2:"gearwheel_params_teeth_height.svg",dh2:"gearwheel_params_teeth_height.svg",bh2:"gearwheel_params_teeth_height.svg",bRound2:"gearwheel_params_teeth_height.svg",at1:"gearwheel_params_addendum_portion.svg",at2:"gearwheel_params_addendum_portion.svg",involSym:"gearwheel_params_involSym.svg",involROpt:"gearwheel_params_main.svg",involLOpt:"gearwheel_params_main.svg",brr1:"gearwheel_params_baseCircles.svg",brr2:"gearwheel_params_baseCircles.svg",blr1:"gearwheel_params_baseCircles.svg",blr2:"gearwheel_params_baseCircles.svg",rightPressureAngle:"gearwheel_params_baseCircles.svg",leftPressureAngle:"gearwheel_params_baseCircles.svg",involArcPairs1:"gearwheel_params_skin.svg",skinThickness1:"gearwheel_params_skin.svg",involArcPairs2:"gearwheel_params_skin.svg",skinThickness2:"gearwheel_params_skin.svg",initAngle1:"gearwheel_params_initAngle.svg",gw2Position:"gearwheel_params_initAngle.svg",centralAxis:"gearwheel_params_hollow_axis.svg",axisRadius:"gearwheel_params_hollow_axis.svg",ribNb:"gearwheel_params_hollow_axis.svg",ribWidth:"gearwheel_params_hollow_axis.svg",ribHeight:"gearwheel_params_hollow_axis.svg",ribRound1:"gearwheel_params_hollow_axis.svg",ribRound2:"gearwheel_params_hollow_axis.svg",hollow:"gearwheel_params_hollow_axis.svg",materialHeightExt:"gearwheel_params_hollow_axis.svg",materialHeightInt:"gearwheel_params_hollow_axis.svg",spokeNb:"gearwheel_params_hollow_axis.svg",spokeWidth:"gearwheel_params_hollow_axis.svg",spokeRound:"gearwheel_params_hollow_axis.svg",wheelAxis:"gearwheel_params_side.svg",wheelHeight:"gearwheel_params_side.svg",wheelMidExtra:"gearwheel_params_side.svg",wheelAxisLength:"gearwheel_params_side.svg",wheelAxisRadius:"gearwheel_params_side.svg",wheelMidRadius:"gearwheel_params_side.svg",wheelRadiusExtra:"gearwheel_params_side.svg",wheelAxisExtRound:"gearwheel_params_side.svg",wheelAxisIntRound:"gearwheel_params_side.svg",wheelExtraRound:"gearwheel_params_side.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function Wn(s,e,d=""){const t=be(vs.partName+d),n=G(),i=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const a=[],r=gs(),c=gs();r.set1ModuleToothNumber(e.module,e.N1),c.set1ModuleToothNumber(e.module,e.N2),r.set2CenterPosition(e.c1x,e.c1y);const h=xe(e.angleCenterCenter),[l,f,_]=Fn(r,c,h,e.addInterAxis);c.set2CenterPosition(l,f),r.set3CircleRadius(e.ah1,e.dh1,e.bh1,e.bRound1),c.set3CircleRadius(e.ah2,e.dh2,e.bh2,e.bRound2);const[u,g,S,L]=Bn(r,c,e.brr1,e.blr1,e.brr2,e.blr2,e.rightPressureAngle,e.leftPressureAngle,e.involSym,e.involROpt,e.involLOpt);t.logstr+=`base-circles: brr1: ${u.toFixed(2)}  blr1: ${g.toFixed(2)}  brr2: ${S.toFixed(2)}  blr2: ${L.toFixed(2)}
`,r.set4BaseCircles(u,g),c.set4BaseCircles(S,L),r.set5AddendumThickness(e.at1),c.set5AddendumThickness(e.at2);const R=xe(e.initAngle1)+s*3*r.as/100;r.set6Angles(R,h);const v=Gn(r,c,R,h,_,e.gw2Position);v.prepare();for(const b of v.getContours())n.addDynamics(b);n.addPoints(v.getContactPoint()),c.set6Angles(v.getInitAngle2(),h+Math.PI),t.logstr+=v.getMsg(),r.set7InvoluteDetails(e.involArcPairs1,e.skinThickness1),c.set7InvoluteDetails(e.involArcPairs2,e.skinThickness2);for(const b of r.getRefCircles())n.addDynamics(b);for(const b of c.getRefCircles())n.addDynamics(b);n.addDynamics(r.getToothRef()),n.addDynamics(c.getToothRef());const x=r.getProfile();if(t.logstr+=r.getMsg(),t.logstr+=x.check(),a.push(x),e.centralAxis===1){const b=Jn(r.cx,r.cy,e.axisRadius,e.ribNb,e.ribWidth,e.ribHeight,e.ribRound1,e.ribRound2,R);t.logstr+=b.check(),a.push(b)}if(e.hollow===1){const b=r.br,j=e.axisRadius+e.ribHeight,O=b-e.materialHeightExt,y=j+e.materialHeightInt;if(y>O)throw`err902: hollowMaterialInt ${p(y)} bigger than hollowMaterialExt ${p(O)}`;const q=Un(r.cx,r.cy,O,y,e.spokeNb,e.spokeWidth,e.spokeRound,R);for(const X of q)t.logstr+=X.check(),a.push(X)}n.addMainOI(a);const C=c.getProfile();t.logstr+=C.check(),n.addSecond(C);const T=[],w=r.ar+e.wheelRadiusExtra;if(e.wheelAxis===1){const b=hs(e.wheelHeight,e.wheelMidExtra,e.wheelAxisLength,e.wheelAxisRadius,e.wheelMidRadius,w,e.wheelAxisExtRound,e.wheelAxisIntRound,e.wheelExtraRound,!0),j=hs(e.wheelHeight,e.wheelMidExtra,e.wheelAxisLength,e.wheelAxisRadius,e.wheelMidRadius,w,e.wheelAxisExtRound,e.wheelAxisIntRound,e.wheelExtraRound,!1);T.push(b),i.addSecond(j)}else{const b=B(0,-e.wheelHeight/2).addSegStrokeR(0,e.wheelHeight).addSegStrokeR(w,0).addSegStrokeR(0,-e.wheelHeight).closeSegStroke(),j=B(0,-e.wheelHeight/2).addSegStrokeR(0,e.wheelHeight).addSegStrokeR(-w,0).addSegStrokeR(0,-e.wheelHeight).closeSegStroke();T.push(b),i.addSecond(j)}i.addMainOI(T),t.fig={teethProfile:n,axisProfile:i};const P=t.partName,M=e.wheelHeight/2+e.wheelMidExtra+e.wheelAxisLength+10;t.vol={extrudes:[{outName:`subpax_${P}_teethProfile`,face:`${P}_teethProfile`,extrudeMethod:se.eLinearOrtho,length:2*M,rotate:[0,0,0],translate:[0,0,-M]},{outName:`subpax_${P}_axisProfile`,face:`${P}_axisProfile`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${P}`,boolMethod:pe.eIntersection,inList:[`subpax_${P}_teethProfile`,`subpax_${P}_axisProfile`]}]},t.logstr+=`gear_wheel drawn successfully!
`,t.calcErr=!1}catch(a){t.logstr+=a,console.log(a)}return t}var qn={pTitle:"Gearwheel",pDescription:"Gear-system with two wheels",pDef:vs,pGeom:Wn},Ss={partName:"gear_bar",params:[o("H1","mm",40,1,4e3,1),o("H2","mm",50,1,4e3,1),o("radius","mm",10,1,4e3,1),oe("corners"),o("Rc","mm",10,0,400,1)],paramSvg:{H1:"voila_face.svg",H2:"voila_face.svg",radius:"voila_face.svg",Rc:"voila_face.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Xn(s,e,d=""){const t=be(Ss.partName+d),n=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const i=[],a=B(-e.H1/2,-e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(e.H1/2,-e.H2/2).addSegStrokeA(e.H1/2,e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(-e.H1/2,e.H2/2).closeSegStroke();i.push(a),i.push($(0,0,e.radius)),n.addMainOI(i),t.fig={faceVoila:n};const r=t.partName;t.vol={extrudes:[{outName:`subpax_${r}_top`,face:`${r}_faceVoila`,extrudeMethod:se.eLinearOrtho,length:10,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${r}`,boolMethod:pe.eIdentity,inList:[`subpax_${r}_top`]}]},t.sub={},t.logstr+=`gear_bar drawn successfully!
`,t.calcErr=!1}catch(i){t.logstr+=i,console.log(i)}return t}var Yn={pTitle:"Gearbar",pDescription:"Gear-system with a bar and a wheel",pDef:Ss,pGeom:Xn},Ls={partName:"gear_ring",params:[o("H1","mm",40,1,4e3,1),o("H2","mm",50,1,4e3,1),o("radius","mm",10,1,4e3,1),oe("corners"),o("Rc","mm",10,0,400,1)],paramSvg:{H1:"voila_face.svg",H2:"voila_face.svg",radius:"voila_face.svg",Rc:"voila_face.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Zn(s,e,d=""){const t=be(Ls.partName+d),n=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const i=[],a=B(-e.H1/2,-e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(e.H1/2,-e.H2/2).addSegStrokeA(e.H1/2,e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(-e.H1/2,e.H2/2).closeSegStroke();i.push(a),i.push($(0,0,e.radius)),n.addMainOI(i),t.fig={faceVoila:n};const r=t.partName;t.vol={extrudes:[{outName:`subpax_${r}_top`,face:`${r}_faceVoila`,extrudeMethod:se.eLinearOrtho,length:10,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${r}`,boolMethod:pe.eIdentity,inList:[`subpax_${r}_top`]}]},t.sub={},t.logstr+=`gear_ring drawn successfully!
`,t.calcErr=!1}catch(i){t.logstr+=i,console.log(i)}return t}var Kn={pTitle:"Gearring",pDescription:"Gear-system with a ring and a wheel",pDef:Ls,pGeom:Zn},xs={partName:"gear_epicycloid",params:[o("H1","mm",40,1,4e3,1),o("H2","mm",50,1,4e3,1),o("radius","mm",10,1,4e3,1),oe("corners"),o("Rc","mm",10,0,400,1)],paramSvg:{H1:"voila_face.svg",H2:"voila_face.svg",radius:"voila_face.svg",Rc:"voila_face.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Qn(s,e,d=""){const t=be(xs.partName+d),n=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const i=[],a=B(-e.H1/2,-e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(e.H1/2,-e.H2/2).addSegStrokeA(e.H1/2,e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(-e.H1/2,e.H2/2).closeSegStroke();i.push(a),i.push($(0,0,e.radius)),n.addMainOI(i),t.fig={faceVoila:n};const r=t.partName;t.vol={extrudes:[{outName:`subpax_${r}_top`,face:`${r}_faceVoila`,extrudeMethod:se.eLinearOrtho,length:10,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${r}`,boolMethod:pe.eIdentity,inList:[`subpax_${r}_top`]}]},t.sub={},t.logstr+=`gear_epicycloid drawn successfully!
`,t.calcErr=!1}catch(i){t.logstr+=i,console.log(i)}return t}var er={pTitle:"Gear-epicycloid",pDescription:"The epicycloid gear system",pDef:xs,pGeom:Qn};function tr(s){let e="";const d=s.PHD1/2,t=s.PHD5/2,n=2*Math.asin(s.PHR4/d),i=2*Math.asin(s.PHL2/(2*t)),a=2*Math.PI/s.PHN1-i,r=s.PHL2/2,c=Math.sqrt(t**2-r**2)-d,h=Math.sqrt(r**2+c**2),l=Math.acos(c/h),f=Math.acos(s.PHR4/h),_=Math.PI-l-f;if(t<d+s.PHR4)throw`err211: PHD5 ${s.PHD5} too small compare to PHD1 ${s.PHD1} or PHR4 ${s.PHR4}`;if(a<i)throw`err212: PHL2 ${s.PHL2} too large compare to PHN1 ${s.PHN1}`;if(s.PHD3>2*s.PHR4)throw`err213: PHD3 ${s.PHD3} too large compare to PHR4 ${s.PHR4}`;_>Math.PI/2-n&&(e+=`warn345: PHL2 is quiet small ${p(s.PHL2)} mm
`),e+=`petal angle: ${p(Ce(i))} degree
`,e+=`hollow angle: ${p(Ce(a))} degree
`;const u=ae(0,0),S=ae(t,0).rotate(u,-i/2),L=ae(d,0),R=ae(d-s.PHR4,0),v=R.rotate(L,_),x=R.rotate(L,-_),C=B(S.cx,S.cy).addCornerRounded(s.PHR6).addSegStrokeA(v.cx,v.cy).addPointA(d-s.PHR4,0).addPointA(x.cx,x.cy).addSegArc2().addSegStrokeAP(i/2,t).addCornerRounded(s.PHR6).addPointAP(i/2+a/2,t).addPointAP(i/2+a,t).addSegArc2(),T=B(S.cx,S.cy),w=[...Array(s.PHN1).keys()].map(P=>P*(i+a));for(const P of w)T.addPartial(C.rotate(0,0,P));return[e,T,w]}function Ps(s){const d=s.D1/2,t=s.D2/2,n=s.D4/2,i=2*Math.PI/s.N1,a=s.L1/2,r=Math.sqrt(t**2-a**2),c=Math.asin(a/t),h=d-r,l=Math.atan2(a,h),f=Math.sqrt(a**2+h**2),_=Math.acos(n/f),u=l+_,g=(i-2*c)/2;if(g<0)throw`err464: N1 ${s.N1} is too large compare to D2 ${s.D2}, L1 ${s.L1}`;if(d<t)throw`err465: D2 ${s.D2} is too large compare to D1 ${s.D1}`;const S=B(r,-a),L=ae(0,0),R=ae(t,0),v=ae(d,0),C=ae(d-n,0).rotate(v,u),T=R.rotate(L,c+g),w=R.rotate(L,i-c),P=B(r,-a).addCornerRounded(s.R5).addSegStrokeA(C.cx,C.cy).addPointA(d+n,0).addPointA(C.cx,-C.cy).addSegArc2().addSegStrokeA(r,a).addCornerRounded(s.R5).addPointA(T.cx,T.cy).addPointA(w.cx,w.cy).addSegArc2();for(let M=0;M<s.N1;M++)S.addPartial(P.rotate(0,0,M*i));return["",S,i]}function Eo(s,e){let d="";const t=s.SD2/2,n=t+s.SE1,i=2*n;let a=!1,r=-t,c=-n;if(e&&(a=!0,r=n,c=t),s.SL2<n)throw`err421: SL2 ${s.SL2} is too small compare to SD2 ${s.SD2} and SE1 ${s.SE1}`;d+=`info309: spring height: ${p(s.SL1+i)} length: ${p(s.SN1*2*(s.SD2+s.SE1))}
`;const h=B(0,0);for(let l=0;l<s.SN1;l++)h.addSegStrokeR(0,-s.SL1).addPointR(2*r,0).addSegArc(Math.abs(r),!1,a),l<s.SN1-1?h.addSegStrokeR(0,s.SL1).addPointR(2*c,0).addSegArc(Math.abs(c),!1,!a):s.Send===1?h.addSegStrokeR(0,s.SL2):h.addSegStrokeR(0,s.SL2-n).addPointR(2*c,0).addSegArc(Math.abs(c),!1,!a);s.Send===1?h.addSegStrokeR(-s.SE1,0):h.addSegStrokeR(s.SE1,0);for(let l=0;l<s.SN1;l++)l>0?h.addPointR(-2*r,0).addSegArc(Math.abs(r),!1,a).addSegStrokeR(0,-s.SL1):s.Send===1?h.addSegStrokeR(0,-s.SL2):h.addPointR(-2*r,0).addSegArc(Math.abs(r),!1,a).addSegStrokeR(0,-s.SL2+n),h.addPointR(-2*c,0).addSegArc(Math.abs(c),!1,!a).addSegStrokeR(0,s.SL1);return[d,h]}function or(s){let e="";const d=s.D6/2,t=2*Math.PI/s.N2,n=s.E2/2,i=2*Math.asin(n/d),a=(t-i)/2,c=(s.N2<3?0:Math.PI/s.N2)+xe(s.SA1),h=Math.PI/2-c,l=-Math.PI/2+c,f=s.SD1/2;if(a<0)throw`err564: N2 ${s.N2} is too large compare to D6 ${s.D6}, E2 ${s.E2}`;if(s.orientation===2&&s.N2%2===1)throw`err565: N2 ${s.N2} is odd and orientation is alt`;const[_,u]=Eo(s,!1),[,g]=Eo(s,!0);e+=_;const S=ae(0,-d),L=ae(0,0),R=S.rotate(L,i),v=S.translate(0,s.L2),x=v.translate(-f,0),C=x.translate(0,f),T=x.translate(0,f+s.SE1),w=T.rotate(x,h),P=v.translate(0,f+s.SE1).translate(s.SE1,0),M=S.rotate(L,-i),b=v.translate(f,0),j=b.translate(0,f),O=j.rotate(b,l),y=b.translate(0,f+s.SE1),q=v.translate(0,f+s.SE1).translate(-s.SE1,0),X=B(R.cx,R.cy).addSegStrokeA(P.cx,P.cy).addSegStrokeA(T.cx,T.cy),N=B(T.cx,T.cy).addPointA(w.cx,w.cy).addSegArc(f+s.SE1,!1,!0);N.addPartial(u.rotate(0,0,-c).translate(w.cx,w.cy)),N.addPointA(C.cx,C.cy).addPointA(v.cx,v.cy).addSegArc2().addSegStrokeA(S.cx,S.cy),X.addPartial(N);const F=B(S.cx,S.cy).addSegStrokeA(v.cx,v.cy).addPointA(j.cx,j.cy).addPointA(O.cx,O.cy).addSegArc2();F.addPartial(g.rotate(0,0,c).translate(O.cx,O.cy)),F.addPointA(y.cx,y.cy).addSegArc(f+s.SE1,!1,!0);const W=B(y.cx,y.cy).addSegStrokeA(q.cx,q.cy).addSegStrokeA(M.cx,M.cy),K=B(S.cx,S.cy).addPartial(F).addPartial(W),z=B(d,0);if(s.orientation===2)for(let I=0;I<s.N2/2;I++){z.addPointAP(-2*I*t-2*a,d).addPointAP(-2*I*t-4*a,d).addSegArc2(),z.addCornerRounded(s.R7);const U=Math.PI/2-(2*I+2)*t,D=U+2*i;z.addPartial(F.rotate(0,0,D));const Y=N.rotate(0,0,U),E=Y.getFirstPoint();z.addCornerRounded(s.R7),z.addSegStrokeA(E.cx,E.cy),z.addCornerRounded(s.R7),z.addPartial(Y),z.addCornerRounded(s.R7)}else for(let I=0;I<s.N2;I++)z.addPointAP(-I*t-a,d).addPointAP(-I*t-2*a,d).addSegArc2().addCornerRounded(s.R7),s.orientation===0?z.addPartial(K.rotate(0,0,Math.PI/2-(I+1)*t+i)):s.orientation===1&&z.addPartial(X.rotate(0,0,Math.PI/2-(I+1)*t)),z.addCornerRounded(s.R7);return[e,z]}var Ds={partName:"vaxis_holder",params:[o("PHD1","mm",700,1,2e3,1),o("PHD2","mm",900,1,4e3,1),o("PHD5","mm",800,1,4e3,1),o("PHN1","holes",6,1,24,1),oe("screw holes"),o("PHD3","mm",40,1,100,1),o("PHR4","mm",40,1,100,1),o("PHL2","mm",120,1,400,1),o("PHR6","mm",20,0,400,1),oe("section"),o("PHE1","mm",10,1,80,1),o("PHH1","mm",50,1,200,1),o("PHA","degree",5,-45,45,.1),o("PHL1","mm",300,1,500,1),o("PHE2","mm",10,1,80,1),o("PHE3","mm",10,1,80,1),oe("for reuse"),ct("withOuterCone",!0)],paramSvg:{PHD1:"vaxis_holder_top.svg",PHD2:"vaxis_holder_top.svg",PHD5:"vaxis_holder_top.svg",PHD3:"vaxis_holder_top.svg",PHR4:"vaxis_holder_top.svg",PHN1:"vaxis_holder_top.svg",PHL2:"vaxis_holder_top.svg",PHR6:"vaxis_holder_top.svg",PHE1:"vaxis_holder_section.svg",PHH1:"vaxis_holder_section.svg",PHA:"vaxis_holder_section.svg",PHL1:"vaxis_holder_section.svg",PHE2:"vaxis_holder_section.svg",PHE3:"vaxis_holder_top.svg",withOuterCone:"vaxis_holder_section.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function sr(s,e,d=""){const t=be(Ds.partName+d),n=G(),i=G(),a=G(),r=G(),c=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const h=xe(e.PHA),l=e.PHD1/2,f=e.PHD2/2,_=e.PHD3/2,u=e.PHD5/2,g=f+e.PHL1/2*Math.sin(h),S=f-e.PHL1/2*Math.sin(h),L=e.PHL1*Math.cos(h),R=f-e.PHE2/Math.cos(h)+e.PHE1/2*Math.tan(h),v=f-e.PHE2/Math.cos(h)-e.PHE1/2*Math.tan(h),x=Math.min(R,v),C=(e.PHL1-e.PHE1/Math.cos(h))/2,T=f-e.PHE2/Math.cos(h);if(x<u)throw`err210: PHD5 ${e.PHD5} too large compare to PHE2 ${e.PHE2} or PHA ${e.PHA}`;t.logstr+=`vaxis_holder's height: ${p(L)} mm
`,t.logstr+=`vaxis_holder outerD1: ${p(2*g)} mm
`,t.logstr+=`vaxis_holder outerD2: ${p(2*S)} mm
`,t.logstr+=`vaxis_holder innerD: ${p(e.PHD1-2*e.PHR4)} mm
`,t.logstr+=`vaxis_holder D2-next: ${p(2*T)} mm
`;const w=function(D){const Y=u+(R-u)/2;return B(D*Y,-e.PHE1/2).addSegStrokeR(D*(R-Y),0).addSegStrokeRP(-Math.PI/2+D*h,C).addSegStrokeRP(-Math.PI/2+D*(Math.PI/2+h),e.PHE2).addSegStrokeRP(Math.PI/2+D*h,e.PHL1).addSegStrokeRP(Math.PI/2+D*(Math.PI/2+h),e.PHE2).addSegStrokeRP(-Math.PI/2+D*h,C).addSegStrokeA(D*Y,e.PHE1/2).closeSegStroke()},P=function(D){return B(D*x,-e.PHE1/2).addSegStrokeA(D*x,e.PHE1/2).addSegStrokeA(D*(l-e.PHR4),e.PHE1/2).addSegStrokeA(D*(l-e.PHR4),-e.PHE1/2).closeSegStroke()},M=function(D){return B(D*(l+_),-e.PHE1/2).addSegStrokeA(D*(l+_),e.PHE1/2).addSegStrokeA(D*(l-_),e.PHE1/2).addSegStrokeA(D*(l-_),-e.PHE1/2).closeSegStroke()};n.addMainO(w(1)),n.addSecond(w(-1)),n.addSecond(P(1)),n.addSecond(M(1)),n.addSecond(P(-1)),n.addSecond(M(-1));const b=function(D){return B(D*(l+e.PHR4),-e.PHE1/2).addSegStrokeA(D*R,-e.PHE1/2).addSegStrokeRP(-Math.PI/2+D*h,C).closeSegStroke()},j=function(D){return B(D*(l+e.PHR4),e.PHE1/2).addSegStrokeA(D*v,e.PHE1/2).addSegStrokeRP(Math.PI/2+D*h,C).addSegStrokeA(D*(l+e.PHR4),e.PHE1/2+e.PHH1).closeSegStroke()},O=function(D){const Y=ae(D*v,e.PHE1/2).translatePolar(Math.PI/2+D*h,C),E=ae(D*R,-e.PHE1/2).translatePolar(-Math.PI/2+D*h,C),Q=f-e.PHE2/2;return B(D*Q,0).addSegStrokeA(Y.cx,Y.cy).addSegStrokeA(D*(l+e.PHR4),e.PHE1/2+e.PHH1).addSegStrokeA(D*(l+e.PHR4),e.PHE1/2).addSegStrokeA(D*(l+e.PHR4),-e.PHE1/2).addSegStrokeA(E.cx,E.cy).closeSegStroke()};n.addSecond(b(-1)),n.addSecond(j(-1)),a.mergeFigure(n,!0),r.mergeFigure(n,!0),c.mergeFigure(n,!0),n.addSecond(b(1)),n.addSecond(j(1)),a.addMainO(b(1)),a.addSecond(j(1)),r.addSecond(b(1)),r.addMainO(j(1)),c.addMainO(O(1));const y=[];y.push($(0,0,x)),i.addSecond($(0,0,f)),i.addSecond($(0,0,Math.max(g,S)));const[q,X,N]=tr(e);t.logstr+=q,y.push(X);for(const D of N){const Y=ae(0,0).translatePolar(D,l);y.push($(Y.cx,Y.cy,e.PHD3/2))}const F=B(l+e.PHR4,-e.PHE3).addSegStrokeA(x,-e.PHE3).addSegStrokeA(x,e.PHE3).addSegStrokeA(l+e.PHR4,e.PHE3).closeSegStroke();for(const D of N)i.addSecond(F.rotate(0,0,D));i.addMainOI(y),t.fig={facePetal:i,faceOuter:n,faceButtress1:a,faceButtress2:r,faceButtress12:c};const W=t.partName,K=ts();K.addRotation(Math.PI/2,0,0),K.addTranslation(0,e.PHE3/2,0);const z=N.map((D,Y)=>{const E=ts(K.getMatrix());return E.addRotation(0,0,D),{outName:`subpax_${W}_b2_${Y}`,face:`${W}_faceButtress12`,extrudeMethod:se.eLinearOrtho,length:e.PHE3,rotate:E.getRotation(),translate:E.getTranslation()}}),I=N.map((D,Y)=>`subpax_${W}_b2_${Y}`),U=e.withOuterCone?[`subpax_${W}_outer`]:[];t.vol={extrudes:[{outName:`subpax_${W}_outer`,face:`${W}_faceOuter`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${W}_petal`,face:`${W}_facePetal`,extrudeMethod:se.eLinearOrtho,length:e.PHE1,rotate:[0,0,0],translate:[0,0,-e.PHE1/2]},...z],volumes:[{outName:`pax_${W}`,boolMethod:pe.eUnion,inList:[`subpax_${W}_petal`,...U,...I]}]},t.sub={},t.logstr+=`vaxis_holder drawn successfully!
`,t.calcErr=!1}catch(h){t.logstr+=h,console.log(h)}return t}var Jt={pTitle:"Heliostat vaxis_holder",pDescription:"The holders of the guidance mechanism for azimuth motion",pDef:Ds,pGeom:sr},Hs={partName:"pole_static",params:[o("D1","mm",1e3,20,4e3,1),o("D2","mm",700,10,4e3,1),o("D3","mm",800,10,4e3,1),o("H1","mm",3e3,10,4e4,10),o("H2","mm",7e3,50,4e4,10),oe("thickness"),o("E1","mm",30,1,80,1),o("E2","mm",5,1,80,1),oe("base holes"),o("N1","",32,3,100,1),o("D5","mm",40,1,100,1),o("L1","mm",45,1,300,1),oe("door"),o("D4","mm",600,1,1200,1),o("H3","mm",300,5,1200,1),o("H4","mm",1800,10,2500,1),o("L2","mm",30,1,100,1),o("E3","mm",40,1,100,1),oe("holders"),ct("holders",!0),o("PHL1A","mm",400,1,1e3,1),o("PHL1B","mm",400,1,1e3,1),o("PHB","mm",5e3,1,2e4,1),o("PHD1A","mm",600,1,4e3,1),o("PHD1B","mm",380,1,4e3,1),o("PHN1AB","petal",6,1,24,1),oe("holder-B"),o("PHD5B2","mm",600,1,4e3,1),o("PHD5B1","mm",600,1,4e3,1),o("PHR4B","mm",30,1,400,1),o("PHD3B","mm",40,1,400,1),o("PHL2B","mm",140,1,400,1),o("PHE3B","mm",10,1,50,1),o("PHR6B","mm",20,0,400,1),o("PHE1B","mm",10,1,50,1),o("PHH1B","mm",10,1,50,1),oe("holder-A"),o("PHD5A","mm",900,1,4e3,1),o("PHR4A","mm",30,1,400,1),o("PHD3A","mm",40,1,400,1),o("PHL2A","mm",200,1,400,1),o("PHE3A","mm",10,1,50,1),o("PHR6A","mm",20,0,400,1),o("PHE1A","mm",10,1,50,1),o("PHH1A","mm",10,1,50,1)],paramSvg:{D1:"pole_stator_cut.svg",D2:"pole_stator_cut.svg",D3:"pole_stator_cut.svg",H1:"pole_stator_cut.svg",H2:"pole_stator_cut.svg",E1:"pole_stator_cut.svg",E2:"pole_stator_E2.svg",N1:"pole_stator_bottom.svg",D5:"pole_stator_bottom.svg",L1:"pole_stator_bottom.svg",D4:"pole_stator_face.svg",H3:"pole_stator_face.svg",H4:"pole_stator_face.svg",L2:"pole_stator_face.svg",E3:"pole_stator_right.svg",holders:"pole_stator_holders.svg",PHL1A:"pole_stator_holders.svg",PHL1B:"pole_stator_holders.svg",PHB:"pole_stator_holders.svg",PHD1A:"pole_stator_holders.svg",PHD1B:"pole_stator_holders.svg",PHN1AB:"pole_stator_holderB_top.svg",PHD5A:"pole_stator_holderB_top.svg",PHR4A:"pole_stator_holderB_top.svg",PHD3A:"pole_stator_holderB_top.svg",PHL2A:"pole_stator_holderB_top.svg",PHE3A:"pole_stator_holderB_top.svg",PHR6A:"pole_stator_holderB_top.svg",PHE1A:"pole_stator_holderB_section.svg",PHH1A:"pole_stator_holderB_section.svg",PHD5B1:"pole_stator_holderB_top.svg",PHD5B2:"pole_stator_holderB_top.svg",PHR4B:"pole_stator_holderB_top.svg",PHD3B:"pole_stator_holderB_top.svg",PHL2B:"pole_stator_holderB_top.svg",PHE3B:"pole_stator_holderB_top.svg",PHR6B:"pole_stator_holderB_top.svg",PHE1B:"pole_stator_holderB_section.svg",PHH1B:"pole_stator_holderB_section.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function nr(s,e,d=""){const t=be(Hs.partName+d),n=G(),i=G(),a=G(),r=G(),c=G(),h=G(),l=G(),f=G(),_=G(),u=G(),g=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const S=e.D1/2,L=e.D2/2,R=e.D3/2,v=e.H1+e.H2,x=Math.atan2(S-L,e.H2),C=e.E2*Math.tan(x/2),T=e.H1-C,w=e.PHL1B/Math.cos(x),P=L+e.PHL1B/2*Math.tan(x),M=e.H1+e.H2-e.PHL1B/2,b=L+(e.PHL1B/2+e.PHB)*Math.tan(x),j=e.H1+e.H2-e.PHL1B/2-e.PHB,O=e.PHL1A/Math.cos(x),y=S-e.PHL1A/2*Math.tan(x),q=e.H1+e.PHL1A/2;if(L>S)throw`err091: D2 ${e.D2} is larger than D1 ${e.D1}`;if(R+e.E2>S)throw`err095: D3 ${e.D3} and E2 ${e.E2} are too large compare to D1 ${e.D1}`;if(e.holders){if(e.PHB<e.PHL1B)throw`err131: PHB ${e.PHB} is too small compare to PHL1B ${e.PHL1B}`;if(e.PHB>e.H2-e.PHL1B-e.PHL1A)throw`err132: PHB ${e.PHB} is too large compare to H2 ${e.H2}, PHL1B ${e.PHL1B} and PHL1A ${e.PHL1A}`}t.logstr+=`pole-height: ${p(v)} mm
`,t.logstr+=`cone-half-angle: ${p(Ce(x))} degree
`,t.logstr+=`holder position: A: ${p(q)}  B1: ${p(j)}  B2: ${p(M)} mm
`;const X=function(V){let Z=L-e.E2*Math.cos(x);return Z+=(v-e.E2*Math.sin(x)-V)*Math.tan(x),Z},N=function(V,Z){const ee=B(V*S,0).addSegStrokeA(V*S,e.H1).addSegStrokeA(V*L,v).addSegStrokeR(-V*e.E2*Math.cos(x),-e.E2*Math.sin(x));if(Z&&e.holders){const He=e.H1+e.PHL1A/2-e.PHE1A/2,Le=He+e.PHE1A,ye=v-e.PHL1B/2+e.PHE1B/2,fe=ye-e.PHE1B,ce=ye-e.PHB,Ie=ce-e.PHE1B;ee.addSegStrokeA(V*X(ye),ye).addSegStrokeA(V*(e.PHD1B/2-e.PHR4B),ye).addSegStrokeA(V*(e.PHD1B/2-e.PHR4B),fe).addSegStrokeA(V*X(fe),fe).addSegStrokeA(V*X(ce),ce).addSegStrokeA(V*(e.PHD1B/2-e.PHR4B),ce).addSegStrokeA(V*(e.PHD1B/2-e.PHR4B),Ie).addSegStrokeA(V*X(Ie),Ie).addSegStrokeA(V*X(Le),Le).addSegStrokeA(V*(e.PHD1A/2-e.PHR4A),Le).addSegStrokeA(V*(e.PHD1A/2-e.PHR4A),He).addSegStrokeA(V*X(He),He)}return ee.addSegStrokeA(V*(S-e.E2),T),Z?ee.addSegStrokeA(V*(S-e.E2),e.E1).addSegStrokeA(V*R,e.E1).addSegStrokeA(V*R,0):ee.addSegStrokeA(V*(S-e.E2),0),ee.closeSegStroke(),ee};n.addMainO(N(1,!1)),n.addSecond(N(1,!0)),n.addSecond(N(-1,!0));const F=e.D4/2,W=e.H4-2*F;if(W<0)throw`err121: H4 ${e.H4} is too small compare to D4 ${e.D4}`;if(F-e.L2<0)throw`err121: D4 ${e.D4} is too small compare to L2 ${e.L2}`;const K=function(V){const Z=F-V;return en(0,e.H3+F-Z,2*Z,W+2*Z,Math.PI/2)};i.addMainOI([K(0),K(e.L2)]);const z=B(S,0).addSegStrokeA(S,e.H1).addSegStrokeA(L,v).addSegStrokeA(-L,v).addSegStrokeA(-S,e.H1).addSegStrokeA(-S,0).closeSegStroke();i.addSecond(z);const I=B(-S,e.H3).addSegStrokeR(0,e.H4).addSegStrokeR(-e.E3,0).addSegStrokeR(0,-e.H4).closeSegStroke();i.addSecond(I);const U=[];U.push($(0,0,S)),U.push($(0,0,R));const D=R+e.L1,Y=2*Math.PI/e.N1;for(let V=0;V<e.N1;V++){const Z=D*Math.cos(V*Y),ee=D*Math.sin(V*Y);U.push($(Z,ee,e.D5/2))}a.addSecond($(0,0,L)),a.addSecond($(0,0,S-e.E2)),a.addMainOI(U),r.addMainOI([$(0,0,S+e.E3),$(0,0,S-e.E2)]),c.addMainO(K(e.L2));const E=t.partName,Q=[],ie=[];let J={};if(e.holders){const Z=ft(Jt.pDef,"B2");Z.setVal("PHD1",e.PHD1B),Z.setVal("PHD2",2*P),Z.setVal("PHD5",e.PHD5B2),Z.setVal("PHN1",e.PHN1AB),Z.setVal("PHD3",e.PHD3B),Z.setVal("PHR4",e.PHR4B),Z.setVal("PHL2",e.PHL2B),Z.setVal("PHR6",e.PHR6B),Z.setVal("PHE1",e.PHE1B),Z.setVal("PHH1",e.PHH1B),Z.setVal("PHA",Ce(x)),Z.setVal("PHL1",w),Z.setVal("PHE2",e.E2),Z.setVal("PHE3",e.PHE3B),Z.setVal("withOuterCone",1);const ee=Jt.pGeom(0,Z.getParamVal(),Z.getSuffix());vt(ee),t.logstr+=St(ee.logstr,Z.getPartNameSuffix()),h.mergeFigure(ee.fig.faceOuter),l.mergeFigure(ee.fig.facePetal);const He={outName:`inpax_${E}_hB2`,subdesign:"pax_vaxis_holderB2",subgeom:ee,rotate:[0,0,0],translate:[0,0,M]};Q.push(He),ie.push(`inpax_${E}_hB2`);const Le=ft(Jt.pDef,"B1");Le.setVal("PHD1",e.PHD1B),Le.setVal("PHD2",2*b),Le.setVal("PHD5",e.PHD5B1),Le.setVal("PHN1",e.PHN1AB),Le.setVal("PHD3",e.PHD3B),Le.setVal("PHR4",e.PHR4B),Le.setVal("PHL2",e.PHL2B),Le.setVal("PHR6",e.PHR6B),Le.setVal("PHE1",e.PHE1B),Le.setVal("PHH1",e.PHH1B),Le.setVal("PHA",Ce(x)),Le.setVal("PHL1",w),Le.setVal("PHE2",e.E2),Le.setVal("PHE3",e.PHE3B),Le.setVal("withOuterCone",1);const ye=Jt.pGeom(0,Le.getParamVal(),Le.getSuffix());vt(ye),t.logstr+=St(ye.logstr,Le.getPartNameSuffix()),f.mergeFigure(ye.fig.faceOuter),_.mergeFigure(ye.fig.facePetal);const fe={outName:`inpax_${E}_hB1`,subdesign:"pax_vaxis_holderB1",subgeom:ye,rotate:[0,0,0],translate:[0,0,j]};Q.push(fe),ie.push(`inpax_${E}_hB1`);const ce=ft(Jt.pDef,"A");ce.setVal("PHD1",e.PHD1A),ce.setVal("PHD2",2*y),ce.setVal("PHD5",e.PHD5A),ce.setVal("PHN1",e.PHN1AB),ce.setVal("PHD3",e.PHD3A),ce.setVal("PHR4",e.PHR4A),ce.setVal("PHL2",e.PHL2A),ce.setVal("PHR6",e.PHR6A),ce.setVal("PHE1",e.PHE1A),ce.setVal("PHH1",e.PHH1A),ce.setVal("PHA",Ce(x)),ce.setVal("PHL1",O),ce.setVal("PHE2",e.E2),ce.setVal("PHE3",e.PHE3A),ce.setVal("withOuterCone",1);const Ie=Jt.pGeom(0,ce.getParamVal(),ce.getSuffix());vt(Ie),t.logstr+=St(Ie.logstr,ce.getPartNameSuffix()),u.mergeFigure(Ie.fig.faceOuter),g.mergeFigure(Ie.fig.facePetal);const We={outName:`inpax_${E}_hA`,subdesign:"pax_vaxis_holderA",subgeom:Ie,rotate:[0,0,0],translate:[0,0,q]};Q.push(We),ie.push(`inpax_${E}_hA`),J={vaxis_holder_B2:{partName:Z.getPartName(),dparam:Z.getDesignParamList(),orientation:[0,0,0],position:[0,0,M]},vaxis_holder_B1:{partName:Le.getPartName(),dparam:Le.getDesignParamList(),orientation:[0,0,0],position:[0,0,j]},vaxis_holder_A:{partName:ce.getPartName(),dparam:ce.getDesignParamList(),orientation:[0,0,0],position:[0,0,q]}}}t.fig={poleCut:n,poleFace:i,poleBottom:a,emptyPole:r,emptyDoor:c,holderB2Section:h,holderB2Top:l,holderB1Section:f,holderB1Top:_,holderASection:u,holderATop:g},t.vol={inherits:Q,extrudes:[{outName:`subpax_${E}_pole`,face:`${E}_poleCut`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${E}_bottom`,face:`${E}_poleBottom`,extrudeMethod:se.eLinearOrtho,length:e.E1,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${E}_door`,face:`${E}_poleFace`,extrudeMethod:se.eLinearOrtho,length:S+e.E3,rotate:[Math.PI/2,0,0],translate:[0,0,0]},{outName:`subpax_${E}_emptyPole`,face:`${E}_emptyPole`,extrudeMethod:se.eLinearOrtho,length:e.H1,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${E}_emptyDoor`,face:`${E}_emptyDoor`,extrudeMethod:se.eLinearOrtho,length:S+e.E3+10,rotate:[Math.PI/2,0,0],translate:[0,0,0]}],volumes:[{outName:`ipax_${E}_door`,boolMethod:pe.eIntersection,inList:[`subpax_${E}_door`,`subpax_${E}_emptyPole`]},{outName:`ipax_${E}_pole`,boolMethod:pe.eSubstraction,inList:[`subpax_${E}_pole`,`subpax_${E}_emptyDoor`]},{outName:`pax_${E}`,boolMethod:pe.eUnion,inList:[`ipax_${E}_pole`,`subpax_${E}_bottom`,`ipax_${E}_door`,...ie]}]},t.sub=J,t.logstr+=`pole_static drawn successfully!
`,t.calcErr=!1}catch(S){t.logstr+=S,console.log(S)}return t}var xo={pTitle:"Heliostat pole static",pDescription:"The vertical pole of an heliostat",pDef:Hs,pGeom:nr},ks={partName:"rake",params:[o("D1","mm",600,10,4e3,1),o("D2","mm",400,10,4e3,1),o("D3","mm",400,10,4e3,1),o("H1","mm",800,1,4e3,1),o("H2","mm",3e3,20,6e3,1),o("H3","mm",400,0,4e3,1),o("E1","mm",20,1,80,1),o("E3","mm",30,1,80,1),oe("transversal"),o("H4","mm",400,10,1e3,1),o("D4","mm",300,10,1e3,1),o("E4","mm",20,1,80,1),o("H5","mm",1e3,10,2e3,1),o("D5","mm",200,1,1e3,1),o("L4","mm",300,1,1e3,1),o("L5","mm",2e3,10,4e3,1),o("L6","mm",2e3,1,4e3,1),o("D8","mm",400,1,1e3,1),oe("diagonal"),o("D6","mm",100,1,600,1),o("E6","mm",10,1,80,1),o("L7","mm",100,1,1e3,1),o("L8","mm",200,1,1e3,1),oe("base"),o("N1","",24,3,100,1),o("D7","mm",40,1,100,1),o("L1","mm",30,1,300,1),oe("door"),o("H6","mm",100,1,1e3,1),o("H7","mm",600,10,2e3,1),o("L9","mm",300,1,1e3,1),o("R9","mm",50,0,300,1),o("doorOrientation","degree",0,-180,180,1)],paramSvg:{D1:"rake_face.svg",D2:"rake_side.svg",D3:"rake_face.svg",H1:"rake_face.svg",H2:"rake_face.svg",H3:"rake_face.svg",E1:"rake_face.svg",E3:"rake_face.svg",H4:"rake_side.svg",D4:"rake_side.svg",E4:"rake_side.svg",H5:"rake_side.svg",D5:"rake_side.svg",L4:"rake_face.svg",L5:"rake_face.svg",L6:"rake_face.svg",D6:"rake_face.svg",E6:"rake_face.svg",L7:"rake_face.svg",L8:"rake_face.svg",N1:"rake_top.svg",D7:"rake_top.svg",L1:"rake_top.svg",D8:"rake_side.svg",H6:"rake_door.svg",H7:"rake_door.svg",L9:"rake_door.svg",R9:"rake_door.svg",doorOrientation:"rake_door.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function rr(s,e,d=""){const t=be(ks.partName+d),n=G(),i=G(),a=G(),r=G(),c=G(),h=G(),l=G(),f=G(),_=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const g=Math.PI/2,S=-Math.PI/2,L=e.D1/2,R=e.D2/2,v=e.D3/2,x=e.D4/2,C=e.D5/2,T=e.D6/2,w=e.D7/2,P=e.D8/2,M=e.D4-2*e.E4,b=e.H1+e.H2,j=b-e.H4+e.H5,O=4*e.L4+e.L5+2*e.L6,y=e.H1+e.H2-e.H4,q=x*Math.cos(Math.PI/6),X=x*Math.sin(Math.PI/6),N=C*Math.cos(Math.PI/6),F=C*Math.sin(Math.PI/6),W=P*Math.cos(Math.PI/6),K=P*Math.sin(Math.PI/6),z=[-O/2,-e.L5/2-e.L4,e.L5/2,O/2-e.L4],I=e.H2-e.L8-e.H4-x,U=Math.atan2(L-R,e.H2),D=O/2-e.L7-L+e.L8*Math.tan(U),Y=Math.sqrt(D**2+I**2),E=Math.atan2(D,I),Q=e.E1/Math.sin(E+U),ie=Y+e.E4/Math.cos(E)+Q,J=L-e.L8*Math.tan(U)-Q*Math.sin(E),V=e.H1+e.L8-Q*Math.cos(E),Z=J-T*Math.cos(E),ee=V+T*Math.sin(E),He=T-e.E6,Le=J-e.E6*Math.cos(E),ye=V+e.E6*Math.sin(E),fe=Math.PI/2-E,ce=e.L9/2,Ie=ce-e.H7*Math.tan(U);if(e.D2>e.D1)throw`err110: D2 ${e.D2} is larger than D1 ${e.D1}`;if(e.D3+e.E1>e.D1)throw`err113: D3 ${e.D3} is too large compare to D1 ${e.D1} and E1 ${e.E1}`;if(e.H3+e.E3>e.H1)throw`err116: H3 ${e.H3} is too large compare to H1 ${e.H1} and E3 ${e.E3}`;if(e.H4+x>e.H2)throw`err119: H4 ${e.H4} is too large compare to H2 ${e.H2} and D4 ${e.D4}`;if(e.E4>x)throw`err122: E4 ${e.E4} is too large compare to D4 ${e.D4}`;if(e.D8<=e.D5)throw`err146: D8 ${e.D8} is too small compare to D5 ${e.D5}`;if(I<0)throw`err140: H2 ${e.H2} too small compare to L8 ${e.L8}, H4 ${e.H4} and D4 ${e.D4}`;if(Ie<e.R9)throw`err177: R9 ${e.R9} too large compare to doorHighX ${Ie} and L9 ${e.L9}`;if(e.L9>e.D1)throw`err180: L9 ${e.L9} too large compare to D1 ${e.D1}`;if(e.E6>e.D6/2)throw`err197: E6 ${e.E6} is too large compare to D6 ${e.D6}`;t.logstr+=`rake-L4: ${p(e.L4)} mm (compare with swing)
`,t.logstr+=`rake-L5: ${p(e.L5)} mm (compare with swing)
`,t.logstr+=`rake-L6: ${p(e.L6)} mm (compare with swing)
`,t.logstr+=`rake-beamL (4*L4+L5+2*L6): ${p(O)} mm (compare with swing)
`,t.logstr+=`cone-height: ${p(b)} mm
`,t.logstr+=`cone-height total: ${p(j)} mm
`,t.logstr+=`cone-angle: ${p(Ce(U))} degree
`,t.logstr+=`wing-angle: ${p(Ce(E))} degree
`;const We=e.E1*Math.cos(U),et=e.E1*Math.sin(U),le=e.E1*Math.tan(U/2),qt=function(ke){return B(ke*L,0).addSegStrokeA(ke*L,e.H1).addSegStrokeA(ke*R,b).addSegStrokeA(ke*(R-We),b-et).addSegStrokeA(ke*(L-e.E1),e.H1-le).addSegStrokeA(ke*(L-e.E1),0).closeSegStroke()},at=function(ke){return B(ke*L,0).addSegStrokeA(ke*L,e.H1).addSegStrokeA(ke*R,b).addSegStrokeA(ke*(R-We),b-et).addSegStrokeA(ke*(L-e.E1),e.H1-le).addSegStrokeA(ke*(L-e.E1),e.H1-e.H3).addSegStrokeA(ke*v,e.H1-e.H3).addSegStrokeA(ke*v,e.H1-e.H3-e.E3).addSegStrokeA(ke*(L-e.E1),e.H1-e.H3-e.E3).addSegStrokeA(ke*(L-e.E1),0).closeSegStroke()},It=y-x-(e.H1-le),Mt=L-e.E1-Math.tan(U)*It,Xt=B(0,y-x).addSegStrokeA(Mt,y-x).addSegStrokeA(L-e.E1,e.H1-le).addSegStrokeA(L-e.E1,e.H1-e.H3).addSegStrokeA(0,e.H1-e.H3).closeSegStroke(),kt=tn(-ce,e.H1+e.H6,e.L9,2*Ie,e.H7,e.R9);n.addMainO(qt(1)),n.addSecond(at(1)),n.addSecond(at(-1)),n.addSecond(ge(-O/2,y,O,e.D4,0)),n.addSecond(ge(-O/2,y,O,M,0));for(const ke of z)n.addSecond(Oe(ke,y+X,e.L4,e.H5-X-F));n.addSecond(Ct(J,V,ie,2*T,fe)),n.addSecond(Ct(Le,ye,ie,2*He,fe)),n.addSecond(Ct(-J,V,2*T,ie,E)),n.addSecond(Ct(-Le,ye,2*He,ie,E)),n.addSecond(kt),i.mergeFigure(n,!0),i.addMainO(Xt);const xt=[],Pt=B(q,y+X).addSegStrokeA(W,y+e.H5-K).addSegStrokeA(N,y+e.H5-F).addPointA(-N,y+e.H5-F).addSegArc(C,!1,!1).addSegStrokeA(-W,y+e.H5-K).addSegStrokeA(-q,y+X).closeSegArc(x,!1,!1);xt.push($(0,y,x)),xt.push($(0,y,x-e.E4)),a.addSecond(at(1)),a.addSecond(at(-1)),a.addSecond(Pt),a.addSecond($(0,y+e.H5,C)),a.addSecond(ge(0,e.H1+e.L8,I,2*T,g)),a.addSecond(ge(0,e.H1+e.L8,I,2*He,g)),a.addSecond(kt),a.addMainOI(xt),r.addMainO($(0,y,x-e.E4)),r.addSecond($(0,y,x)),r.addSecond(Pt);const yt=[];yt.push($(0,0,L)),yt.push($(0,0,v));const mt=v+e.L1,pt=2*Math.PI/e.N1;for(let ke=0;ke<e.N1;ke++){const te=mt*Math.cos(ke*pt),ne=mt*Math.sin(ke*pt);yt.push($(te,ne,w))}c.addSecond($(0,0,L-e.E1)),c.addSecond($(0,0,R)),c.addSecond(ge(0,-O/2,O,e.D4,g)),c.addSecond(ge(0,-O/2,O,M,g));for(const ke of z)c.addSecond(ge(0,ke,e.L4,2*q,g)),c.addSecond(ge(0,ke,e.L4,2*N,g)),c.addSecond(ge(0,ke,e.L4,2*W,g));const gt=L-e.L8*Math.tan(U);c.addSecond(ge(0,gt,D,2*T,g)),c.addSecond(ge(0,gt,D,2*He,g)),c.addSecond(ge(0,-gt,D,2*T,S)),c.addSecond(ge(0,-gt,D,2*He,S)),c.addMainOI(yt),h.addMainO(Pt),h.addSecond($(0,y,x)),h.addSecond($(0,y,x-e.E4)),h.addSecond($(0,y+e.H5,C));const bt=[];bt.push($(0,0,T)),bt.push($(0,0,He)),l.addMainOI(bt),f.addSecond($(0,0,T)),f.addMainO($(0,0,He)),_.addMainO(kt),_.addSecond(at(1)),_.addSecond(at(-1)),_.addSecond(ge(-O/2,y,O,e.D4,0)),_.addSecond(ge(-O/2,y,O,M,0));for(const ke of z)_.addSecond(Oe(ke,y+X,e.L4,e.H5-X-F));_.addSecond(Ct(J,V,ie,2*T,fe)),_.addSecond(Ct(Le,ye,ie,2*He,fe)),_.addSecond(Ct(-J,V,2*T,ie,E)),_.addSecond(Ct(-Le,ye,2*He,ie,E)),t.fig={faceCone:n,faceConeHollow:i,faceBeam:a,faceBeamHollow:r,faceDisc:c,faceHand:h,faceWing:l,faceWingHollow:f,faceDoor:_};const Se=t.partName,Yt=z.map((ke,te)=>({outName:`subpax_${Se}_hand_${te}`,face:`${Se}_faceHand`,extrudeMethod:se.eLinearOrtho,length:e.L4,rotate:[Math.PI/2,0,0],translate:[0,-ke,0]}));t.vol={extrudes:[{outName:`subpax_${Se}_cone`,face:`${Se}_faceCone`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${Se}_coneHollow`,face:`${Se}_faceConeHollow`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${Se}_beam`,face:`${Se}_faceBeam`,extrudeMethod:se.eLinearOrtho,length:O,rotate:[Math.PI/2,0,0],translate:[0,O/2,0]},{outName:`subpax_${Se}_beamHollow`,face:`${Se}_faceBeamHollow`,extrudeMethod:se.eLinearOrtho,length:O,rotate:[Math.PI/2,0,0],translate:[0,O/2,0]},{outName:`subpax_${Se}_disc`,face:`${Se}_faceDisc`,extrudeMethod:se.eLinearOrtho,length:e.E3,rotate:[0,0,0],translate:[0,0,e.H1-e.H3-e.E3]},{outName:`subpax_${Se}_wing_right`,face:`${Se}_faceWing`,extrudeMethod:se.eLinearOrtho,length:ie,rotate:[-E,0,0],translate:[0,Z,ee]},{outName:`subpax_${Se}_wing_left`,face:`${Se}_faceWing`,extrudeMethod:se.eLinearOrtho,length:ie,rotate:[E,0,0],translate:[0,-Z,ee]},{outName:`subpax_${Se}_wing_hollow_right`,face:`${Se}_faceWingHollow`,extrudeMethod:se.eLinearOrtho,length:ie,rotate:[-E,0,0],translate:[0,Z,ee]},{outName:`subpax_${Se}_wing_hollow_left`,face:`${Se}_faceWingHollow`,extrudeMethod:se.eLinearOrtho,length:ie,rotate:[E,0,0],translate:[0,-Z,ee]},{outName:`subpax_${Se}_door`,face:`${Se}_faceDoor`,extrudeMethod:se.eLinearOrtho,length:e.D1,rotate:[Math.PI/2,0,-Math.PI/2+xe(e.doorOrientation)],translate:[0,0,0]},...Yt],volumes:[{outName:`ipax_${Se}_plus`,boolMethod:pe.eUnion,inList:[`subpax_${Se}_cone`,`subpax_${Se}_beam`,`subpax_${Se}_disc`,`subpax_${Se}_hand_0`,`subpax_${Se}_hand_1`,`subpax_${Se}_hand_2`,`subpax_${Se}_hand_3`,`subpax_${Se}_wing_right`,`subpax_${Se}_wing_left`]},{outName:`ipax_${Se}_hollow`,boolMethod:pe.eUnion,inList:[`subpax_${Se}_coneHollow`,`subpax_${Se}_beamHollow`,`subpax_${Se}_wing_hollow_right`,`subpax_${Se}_wing_hollow_left`,`subpax_${Se}_door`]},{outName:`pax_${Se}`,boolMethod:pe.eSubstraction,inList:[`ipax_${Se}_plus`,`ipax_${Se}_hollow`]}]},t.sub={},t.logstr+=`heliostat-rake drawn successfully!
`,t.calcErr=!1}catch(u){t.logstr+=u,console.log(u)}return t}var Po={pTitle:"Heliostat rake",pDescription:"The rake on top of the V-Axis of the heliostat",pDef:ks,pGeom:rr},Jo={partName:"spider",params:[o("D1","mm",100,1,400,1),o("L1","mm",400,1,1e3,1),o("L2","mm",400,1,1e3,1),o("L3","mm",100,1,400,1),o("L4","mm",3e3,10,8e3,10),oe("longitude"),o("L5","mm",2e3,1,8e3,1),o("N1","",6,1,20,1),o("L6","mm",30,1,100,1),oe("thickness"),o("E1","mm",3,1,80,1),o("E2","mm",50,1,200,1),o("E3","mm",3,1,80,1),o("R2","mm",100,0,400,10)],paramSvg:{D1:"spider_profile.svg",L1:"spider_profile.svg",L2:"spider_profile.svg",L3:"spider_profile.svg",L4:"spider_profile.svg",L5:"spider_lateral.svg",L6:"spider_lateral.svg",E1:"spider_profile.svg",E2:"spider_profile.svg",E3:"spider_profile.svg",R2:"spider_profile.svg",N1:"spider_lateral.svg"},sim:{tMax:360,tStep:.5,tUpdate:500}};function ar(s,e,d=""){const t=be(Jo.partName+d);let n,i;const a=G(),r=G(),c=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const h=e.D1/2;if(e.D1<e.E2)throw`err476: D1 ${e.D1} smaller then E2 ${e.E2}`;const l=e.E2/2,f=Math.sqrt(h**2-l**2),_=e.L1+e.L2*Math.sqrt(2),u=e.L2+e.L1*Math.sqrt(2),g=e.L4-u;if(g<e.R2)throw`err984: L4 ${e.L4} too small compare to R2 ${e.R2}`;const S=g*Math.cos(Math.PI/4),L=g*Math.sin(Math.PI/4),R=e.E2*Math.cos(Math.PI/4),v=e.E2*Math.sin(Math.PI/4),x=e.E2*Math.tan(Math.PI/8);if(h<e.E1)throw`err092: D1 ${e.D1} too small compare to E1 ${e.E1}`;if(e.L3<e.E2)throw`err994: L3 ${e.L3} smaller than E2 ${e.E2}`;if(e.L3<2*e.E3)throw`err997: L3 ${e.L3} too small compare to E3 ${e.E3}`;const C=(e.L3-e.E2)/2*Math.cos(Math.PI/4),T=_+S+C,w=-e.L1-L+C,P=w-e.E3*Math.sqrt(2);if(e.L5<e.N1*e.L6)throw`err110: L5 ${e.L5} too small compare to N1 ${e.N1} and L6 ${e.L6}`;let M=1;e.N1>1&&(M=(e.L5-e.L6)/(e.N1-1));const b=[...Array(e.N1).keys()].map(F=>F*M);n=function(F,W,K){return B(F,W).addSegStrokeA(F+K*Math.cos(Math.PI/4),W-K*Math.sin(Math.PI/4)).addSegStrokeA(F,W-2*K*Math.sin(Math.PI/4)).addSegStrokeA(F-K*Math.cos(Math.PI/4),W-K*Math.sin(Math.PI/4)).closeSegStroke()},i=function(F,W,K,z){return B(K,z).addSegStrokeA(K+F,z).addSegStrokeA(K+F,z+W).addSegStrokeA(K,z+W).closeSegStroke()};const j=Math.sin(2*Math.PI*s/Jo.sim.tMax)*Math.PI/2;t.logstr+=`spide leg number: ${e.N1}
`,t.logstr+=`spide position angle: ${p(Ce(j))} degree
`;const O=[],y=B(l,-f).addCornerRounded(e.R2).addSegStrokeA(l,-e.L1).addCornerRounded(e.R2).addSegStrokeA(_,-e.L1).addCornerRounded(e.R2+e.E2).addSegStrokeA(_+S,-e.L1-L).addSegStrokeA(_+S-R,-e.L1-L-v).addSegStrokeA(_-x,-e.L1-e.E2).addCornerRounded(e.R2).addSegStrokeA(-_+x,-e.L1-e.E2).addCornerRounded(e.R2).addSegStrokeA(-_-S+R,-e.L1-L-v).addSegStrokeA(-_-S,-e.L1-L).addSegStrokeA(-_,-e.L1).addCornerRounded(e.R2+e.E2).addSegStrokeA(-l,-e.L1).addCornerRounded(e.R2).addSegStrokeA(-l,-f).addCornerRounded(e.R2).closeSegArc(h,!0,!1);O.push(y),O.push($(0,0,h-e.E1)),a.addSecond(n(T,w,e.L3)),a.addSecond(n(T,P,e.L3-2*e.E3)),a.addSecond(n(-T,w,e.L3)),a.addSecond(n(-T,P,e.L3-2*e.E3)),a.addMainOI(O),r.addMainOI([$(0,0,h),$(0,0,h-e.E1)]),r.addMainOI([n(T,w,e.L3),n(T,P,e.L3-2*e.E3)]),r.addMainOI([n(-T,w,e.L3),n(-T,P,e.L3-2*e.E3)]),r.addSecond(y),c.addSecond(i(e.L5,e.D1,0,-e.D1/2)),c.addSecond(i(e.L5,e.L3,0,-e.L4-e.L3));for(const F of b)c.addSecond(i(e.L6,e.L4,F,-e.L4));t.fig={faceLegs:a.rotate(0,0,j),faceTube:r.rotate(0,0,j),faceBody:c};const q=t.partName,X=b.map((F,W)=>({outName:`subpax_${q}_leg_${W}`,face:`${q}_faceLegs`,extrudeMethod:se.eLinearOrtho,length:e.L6,rotate:[0,0,0],translate:[0,0,F]})),N=b.map((F,W)=>`subpax_${q}_leg_${W}`);t.vol={extrudes:[{outName:`subpax_${q}_tube`,face:`${q}_faceTube`,extrudeMethod:se.eLinearOrtho,length:e.L5,rotate:[0,0,0],translate:[0,0,0]},...X],volumes:[{outName:`pax_${q}`,boolMethod:pe.eUnion,inList:[`subpax_${q}_tube`,...N]}]},t.sub={},t.logstr+=`heliostat-spider drawn successfully!
`,t.calcErr=!1}catch(h){t.logstr+=h,console.log(h)}return t}var Uo={pTitle:"Heliostat spider",pDescription:"The spider part for the control of the inclination of the heliostat",pDef:Jo,pGeom:ar},ms={partName:"swing",params:[o("L1","mm",12500,100,4e4,1),o("L2","mm",6e3,100,4e4,1),oe("radial"),o("D1","mm",400,1,1e3,1),o("E1","mm",5,1,80,1),o("H2","mm",100,1,400,1),o("H4","mm",100,1,400,1),o("E2","mm",3,1,80,1),o("L3","mm",500,1,4e3,1),oe("longitudinal"),o("L4","mm",600,1,4e3,1),o("L5","mm",2e3,1,1e4,1),o("L6","mm",2e3,1,1e4,1),o("H1","mm",100,1,400,1),o("H3","mm",100,1,400,1),o("E3","mm",3,1,80,1),oe("buttress"),o("S1","mm",300,0,3e3,1),o("S2","mm",10,0,2e3,1),o("R2","mm",100,0,1e3,1),oe("rod overlay"),o("rod1","",10,1,40,1),o("rod2","mm",1300,10,4e3,1),o("rod3","mm",400,10,1e3,1),o("rod4","mm",100,1,400,1)],paramSvg:{L1:"swing_top.svg",L2:"swing_top.svg",L3:"swing_top.svg",L4:"swing_top.svg",L5:"swing_top.svg",L6:"swing_top.svg",D1:"swing_top.svg",H1:"swing_top.svg",H2:"swing_top.svg",H3:"swing_side.svg",H4:"swing_side.svg",E1:"swing_side.svg",E2:"swing_side.svg",E3:"swing_face.svg",S1:"swing_buttress.svg",S2:"swing_buttress.svg",R2:"swing_buttress.svg",rod1:"swing_with_rod.svg",rod2:"swing_with_rod.svg",rod3:"swing_with_rod.svg",rod4:"swing_with_rod.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function ir(s,e,d=""){const t=be(ms.partName+d),n=G(),i=G(),a=G(),r=G(),c=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const h=e.D1/2,l=h+e.S2,f=4*e.L4+e.L5+2*e.L6-2*e.H1,_=e.L4-2*e.H1,u=e.L5+2*e.H1,g=e.L6+2*e.H1;t.logstr+=`swing size: L1 ${p(e.L1)} x L2 ${p(e.L2)} mm
`,t.logstr+=`rake-L4: ${p(_)} mm (compare with rake)
`,t.logstr+=`rake-L5: ${p(u)} mm (compare with rake)
`,t.logstr+=`rake-L6: ${p(g)} mm (compare with rake)
`,t.logstr+=`rake-beamL: (4*L4+L5+2*L6-2*H1) ${p(f)} mm (compare with rake)
`,n.addMainOI([$(0,0,h),$(0,0,h-e.E1)]);const S=[-e.L2/2,-e.L3-e.H2,e.L3,e.L2/2-e.H2];for(const N of S)n.addMainOI([Oe(N,l-e.H4,e.H2,e.H4),Oe(N+e.E2,l-e.H4+e.E2,e.H2-2*e.E2,e.H4-2*e.E2)]);n.addSecond(Oe(-e.L2/2,l,e.L2,e.H3));const L=[];L.push(-e.L1/2),L.push(e.L1/2-e.H1);for(const N of[-e.L5/2-2*e.L4-e.L6,-e.L5/2-e.L4,e.L5/2,e.L5/2+e.L4+e.L6])for(const F of[0,e.L4-e.H1])L.push(N+F);for(const N of L)i.addMainOI([Oe(N,l,e.H1,e.H3),Oe(N+e.E3,l+e.E3,e.H1-2*e.E3,e.H3-2*e.E3)]);i.addSecond(Oe(-e.L1/2,-h,e.L1,e.D1)),i.addSecond(Oe(-e.L1/2,l-e.H4,e.L1,e.H4));for(const N of L)a.addSecond(Oe(N,-e.L2/2,e.H1,e.L2));for(const N of S)a.addSecond(Oe(-e.L1/2,N,e.L1,e.H2));a.addSecond(Oe(-e.L1/2,-h,e.L1,e.D1));const R=Math.sqrt(l**2+e.S1**2),v=Math.acos(h/R),x=Math.atan2(e.S1,l),C=ae(0,0),w=C.translatePolar(Math.PI/2+x,h).rotate(C,v),P=B(-e.L3,l).addSegStrokeA(-e.S1,l).addCornerRounded(e.R2).addSegStrokeA(w.cx,w.cy).addPointA(0,-h).addPointA(-w.cx,w.cy).addSegArc2().addSegStrokeA(e.S1,l).addCornerRounded(e.R2).addSegStrokeA(e.L3,l).addSegStrokeA(e.L3,l+e.E3).addSegStrokeA(-e.L3,l+e.E3).closeSegStroke();r.addMainOI([P,$(0,0,h-e.E1)]),n.addSecond(P);for(const N of L)c.addMainO(Oe(N,-e.L2/2,e.H1,e.L2));for(const N of S)c.addMainO(Oe(-e.L1/2,N,e.L1,e.H2));c.addMainO(Oe(-e.L1/2,-h,e.L1,e.D1));const M=-((e.rod1-1)*e.rod2+e.rod3)/2,b=(e.rod3-e.rod4)/2,j=e.rod3/2,O=1.2*e.L2,y=(O-j)/3,q=-O/2;for(let N=0;N<e.rod1;N++){const F=M+N*e.rod2;c.addSecond(Oe(F+b,q,e.rod4,O));for(let W=0;W<4;W++)c.addSecond(Oe(F,q+W*y,e.rod3,j,j/4))}t.fig={faceSide:n,faceFace:i,faceTop:a,faceButtress:r,faceTopWithRods:c};const X=t.partName;t.vol={extrudes:[{outName:`subpax_${X}_side`,face:`${X}_faceSide`,extrudeMethod:se.eLinearOrtho,length:e.L1,rotate:[0,0,0],translate:[0,0,-e.L1/2]},{outName:`subpax_${X}_face`,face:`${X}_faceFace`,extrudeMethod:se.eLinearOrtho,length:e.L2,rotate:[0,Math.PI/2,0],translate:[-e.L2/2,0,0]},...L.map((N,F)=>({outName:`subpax_${X}_buttress_${F}`,face:`${X}_faceButtress`,extrudeMethod:se.eLinearOrtho,length:e.H1,rotate:[0,0,0],translate:[0,0,N]}))],volumes:[{outName:`pax_${X}`,boolMethod:pe.eUnion,inList:[`subpax_${X}_side`,`subpax_${X}_face`,...L.map((N,F)=>`subpax_${X}_buttress_${F}`)]}]},t.sub={},t.logstr+=`heliostat-swing drawn successfully!
`,t.calcErr=!1}catch(h){t.logstr+=h,console.log(h)}return t}var Do={pTitle:"Heliostat swing",pDescription:"The swing for the heliostat inclination",pDef:ms,pGeom:ir},Wo={partName:"heliostat",params:[o("H1","mm",3e3,10,4e4,1),o("H2","mm",2500,50,4e4,1),o("D1","mm",1e3,20,4e3,1),o("D2","mm",700,20,4e3,1),o("E1","mm",30,1,80,1),oe("rake"),o("H3","mm",200,1,500,1),o("H4","mm",800,1,4e3,1),o("H5","mm",3e3,50,6e3,1),o("H6","mm",200,1,4e3,1),o("H7","mm",800,1,4e3,1),o("H8","mm",200,1,4e3,1),o("D3","mm",900,20,4e3,1),o("D4","mm",400,20,4e3,1),o("D5","mm",300,20,1e3,1),o("D6","mm",200,10,1e3,1),o("D7","mm",400,10,1e3,1),oe("rake diagonal"),o("D9","mm",100,1,1e3,1),o("L7","mm",100,1,1e3,1),o("L8","mm",200,1,1e3,1),oe("spider"),o("D8","mm",100,1,1e3,1),o("S1","mm",250,1,800,1),o("S2","mm",200,1,800,1),o("E2","mm",50,1,80,1),oe("swing"),o("L1","mm",12500,100,4e4,1),o("L2","mm",6e3,100,4e4,1),o("L3","mm",100,1,500,1),o("L4","mm",600,1,4e3,1),o("L5","mm",2e3,10,6e3,1),o("L6","mm",2e3,1,6e3,1),o("H9","mm",100,1,400,1),oe("motion amplitude"),o("al","degree",80,0,95,1),o("ar","degree",80,0,95,1)],paramSvg:{H1:"heliostat_overview.svg",H2:"heliostat_side.svg",H3:"heliostat_side_sizing.svg",H4:"heliostat_side_sizing.svg",H5:"heliostat_side_sizing.svg",H6:"heliostat_side_sizing.svg",H7:"heliostat_side_sizing.svg",H8:"heliostat_side_sizing.svg",H9:"heliostat_side_sizing.svg",D1:"heliostat_side_sizing.svg",D2:"heliostat_side_sizing.svg",D3:"heliostat_side_sizing.svg",D4:"heliostat_side_sizing.svg",D5:"heliostat_side_sizing.svg",D6:"heliostat_side_sizing.svg",D7:"heliostat_side_sizing.svg",D8:"heliostat_side_sizing.svg",D9:"heliostat_face_sizing.svg",S1:"heliostat_side_sizing.svg",S2:"heliostat_side_sizing.svg",E1:"heliostat_side_sizing.svg",E2:"heliostat_side_sizing.svg",L1:"heliostat_face_sizing.svg",L2:"heliostat_side_sizing.svg",L3:"heliostat_face_sizing.svg",L4:"heliostat_face_sizing.svg",L5:"heliostat_face_sizing.svg",L6:"heliostat_face_sizing.svg",L7:"heliostat_face_sizing.svg",L8:"heliostat_face_sizing.svg",al:"heliostat_side_sizing.svg",ar:"heliostat_side_sizing.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function dr(s,e,d=""){const t=be(Wo.partName+d),n=G(),i=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const a=e.H1+e.H2-e.H3+e.H4+e.H5-e.H6+e.H7;t.logstr+=`heliostat-height: ${p(a)}, diameter ${p(e.D1)} m
`,t.logstr+=`heliostat-swing-length: ${p(e.L1)}, width ${p(e.L2)} m
`;const c=(e.al-e.ar)/2-Math.sin(2*Math.PI*s/Wo.sim.tMax)*(e.al+e.ar)/2,h=xe(c);t.logstr+=`swing position angle: ${p(Ce(h))} degree
`;const l=e.H1+e.H2-e.H3,f=l+e.H4+e.H5-e.H6+e.H7,_=f+e.H8,u=ft(xo.pDef),g=ft(Po.pDef),S=ft(Uo.pDef),L=ft(Do.pDef);u.setVal("H1",e.H1),u.setVal("H2",e.H2),u.setVal("D1",e.D1),u.setVal("D2",e.D2),u.setVal("D3",e.D1-6*e.E1),u.setVal("E1",e.E1),u.setVal("E2",e.E1);const R=32,v=(e.D1-6*e.E1)/(R*4);u.setVal("N1",R),u.setVal("D5",v),u.setVal("L1",e.E1+v/2),u.setVal("H3",e.H1/4),u.setVal("H4",e.H1/2),u.setVal("D4",e.H1/4),u.setVal("L2",e.H1/80),u.setVal("E3",e.H1/80),u.setVal("holders",0),g.setVal("H1",e.H4),g.setVal("H2",e.H5),g.setVal("H3",e.H4-2*e.E1),g.setVal("D1",e.D3),g.setVal("D2",e.D4),g.setVal("L9",e.D3/2),g.setVal("H7",e.D3/2*1.6),g.setVal("H6",e.D3/20),g.setVal("R9",e.D3/20),g.setVal("E1",e.E1),g.setVal("E3",e.E1),g.setVal("E4",e.E1),g.setVal("E6",e.E1);const x=e.D2*.6,C=24,T=x/(C*4);if(g.setVal("D3",x),e.D2>e.D3-2*e.E1)throw`err153: D2 ${e.D2} too large compare to D3 ${e.D3} and E1 ${e.E1}`;if(g.setVal("N1",C),g.setVal("D7",T),g.setVal("L1",T),g.setVal("H4",e.H6),g.setVal("D4",e.D5),g.setVal("L7",e.L7),g.setVal("L8",e.L8),g.setVal("D6",e.D9),g.setVal("H5",e.H7+e.H8),g.setVal("D5",e.D6),g.setVal("D8",e.D7),e.D6>=e.D7)throw`err164: D6 ${e.D6} too large compare to D7 ${e.D7}`;const w=e.L4-2*e.L3;if(g.setVal("L4",w),w<=0)throw`err169: L3 ${e.L3} too large compare to L4 ${e.L4}`;g.setVal("L5",e.L5+2*e.L3),g.setVal("L6",e.L6+2*e.L3);const P=e.L5*.96,M=6;if(S.setVal("L5",P),S.setVal("D1",e.D8),S.setVal("L1",e.S1),S.setVal("L2",e.S2),S.setVal("L3",e.E2*2),S.setVal("E1",e.E1),S.setVal("E2",e.E2),S.setVal("E3",e.E1),S.setVal("L4",e.L2/2-e.H8),S.setVal("R2",0),S.setVal("N1",M),S.setVal("L6",P/(M*10)),L.setVal("L2",e.L2),L.setVal("D1",e.D6),L.setVal("H3",e.H9),L.setVal("H4",e.H9),L.setVal("L1",e.L1),e.L1<4*e.L4+2*e.L6+e.L5+2*e.L3)throw`err185: L1 ${e.L1} too small compare to L4 ${e.L4}, L5 ${e.L5}, L6 ${e.L6}`;L.setVal("H1",e.L3),L.setVal("H2",e.L3),L.setVal("L4",e.L4),L.setVal("L5",e.L5),L.setVal("L6",e.L6),L.setVal("L3",e.D7),L.setVal("S1",e.D6/2),L.setVal("R2",0);const b=xo.pGeom(0,u.getParamVal(),u.getSuffix());vt(b),t.logstr+=St(b.logstr,u.getPartNameSuffix());const j=Po.pGeom(0,g.getParamVal(),g.getSuffix());vt(j),t.logstr+=St(j.logstr,g.getPartNameSuffix());const O=Uo.pGeom(0,S.getParamVal(),S.getSuffix());vt(O),t.logstr+=St(O.logstr,S.getPartNameSuffix());const y=Do.pGeom(0,L.getParamVal(),L.getSuffix());vt(y),t.logstr+=St(y.logstr,L.getPartNameSuffix()),n.mergeFigure(b.fig.poleCut),n.mergeFigure(j.fig.faceBeam.translate(0,l)),n.mergeFigure(O.fig.faceLegs.translate(0,f).rotate(0,f,h/2)),n.mergeFigure(y.fig.faceSide.translate(0,_).rotate(0,_,h)),i.mergeFigure(b.fig.poleCut),i.mergeFigure(j.fig.faceCone.translate(0,l)),i.mergeFigure(O.fig.faceBody.translate(-P/2,f)),i.mergeFigure(y.fig.faceFace.translate(0,_)),t.fig={faceSide:n,faceFace:i};const q=t.partName;t.vol={inherits:[{outName:`inpax_${q}_poleStatic`,subdesign:"pax_pole_static",subgeom:b,rotate:[0,0,0],translate:[0,0,0]},{outName:`inpax_${q}_rake`,subdesign:"pax_rake",subgeom:j,rotate:[0,0,0],translate:[0,0,l]},{outName:`inpax_${q}_swing`,subdesign:"pax_swing",subgeom:y,rotate:[Math.PI/2,0,0],translate:[0,0,_]},{outName:`inpax_${q}_spider`,subdesign:"pax_spider",subgeom:O,rotate:[Math.PI/2,0,0],translate:[0,P/2,f]}],extrudes:[],volumes:[{outName:`pax_${q}`,boolMethod:pe.eUnion,inList:[`inpax_${q}_poleStatic`,`inpax_${q}_rake`,`inpax_${q}_swing`,`inpax_${q}_spider`]}]};const X={partName:u.getPartName(),dparam:u.getDesignParamList(),orientation:[0,0,0],position:[0,0,0]},N={partName:g.getPartName(),dparam:g.getDesignParamList(),orientation:[0,0,0],position:[0,0,l]},F={partName:S.getPartName(),dparam:S.getDesignParamList(),orientation:[Math.PI/2,0,0],position:[0,P/2,f]},W={partName:L.getPartName(),dparam:L.getDesignParamList(),orientation:[Math.PI/2,0,0],position:[0,0,_]};t.sub={pole_static_1:X,rake_1:N,spider_1:F,swing_1:W},t.logstr+=`heliostat-overview drawn successfully!
`,t.calcErr=!1}catch(a){t.logstr+=a,console.log(a)}return t}var cr={pTitle:"Heliostat overview",pDescription:"The heliostat inclination mechanism",pDef:Wo,pGeom:dr},ps={partName:"rake_stopper",params:[o("D1","mm",600,10,4e3,1),o("D2","mm",400,10,4e3,1),o("D3","mm",400,1,4e3,1),o("H1","mm",800,1,4e3,1),o("H2","mm",3e3,20,6e3,1),o("H3","mm",400,0,4e3,1),o("E1","mm",20,1,80,1),o("E3","mm",30,1,80,1),oe("transversal"),o("H4","mm",200,1,1e3,1),o("D4","mm",300,1,1e3,1),o("E4","mm",20,1,80,1),o("H5","mm",400,1,2e3,1),o("D5","mm",200,1,1e3,1),o("L4","mm",300,1,1e3,1),o("L5","mm",2e3,1,4e3,1),o("L6","mm",2e3,1,4e3,1),o("D8","mm",400,1,1e3,1),oe("diagonal"),o("D6","mm",100,1,600,1),o("E6","mm",10,1,80,1),o("L7","mm",100,1,1e3,1),o("L8","mm",200,1,1e3,1),oe("base"),o("N1","",24,3,100,1),o("D7","mm",40,1,100,1),o("L1","mm",30,1,300,1),oe("door"),o("H6","mm",100,1,1e3,1),o("H7","mm",600,1,2e3,1),o("L9","mm",300,1,1e3,1),o("R9","mm",50,0,300,1),o("doorOrientation","degree",0,-180,180,1),oe("stoppers"),o("S1","mm",100,1,300,1),o("S2","mm",2e3,1,8e3,1),o("S3","mm",100,0,8e3,1),o("E7","mm",5,1,80,1),oe("low stopper"),o("JD1","mm",200,1,500,1),o("JE1","mm",5,1,80,1),o("JL1","mm",260,1,2e3,1),o("JH1","mm",20,-500,500,1),o("JS1","mm",100,1,500,1),o("JS2","mm",200,1,500,1),oe("high stopper"),o("JD3","mm",200,1,500,1),o("JE3","mm",5,1,80,1),o("JS3","mm",120,1,500,1),o("JD4","mm",200,1,500,1),o("JE4","mm",5,1,80,1),o("JS4","mm",120,1,500,1)],paramSvg:{D1:"rake_face.svg",D2:"rake_side.svg",D3:"rake_face.svg",H1:"rake_face.svg",H2:"rake_face.svg",H3:"rake_face.svg",E1:"rake_face.svg",E3:"rake_face.svg",H4:"rake_side.svg",D4:"rake_side.svg",E4:"rake_side.svg",H5:"rake_side.svg",D5:"rake_side.svg",L4:"rake_face.svg",L5:"rake_face.svg",L6:"rake_face.svg",D6:"rake_face.svg",E6:"rake_face.svg",L7:"rake_face.svg",L8:"rake_face.svg",N1:"rake_top.svg",D7:"rake_top.svg",L1:"rake_top.svg",D8:"rake_side.svg",H6:"rake_door.svg",H7:"rake_door.svg",L9:"rake_door.svg",R9:"rake_door.svg",doorOrientation:"rake_door.svg",S1:"rake_side_stopper.svg",S2:"rake_top_stopper.svg",S3:"rake_side_stopper.svg",E7:"rake_side_stopper.svg",JD1:"rake_low_stopper_holder.svg",JE1:"rake_low_stopper_holder.svg",JL1:"rake_low_stopper_holder.svg",JH1:"rake_low_stopper_holder.svg",JS1:"rake_side_stopper.svg",JS2:"rake_top_stopper.svg",JD3:"rake_side_stopper.svg",JE3:"rake_side_stopper.svg",JS3:"rake_top_stopper.svg",JD4:"rake_top_stopper.svg",JE4:"rake_top_stopper.svg",JS4:"rake_side_stopper.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function lr(s,e,d=""){const t=be(ps.partName+d),n=G(),i=G(),a=G(),r=G(),c=G(),h=G(),l=G(),f=G(),_=G(),u=G(),g=G(),S=G(),L=G(),R=G(),v=G(),x=G(),C=G(),T=G(),w=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const M=Math.PI,b=Math.PI/2,j=-Math.PI/2,O=e.D1/2,y=e.H1+e.H2,q=y-e.H4+e.H5,X=q-e.S2,N=e.H1+e.H2-e.H4,F=N+e.D4/2,W=e.H1+e.S3,K=e.L5/2,z=e.S1/2,I=e.S1-2*e.E7,U=I/2,D=e.S2-z,Y=X-e.JH1,E=e.JD1/2,Q=E-e.JE1,ie=O+e.JS2,J=K-z,V=O+e.JS3,Z=e.JD3-2*e.JE3,ee=e.D4/2+e.JS4,He=e.JD4-2*e.JE4;if(2*e.E7>=e.S1)throw`err135: E7 ${e.E7} too large compare to S1 ${e.S1}`;if(e.L5<e.D2)throw`err138: L5 ${e.L5} too small compare to D2 ${e.D2}`;if(X-e.JH1-e.JD1/2<0)throw`err143: S2 ${e.S2} too large compare to H1H5 ${p(q)}`;if(e.JS1<e.S1/2)throw`err144: JS1 ${e.JS1} too small compare to S1 ${e.S1}`;if(e.JE1>e.JD1/2)throw`err145: JE1 ${e.JE1} too large compare to JD1 ${e.JD1}`;if(e.JL1>e.D1)throw`err146: JL1 ${e.JL1} too large compare to D1 ${e.D1}`;if(e.JL1<e.JD1)throw`err147: JL1 ${e.JL1} too small compare to JD1 ${e.JD1}`;if(Math.abs(e.JH1)>e.JD1/2+z)throw`err148: JH1 ${e.JH1} too large compare to JD1 ${e.JD1} and S1 ${e.S1}`;if(e.JS2<e.JS1-z)throw`err149: JS2 ${e.JS2} too small compare to JS1 ${e.JS1} and S1 ${e.S1}`;if(e.S3>e.H2-e.H4)throw`err150: S3 ${e.S3} too large compare to H2 ${e.H2} and H4 ${e.H4}`;if(e.JE3>e.JD3/2)throw`err151: JE3 ${e.JE3} too large compare to JD3 ${e.JD3}`;if(e.JE4>e.JD4/2)throw`err152: JE4 ${e.JE4} too large compare to JD4 ${e.JD4}`;t.logstr+=`cone-height: ${p(y)} mm
`,t.logstr+=`cone-height total: ${p(q)} mm
`;const Le=[],ye=[];x.addSecond(ge(-K,X,e.L5,e.S1,0)),x.addSecond(ge(-K,X,e.L5,I,0)),Le.push($(-e.JL1/2,Y,E)),Le.push($(-e.JL1/2,Y,Q)),ye.push($(e.JL1/2,Y,E)),ye.push($(e.JL1/2,Y,Q)),x.addMainOI(Le),x.addMainOI(ye);const fe=ft(Po.pDef);fe.setVal("D1",e.D1),fe.setVal("D2",e.D2),fe.setVal("D3",e.D3),fe.setVal("H1",e.H1),fe.setVal("H2",e.H2),fe.setVal("H3",e.H3),fe.setVal("E1",e.E1),fe.setVal("E3",e.E3),fe.setVal("H4",e.H4),fe.setVal("D4",e.D4),fe.setVal("E4",e.E4),fe.setVal("H5",e.H5),fe.setVal("D5",e.D5),fe.setVal("L4",e.L4),fe.setVal("L5",e.L5),fe.setVal("L6",e.L6),fe.setVal("D6",e.D6),fe.setVal("E6",e.E6),fe.setVal("L7",e.L7),fe.setVal("L8",e.L8),fe.setVal("N1",e.N1),fe.setVal("D7",e.D7),fe.setVal("L1",e.L1),fe.setVal("D8",e.D8),fe.setVal("H6",e.H6),fe.setVal("H7",e.H7),fe.setVal("L9",e.L9),fe.setVal("R9",e.R9),fe.setVal("doorOrientation",e.doorOrientation);const ce=Po.pGeom(0,fe.getParamVal(),fe.getSuffix());vt(ce),t.logstr+=St(ce.logstr,fe.getPartNameSuffix()),n.mergeFigure(ce.fig.faceCone),n.mergeFigure(x,!0),i.mergeFigure(ce.fig.faceBeam),a.mergeFigure(ce.fig.faceBeamHollow),r.mergeFigure(ce.fig.faceDisc),c.mergeFigure(ce.fig.faceHand),h.mergeFigure(ce.fig.faceWing),l.mergeFigure(ce.fig.faceWingHollow),f.mergeFigure(ce.fig.faceDoor),f.mergeFigure(x,!0),_.mergeFigure(ce.fig.faceDisc,!0),_.addMainOI([ge(-O-e.JS1,-K,e.L5,e.S1,b),ge(-O-e.JS1,-K,e.L5,I,b)]),_.addMainOI([ge(D,-K,e.L5,e.S1,b),ge(D,-K,e.L5,I,b)]),_.addMainOI([ge(0,-K+z,D,e.S1,0),ge(0,-K+z,D,I,0)]),_.addMainOI([ge(0,K-z,D,e.S1,0),ge(0,K-z,D,I,0)]),_.addMainOI([ge(0,-O-z,D,e.S1,0),ge(0,-O-z,D,I,0)]),_.addMainOI([ge(0,O+z,D,e.S1,0),ge(0,O+z,D,I,0)]),_.addSecond(ge(0,-e.JL1/2,ie,2*E,M)),_.addSecond(ge(0,-e.JL1/2,ie,2*Q,M)),_.addSecond(ge(0,e.JL1/2,ie,2*E,M)),_.addSecond(ge(0,e.JL1/2,ie,2*Q,M)),_.addSecond(ge(0,0,V,e.JD3,j)),_.addSecond(ge(0,0,V,Z,j)),_.addSecond(ge(0,0,V,e.JD3,b)),_.addSecond(ge(0,0,V,Z,b)),u.mergeFigure(ce.fig.faceBeam,!0),u.addMainOI([$(-O-e.JS1,X,z),$(-O-e.JS1,X,U)]),u.addMainOI([$(D,F+z,z),$(D,F+z,U)]),u.addSecond(ge(0,F+z,D,e.S1,0)),u.addSecond(ge(0,F+z,D,I,0));const Ie=F+z-W,We=Math.sqrt(D**2+Ie**2),et=Math.atan2(Ie,D);t.logstr+=`stopper-rod: L ${p(We)} mm, A ${p(Ce(et))} degree
`,u.addSecond(ge(0,W,We,e.S1,et)),u.addSecond(ge(0,W,We,I,et)),u.addSecond(ge(0,Y,ie,2*E,M)),u.addSecond(ge(0,Y,ie,2*Q,M)),u.addSecond($(0,W,e.JD3/2)),u.addSecond($(0,W,e.JD3/2-e.JE3)),u.addSecond(ge(0,N,ee,e.JD4,b)),u.addSecond(ge(0,N,ee,He,b)),g.mergeFigure(u,!0),g.addMainO($(-O-e.JS1,X,U)),g.addMainO($(e.S2-z,F+z,U)),S.mergeFigure(ce.fig.faceCone,!0),S.mergeFigure(x,!0),S.addMainOI([$(-e.L5/2+z,F+z,z),$(-e.L5/2+z,F+z,U)]),S.addMainOI([$(e.L5/2-z,F+z,z),$(e.L5/2-z,F+z,U)]),L.mergeFigure(ce.fig.faceCone,!0),L.mergeFigure(x,!0),L.addSecond($(-e.L5/2+z,F+z,z)),L.addMainO($(-e.L5/2+z,F+z,U)),L.addSecond($(e.L5/2-z,F+z,z)),L.addMainO($(e.L5/2-z,F+z,U)),R.mergeFigure(ce.fig.faceCone,!0),R.mergeFigure(x,!0),R.addMainOI([$(-O-z,0,z),$(-O-z,0,U)]),R.addMainOI([$(O+z,0,z),$(O+z,0,U)]),v.mergeFigure(ce.fig.faceCone,!0),v.mergeFigure(x,!0),v.addSecond($(-O-z,0,z)),v.addMainO($(-O-z,0,U)),v.addSecond($(O+z,0,z)),v.addMainO($(O+z,0,U)),C.mergeFigure(ce.fig.faceCone,!0),C.mergeFigure(x),C.addSecond(ge(-J,N,ee,e.JD4,b)),C.addSecond(ge(-J,N,ee,He,b)),C.addSecond(ge(J,N,ee,e.JD4,b)),C.addSecond(ge(J,N,ee,He,b)),C.addSecond(ge(0,W,V,e.JD3,M)),C.addSecond(ge(0,W,V,Z,M)),C.addSecond(ge(0,W,V,e.JD3,0)),C.addSecond(ge(0,W,V,Z,0)),T.mergeFigure(u,!0),T.addMainOI([$(0,W,e.JD3/2),$(0,W,e.JD3/2-e.JE3)]),w.mergeFigure(_,!0),w.addMainOI([$(0,-J,e.JD4/2),$(0,-J,e.JD4/2-e.JE4)]),w.addMainOI([$(0,J,e.JD4/2),$(0,J,e.JD4/2-e.JE4)]),t.fig={faceCone:n,faceBeam:i,faceBeamHollow:a,faceDisc:r,faceHand:c,faceWing:h,faceWingHollow:l,faceDoor:f,faceStopperTop:_,faceStopperSide:u,faceStopperSideH:g,faceStopperFaceT:S,faceStopperFaceTH:L,faceStopperFaceB:R,faceStopperFaceBH:v,faceLowStopperHolder:C,faceHi1StopperHolder:T,faceHi2StopperHolder:w};const le=t.partName;t.vol={inherits:[{outName:`inpax_${le}_rake`,subdesign:"pax_rake",subgeom:ce,rotate:[0,0,0],translate:[0,0,0]},{outName:`inpax_${le}_coneHollow`,subdesign:"subpax_rake_coneHollow",subgeom:ce,rotate:[0,0,0],translate:[0,0,0]},{outName:`inpax_${le}_beamHollow`,subdesign:"subpax_rake_beamHollow",subgeom:ce,rotate:[0,0,0],translate:[0,0,0]}],extrudes:[{outName:`subpax_${le}_stpSide`,face:`${le}_faceStopperSide`,extrudeMethod:se.eLinearOrtho,length:e.L5,rotate:[Math.PI/2,0,0],translate:[0,e.L5/2,0]},{outName:`subpax_${le}_stpSideH`,face:`${le}_faceStopperSideH`,extrudeMethod:se.eLinearOrtho,length:e.L5,rotate:[Math.PI/2,0,0],translate:[0,e.L5/2,0]},{outName:`subpax_${le}_stpFaceT`,face:`${le}_faceStopperFaceT`,extrudeMethod:se.eLinearOrtho,length:D,rotate:[Math.PI/2,0,Math.PI/2],translate:[0,0,0]},{outName:`subpax_${le}_stpFaceTH`,face:`${le}_faceStopperFaceTH`,extrudeMethod:se.eLinearOrtho,length:D,rotate:[Math.PI/2,0,Math.PI/2],translate:[0,0,0]},{outName:`subpax_${le}_stpFaceB`,face:`${le}_faceStopperFaceB`,extrudeMethod:se.eLinearOrtho,length:We,rotate:[Math.PI/2-et,0,Math.PI/2],translate:[0,0,W]},{outName:`subpax_${le}_stpFaceBH`,face:`${le}_faceStopperFaceBH`,extrudeMethod:se.eLinearOrtho,length:We,rotate:[Math.PI/2-et,0,Math.PI/2],translate:[0,0,W]},{outName:`subpax_${le}_lowSH`,face:`${le}_faceLowStopperHolder`,extrudeMethod:se.eLinearOrtho,length:ie,rotate:[Math.PI/2,0,-Math.PI/2],translate:[0,0,0]},{outName:`subpax_${le}_Hi1SH1`,face:`${le}_faceHi1StopperHolder`,extrudeMethod:se.eLinearOrtho,length:V,rotate:[Math.PI/2,0,0],translate:[0,0,0]},{outName:`subpax_${le}_Hi1SH2`,face:`${le}_faceHi1StopperHolder`,extrudeMethod:se.eLinearOrtho,length:V,rotate:[Math.PI/2,0,Math.PI],translate:[0,0,0]},{outName:`subpax_${le}_Hi2SH`,face:`${le}_faceHi2StopperHolder`,extrudeMethod:se.eLinearOrtho,length:ee,rotate:[0,0,0],translate:[0,0,N]}],volumes:[{outName:`ipax_${le}_plus`,boolMethod:pe.eUnion,inList:[`subpax_${le}_stpSide`,`subpax_${le}_stpFaceT`,`subpax_${le}_stpFaceB`,`subpax_${le}_lowSH`,`subpax_${le}_Hi1SH1`,`subpax_${le}_Hi1SH2`,`subpax_${le}_Hi2SH`]},{outName:`ipax_${le}_hollow`,boolMethod:pe.eUnion,inList:[`inpax_${le}_coneHollow`,`inpax_${le}_beamHollow`,`subpax_${le}_stpSideH`,`subpax_${le}_stpFaceTH`,`subpax_${le}_stpFaceBH`]},{outName:`ipax_${le}_stopper`,boolMethod:pe.eSubstraction,inList:[`ipax_${le}_plus`,`ipax_${le}_hollow`]},{outName:`pax_${le}`,boolMethod:pe.eUnion,inList:[`inpax_${le}_rake`,`ipax_${le}_stopper`]}]},t.sub={},t.logstr+=`heliostat-rake drawn successfully!
`,t.calcErr=!1}catch(P){t.logstr+=P,console.log(P)}return t}var qo={pTitle:"Heliostat rake with stopper",pDescription:"The rake-stopper on top of the V-Axis of the heliostat",pDef:ps,pGeom:lr},Xo={partName:"heliostat_2",params:[o("H1","mm",3e3,10,4e4,1),o("H2","mm",2500,50,4e4,1),o("D1","mm",1e3,20,4e3,1),o("D2","mm",700,20,4e3,1),o("E1","mm",30,1,80,1),oe("rake"),o("H3","mm",200,1,500,1),o("H4","mm",800,1,4e3,1),o("H5","mm",3e3,50,6e3,1),o("H6","mm",200,1,4e3,1),o("H7","mm",400,1,4e3,1),o("D3","mm",900,20,4e3,1),o("D4","mm",400,20,4e3,1),o("D5","mm",300,20,1e3,1),o("D6","mm",200,10,1e3,1),o("D7","mm",400,10,1e3,1),oe("rake diagonal"),o("D9","mm",100,1,1e3,1),o("L7","mm",100,1,1e3,1),o("L8","mm",200,1,1e3,1),oe("rake stopper"),o("S1","mm",100,1,800,1),oe("swing"),o("L1","mm",12500,100,4e4,1),o("L2","mm",6e3,100,4e4,1),o("L3","mm",100,1,500,1),o("L4","mm",600,1,4e3,1),o("L5","mm",2e3,10,6e3,1),o("L6","mm",2e3,1,6e3,1),o("H9","mm",100,1,400,1),o("S2","mm",10,0,2e3,1),oe("motion amplitude"),o("al","degree",80,0,95,1)],paramSvg:{H1:"heliostat_overview.svg",H2:"heliostat_side.svg",H3:"heliostat2_side_sizing.svg",H4:"heliostat2_side_sizing.svg",H5:"heliostat2_side_sizing.svg",H6:"heliostat2_side_sizing.svg",H7:"heliostat2_side_sizing.svg",H9:"heliostat2_side_sizing.svg",D1:"heliostat2_side_sizing.svg",D2:"heliostat2_side_sizing.svg",D3:"heliostat2_side_sizing.svg",D4:"heliostat2_side_sizing.svg",D5:"heliostat2_side_sizing.svg",D6:"heliostat2_side_sizing.svg",D7:"heliostat2_side_sizing.svg",D9:"heliostat2_face_sizing.svg",E1:"heliostat2_side_sizing.svg",L1:"heliostat2_face_sizing.svg",L2:"heliostat2_side_sizing.svg",L3:"heliostat2_face_sizing.svg",L4:"heliostat2_face_sizing.svg",L5:"heliostat2_face_sizing.svg",L6:"heliostat2_face_sizing.svg",L7:"heliostat2_face_sizing.svg",L8:"heliostat2_face_sizing.svg",S1:"heliostat2_side_sizing.svg",S2:"heliostat2_side_sizing.svg",al:"heliostat2_side_sizing.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function gr(s,e,d=""){const t=be(Xo.partName+d),n=G(),i=G(),a=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const r=e.H1+e.H2-e.H3+e.H4+e.H5-e.H6+e.H7;t.logstr+=`heliostat-height: ${p(r)}, diameter ${p(e.D1)} m
`,t.logstr+=`heliostat-swing-length: ${p(e.L1)}, width ${p(e.L2)} m
`;const c=e.al*s/Xo.sim.tMax,h=xe(c);t.logstr+=`swing position angle: ${p(Ce(h))} degree
`;const l=e.H1+e.H2-e.H3,f=l+e.H4+e.H5-e.H6+e.H7,_=ft(xo.pDef),u=ft(qo.pDef),g=ft(Do.pDef);_.setVal("H1",e.H1),_.setVal("H2",e.H2),_.setVal("D1",e.D1),_.setVal("D2",e.D2),_.setVal("D3",e.D1-6*e.E1),_.setVal("E1",e.E1),_.setVal("E2",e.E1);const S=32,L=(e.D1-6*e.E1)/(S*4);_.setVal("N1",S),_.setVal("D5",L),_.setVal("L1",e.E1+L/2),_.setVal("H3",e.H1/4),_.setVal("H4",e.H1/2),_.setVal("D4",e.H1/4),_.setVal("L2",e.H1/80),_.setVal("E3",e.H1/80),_.setVal("holders",0),u.setVal("H1",e.H4),u.setVal("H2",e.H5),u.setVal("H3",e.H4-2*e.E1),u.setVal("D1",e.D3),u.setVal("D2",e.D4),u.setVal("L9",e.D3/2),u.setVal("H7",e.D3/2*1.6),u.setVal("H6",e.D3/20),u.setVal("R9",e.D3/20),u.setVal("E1",e.E1),u.setVal("E3",e.E1),u.setVal("E4",e.E1),u.setVal("E6",e.E1),u.setVal("E7",e.E1);const R=e.D2*.6,v=24,x=R/(v*4);if(u.setVal("D3",R),e.D2>e.D3-2*e.E1)throw`err153: D2 ${e.D2} too large compare to D3 ${e.D3} and E1 ${e.E1}`;if(u.setVal("N1",v),u.setVal("D7",x),u.setVal("L1",x),u.setVal("H4",e.H6),u.setVal("D4",e.D5),u.setVal("L7",e.L7),u.setVal("L8",e.L8),u.setVal("D6",e.D9),u.setVal("H5",e.H7),u.setVal("D5",e.D6),u.setVal("D8",e.D7),e.D6>=e.D7)throw`err164: D6 ${e.D6} too large compare to D7 ${e.D7}`;const C=e.L4-2*e.L3;if(u.setVal("L4",C),C<=0)throw`err169: L3 ${e.L3} too large compare to L4 ${e.L4}`;if(u.setVal("L5",e.L5+2*e.L3),u.setVal("L6",e.L6+2*e.L3),u.setVal("S1",e.S1),u.setVal("S2",e.L2/2),u.setVal("S3",0),u.setVal("S3",0),u.setVal("JD1",e.D3/4),u.setVal("JE1",e.E1),u.setVal("JL1",e.D3/3),u.setVal("JH1",0),u.setVal("JS1",e.S1/2),u.setVal("JS2",e.S1/2),u.setVal("JD3",e.D4/4),u.setVal("JE3",e.E1),u.setVal("JS3",e.D4/4),u.setVal("JD4",e.D4/4),u.setVal("JE4",e.E1),u.setVal("JS4",e.D4/4),g.setVal("L2",e.L2),g.setVal("D1",e.D6),g.setVal("H3",e.H9),g.setVal("H4",e.H9),g.setVal("L1",e.L1),e.L1<4*e.L4+2*e.L6+e.L5+2*e.L3)throw`err185: L1 ${e.L1} too small compare to L4 ${e.L4}, L5 ${e.L5}, L6 ${e.L6}`;g.setVal("H1",e.L3),g.setVal("H2",e.L3),g.setVal("L4",e.L4),g.setVal("L5",e.L5),g.setVal("L6",e.L6),g.setVal("L3",e.D7),g.setVal("S1",e.D6/2),g.setVal("S2",e.S2),g.setVal("R2",0);const T=xo.pGeom(0,_.getParamVal(),_.getSuffix());vt(T),t.logstr+=St(T.logstr,_.getPartNameSuffix());const w=qo.pGeom(0,u.getParamVal(),u.getSuffix());vt(w),t.logstr+=St(w.logstr,u.getPartNameSuffix());const P=Do.pGeom(0,g.getParamVal(),g.getSuffix());vt(P),t.logstr+=St(P.logstr,g.getPartNameSuffix()),n.mergeFigure(T.fig.poleCut),n.mergeFigure(w.fig.faceStopperSide.translate(0,l)),n.mergeFigure(P.fig.faceSide.translate(0,f).rotate(0,f,h)),i.mergeFigure(T.fig.poleCut),i.mergeFigure(w.fig.faceStopperFaceT.translate(0,l)),i.mergeFigure(P.fig.faceFace.translate(0,f)),a.mergeFigure(T.fig.poleBottom.translate(0,0)),a.mergeFigure(w.fig.faceStopperTop.translate(0,0)),a.mergeFigure(P.fig.faceTop.rotate(0,0,Math.PI/2)),t.fig={faceSide:n,faceFace:i,faceTop:a};const M=t.partName;t.vol={inherits:[{outName:`inpax_${M}_poleStatic`,subdesign:"pax_pole_static",subgeom:T,rotate:[0,0,0],translate:[0,0,0]},{outName:`inpax_${M}_rake`,subdesign:"pax_rake_stopper",subgeom:w,rotate:[0,0,0],translate:[0,0,l]},{outName:`inpax_${M}_swing`,subdesign:"pax_swing",subgeom:P,rotate:[Math.PI/2,0,0],translate:[0,0,f]}],extrudes:[],volumes:[{outName:`pax_${M}`,boolMethod:pe.eUnion,inList:[`inpax_${M}_poleStatic`,`inpax_${M}_rake`,`inpax_${M}_swing`]}]};const b=_.getDesignParamList(),j={partName:_.getPartName(),dparam:b,orientation:[0,0,0],position:[0,0,0]},O={partName:u.getPartName(),dparam:u.getDesignParamList(),orientation:[0,0,0],position:[0,0,l]},y={partName:g.getPartName(),dparam:g.getDesignParamList(),orientation:[0,0,0],position:[0,0,f]};t.sub={pole_static_1:j,rake_1:O,swing_1:y},t.logstr+=`heliostat-2-overview drawn successfully!
`,t.calcErr=!1}catch(r){t.logstr+=r,console.log(r)}return t}var hr={pTitle:"Heliostat-2 overview",pDescription:"The heliostat-2 inclination mechanism",pDef:Xo,pGeom:gr},bs={partName:"base",params:[o("D1","mm",600,10,4e3,10),o("D2","mm",700,10,4e3,10),o("D3","mm",400,10,4e3,10),o("D4","mm",500,10,4e3,10),o("E1","mm",30,1,80,1),o("E2","mm",30,1,80,1),o("E3","mm",30,1,80,1),o("H1","mm",800,10,4e3,10),o("H2","mm",50,1,4e3,1),oe("side holes"),o("H3","mm",400,10,4e3,10),o("N2","",12,1,100,1),o("L2","mm",100,1,400,1),oe("base holes"),o("N1","",24,3,100,1),o("D5","mm",40,1,100,1),o("L1","mm",34,1,300,1)],paramSvg:{D1:"base_cut.svg",D2:"base_cut.svg",D3:"base_cut.svg",D4:"base_cut.svg",E1:"base_cut.svg",E2:"base_cut.svg",E3:"base_cut.svg",H1:"base_cut.svg",H2:"base_hollow.svg",H3:"base_hollow.svg",N2:"base_hollow.svg",L2:"base_hollow.svg",N1:"base_top.svg",D5:"base_top.svg",L1:"base_top.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function ur(s,e,d=""){const t=be(bs.partName+d);let n,i,a;const r=G(),c=G(),h=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const l=e.D1/2,f=e.D2/2,_=e.D3/2,u=e.D4/2,g=e.D5/2,S=e.L2/2;if(f<l)throw`err089: D2 ${e.D2} too small compare to D1 ${e.D1}`;if(u>l-e.E2)throw`err189: D4 ${e.D4} too large compare to D1 ${e.D1} and E2 ${e.E2}`;t.logstr+=`base-height: ${p(e.H1)} mm
`,t.logstr+=`base-external-diameter: ${p(e.D2)} mm
`;const L=e.D1*Math.PI/e.N2-e.L2;if(t.logstr+=`inter-hollow: ${p(L)} mm
`,n=function(y){return B(y*f,0).addSegStrokeA(y*f,e.E3).addSegStrokeA(y*l,e.E3).addSegStrokeA(y*l,e.H1).addSegStrokeA(y*(l-e.E2),e.H1).addSegStrokeA(y*(l-e.E2),e.E3).addSegStrokeA(y*u,e.E3).addSegStrokeA(y*u,0).closeSegStroke()},i=function(y){return B(y*f,0).addSegStrokeA(y*f,e.E3).addSegStrokeA(y*l,e.E3).addSegStrokeA(y*l,e.H1).addSegStrokeA(y*_,e.H1).addSegStrokeA(y*_,e.H1-e.E1).addSegStrokeA(y*(l-e.E2),e.H1-e.E1).addSegStrokeA(y*(l-e.E2),e.E3).addSegStrokeA(y*u,e.E3).addSegStrokeA(y*u,0).closeSegStroke()},e.H1<e.E3+e.H2+e.H3+e.E1)throw`err125: H1 ${e.H1} too small compare to E3 ${e.H3}, H2 ${e.H2}, H3 ${e.H3}, E1 ${e.E1}`;if(e.D5>e.H3)throw`err128: D5 ${e.D5} too large compare to H3 ${e.H3}`;const R=2*Math.asin(S/(l-e.E2));if(e.N2*R>2*Math.PI)throw`err132: N2 ${e.N2} too large compare to L2 ${e.L2}, D1 ${e.D1}, E2 ${e.E2}`;const v=e.E3+e.H2+S;a=function(y){return B(y*S,v).addSegStrokeA(y*S,v+e.H3-e.L2).addPointA(-y*S,v+e.H3-e.L2).addSegArc(S,!1,!0).addSegStrokeA(-y*S,v).closeSegArc(S,!1,!0)},r.addMainO(n(1)),r.addSecond(i(1)),r.addSecond(i(-1)),r.addSecond(a(1));const x=[];if(_+e.L1+g>l-e.E2)throw`err127: D3 ${e.D3} too large compare to D1 ${e.D1}, E2 ${e.E2}, L1 ${e.L1}, R5 ${e.D5}`;if(g>e.L1)throw`err130: D5 ${e.D5} too large compare to L1 ${e.L1}`;const C=2*Math.asin(g/(f+e.L1));if(e.N1*C>2*Math.PI)throw`err134: N1 ${e.N1} too large compare to D5 ${e.D5}, L1 ${e.L1}, D2 ${e.D2}`;x.push($(0,0,l)),x.push($(0,0,_));const T=_+e.L1,w=2*Math.PI/e.N1;for(let y=0;y<e.N1;y++){const q=T*Math.cos(y*w),X=T*Math.sin(y*w);x.push($(q,X,g))}c.addMainOI(x),c.addSecond($(0,0,l-e.E1)),c.addSecond($(0,0,f)),c.addSecond($(0,0,u)),h.addMainO(a(1)),h.addSecond(i(1)),h.addSecond(i(-1)),t.fig={faceCut:r,faceTop:c,faceHollow:h};const P=t.partName,M=2*Math.PI/e.N2,b=[...Array(e.N2).keys()],j=b.map(y=>({outName:`subpax_${P}_hollow_${y}`,face:`${P}_faceHollow`,extrudeMethod:se.eLinearOrtho,length:f+e.E2,rotate:[Math.PI/2,0,y*M],translate:[0,0,0]})),O=b.map(y=>`subpax_${P}_hollow_${y}`);t.vol={extrudes:[{outName:`subpax_${P}_cut`,face:`${P}_faceCut`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[Math.PI/2,0,0]},{outName:`subpax_${P}_top`,face:`${P}_faceTop`,extrudeMethod:se.eLinearOrtho,length:e.E1,rotate:[0,0,0],translate:[0,0,e.H1-e.E1]},...j],volumes:[{outName:`ipax_${P}_hollows`,boolMethod:pe.eUnion,inList:[...O]},{outName:`ipax_${P}_cylinder`,boolMethod:pe.eSubstraction,inList:[`subpax_${P}_cut`,`ipax_${P}_hollows`]},{outName:`pax_${P}`,boolMethod:pe.eUnion,inList:[`ipax_${P}_cylinder`,`subpax_${P}_top`]}]},t.sub={},t.logstr+=`heliostat-base drawn successfully!
`,t.calcErr=!1}catch(l){t.logstr+=l,console.log(l)}return t}var _r={pTitle:"Heliostat base",pDescription:"The base for the static-pole of the heliostat",pDef:bs,pGeom:ur},ws={partName:"vaxis",params:[o("D1","mm",600,1,4e3,1),o("D2","mm",400,1,4e3,1),o("H1","mm",8e3,10,4e4,10),o("E1","mm",5,1,80,1),o("E2","mm",30,1,80,1),oe("base holes"),o("N1","",24,3,100,1),o("D3","mm",40,1,100,1),o("L1","mm",45,1,300,1)],paramSvg:{D1:"vaxis_cut.svg",D2:"vaxis_cut.svg",H1:"vaxis_cut.svg",E1:"vaxis_cut.svg",E2:"vaxis_cut.svg",N1:"vaxis_ends.svg",D3:"vaxis_ends.svg",L1:"vaxis_ends.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function fr(s,e,d=""){const t=be(ws.partName+d);let n;const i=G(),a=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const r=e.D1/2,c=e.D2/2,h=e.D3/2;t.logstr+=`vaxis-height: ${p(e.H1)} mm
`;const l=B(r,0).addSegStrokeA(r,e.H1).addSegStrokeA(r-e.E1,e.H1).addSegStrokeA(r-e.E1,0).closeSegStroke();i.addMainO(l),n=function(S){return B(S*r,0).addSegStrokeA(S*r,e.H1).addSegStrokeA(S*c,e.H1).addSegStrokeA(S*c,e.H1-e.E2).addSegStrokeA(S*(r-e.E1),e.H1-e.E2).addSegStrokeA(S*(r-e.E1),e.E2).addSegStrokeA(S*c,e.E2).addSegStrokeA(S*c,0).closeSegStroke()},i.addSecond(n(1)),i.addSecond(n(-1));const f=[];f.push($(0,0,r)),f.push($(0,0,c));const _=c+e.L1,u=2*Math.PI/e.N1;for(let S=0;S<e.N1;S++){const L=_*Math.cos(S*u),R=_*Math.sin(S*u);f.push($(L,R,h))}a.addSecond($(0,0,r-e.E1)),a.addMainOI(f),t.fig={faceCut:i,faceBottom:a};const g=t.partName;t.vol={extrudes:[{outName:`subpax_${g}_pole`,face:`${g}_faceCut`,extrudeMethod:se.eRotate,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${g}_bottom`,face:`${g}_faceBottom`,extrudeMethod:se.eLinearOrtho,length:e.E2,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${g}_top`,face:`${g}_faceBottom`,extrudeMethod:se.eLinearOrtho,length:e.E2,rotate:[0,0,0],translate:[0,0,e.H1-e.E2]}],volumes:[{outName:`pax_${g}`,boolMethod:pe.eUnion,inList:[`subpax_${g}_pole`,`subpax_${g}_bottom`,`subpax_${g}_top`]}]},t.sub={},t.logstr+=`V-Axis drawn successfully!
`,t.calcErr=!1}catch(r){t.logstr+=r,console.log(r)}return t}var vr={pTitle:"Heliostat V-Axis",pDescription:"The vertical axis inside the pole of an heliostat",pDef:ws,pGeom:fr},Rs={partName:"ring",params:[o("D1","mm",400,1,2e3,1),o("D3","mm",800,1,4e3,1),o("H1","mm",20,1,100,1),o("H2","mm",100,1,600,1),oe("ring holes"),o("N2","",24,3,100,1),o("D2","mm",40,1,100,1),o("L1","mm",45,1,300,1),oe("ring fake teeth"),o("N1","",100,3,1e4,1),o("L2","mm",30,1,200,1),o("L3","mm",30,1,200,1)],paramSvg:{D1:"ring_top.svg",D3:"ring_top.svg",H1:"ring_section.svg",H2:"ring_section.svg",N2:"ring_top.svg",D2:"ring_top.svg",L1:"ring_top.svg",N1:"ring_top.svg",L2:"ring_top.svg",L3:"ring_top.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Sr(s,e,d=""){const t=be(Rs.partName+d),n=G(),i=G(),a=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const r=e.D1/2,c=e.D2/2,h=e.D3/2,l=e.H1+e.H2;if(e.L1<c)throw`err203: L1 ${e.L1} too small compare to D2 ${e.D2}`;if(r+e.L1+c>h-e.L2-e.L3)throw`err204: D3 ${e.D3} too small compare to D1 ${e.D1}, L1 ${e.L1}, L2 ${e.L2}, L3 ${e.L3}`;if(2*Math.atan2(c,r+e.L1)>2*Math.PI/e.N2)throw`err205: D2 ${e.D2} too large compare to N2 ${e.N2}`;t.logstr+=`ring-height: ${p(l)} mm
`;const f=h-e.L3,_=f-e.L2,u=2*Math.PI/(2*e.N1),g=B(f,0);for(let M=0;M<e.N1;M++){const b=2*M+1,j=2*M+2,O=_*Math.cos(b*u),y=_*Math.sin(b*u),q=f*Math.cos(j*u),X=f*Math.sin(j*u);g.addSegStrokeA(O,y).addSegStrokeA(q,X)}const S=[];S.push($(0,0,h)),S.push($(0,0,r));const L=r+e.L1,R=2*Math.PI/e.N2;for(let M=0;M<e.N2;M++){const b=L*Math.cos(M*R),j=L*Math.sin(M*R);S.push($(b,j,c)),i.addSecond($(b,j,c))}n.addSecond(g),n.addMainOI(S);const v=[];v.push($(0,0,h)),v.push(g),i.addSecond($(0,0,r)),i.addMainOI(v);const x=B(r,0).addSegStrokeA(-r,0).addSegStrokeA(-r,-e.H1).addSegStrokeA(r,-e.H1).closeSegStroke(),C=function(M){return B(M*(r+e.L1)+c,0).addSegStrokeR(-2*c,0).addSegStrokeR(0,-e.H1).addSegStrokeR(2*c,0).closeSegStroke()},T=function(M){return B(M*(h-e.L3),-e.H1).addSegStrokeR(-M*e.L2,0).addSegStrokeR(0,-e.H2).addSegStrokeR(M*e.L2,0).closeSegStroke()},w=function(M){return B(M*h,0).addSegStrokeR(-M*(h-r),0).addSegStrokeR(0,-e.H1).addSegStrokeR(M*(h-e.L2-e.L3-r),0).addSegStrokeR(0,-e.H2).addSegStrokeR(M*(e.L2+e.L3),0).closeSegStroke()};a.addSecond(x),a.addSecond(C(1)),a.addSecond(C(-1)),a.addSecond(T(1)),a.addSecond(T(-1)),a.addMainO(w(1)),a.addSecond(w(-1)),t.fig={faceRingBase:n,faceRingTeeth:i,faceSection:a};const P=t.partName;t.vol={extrudes:[{outName:`subpax_${P}_base`,face:`${P}_faceRingBase`,extrudeMethod:se.eLinearOrtho,length:e.H1,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${P}_teeth`,face:`${P}_faceRingTeeth`,extrudeMethod:se.eLinearOrtho,length:l,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${P}`,boolMethod:pe.eUnion,inList:[`subpax_${P}_base`,`subpax_${P}_teeth`]}]},t.sub={},t.logstr+=`ring drawn successfully!
`,t.calcErr=!1}catch(r){t.logstr+=r,console.log(r)}return t}var Lr={pTitle:"Heliostat ring",pDescription:"The gear ring for adjusting the azimuth of the heliostat",pDef:Rs,pGeom:Sr},As={partName:"ring_guidance",params:[o("D1","mm",700,5,2500,1),o("N1","legs",6,1,24,1),o("D2","mm",600,5,2e3,1),oe("leg details"),o("D3","mm",30,1,200,1),o("D4","mm",50,1,200,1),o("L1","mm",90,1,900,1),o("R5","mm",20,0,500,1),oe("inner"),o("D6","mm",300,1,1e3,1),o("N2","motors",8,1,200,1),o("L2","mm",50,1,200,1),o("D7","mm",80,1,200,1),oe("thickness"),o("T1","mm",10,1,200,1)],paramSvg:{D1:"ring_guidance_top.svg",D2:"ring_guidance_top.svg",D3:"ring_guidance_top.svg",D4:"ring_guidance_top.svg",R5:"ring_guidance_top.svg",D6:"ring_guidance_top.svg",D7:"ring_guidance_top.svg",N1:"ring_guidance_top.svg",N2:"ring_guidance_top.svg",L1:"ring_guidance_top.svg",L2:"ring_guidance_top.svg",T1:"ring_guidance_top.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function xr(s,e,d=""){const t=be(As.partName+d),n=G(),i=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const a=e.D1/2,r=e.D3/2,c=e.D4/2,h=e.D6/2,l=e.D7/2,f=2*Math.PI/e.N2;if(l>e.L2)throw`err461: D7 ${e.D7} is too large compare to L2 ${e.L2}`;if(e.N2*e.D7>(e.D6+2*e.L2)*Math.PI)throw`err462: N2 ${e.N2} is too large compare to D6 ${e.D6}, D7 ${e.D7} and L2 ${e.L2}`;if(e.D2<e.D6+2*e.L2+2*l)throw`err463: D2 ${e.D2} is too small compare to D6 ${e.D6}, L2 ${e.L2} and D7 ${e.D7}`;t.logstr+=`ring_guidance: Dmax ${p(e.D1+2*c)} mm
`;const _=[],[u,g,S]=Ps(e);t.logstr+=u,_.push(g),_.push($(0,0,h));for(let C=0;C<e.N2;C++)_.push($(h+e.L2,0,l).rotate(0,0,C*f));for(let C=0;C<e.N1;C++)_.push($(a,0,r).rotate(0,0,C*S));n.addMainOI(_);const L=function(C,T,w,P){return B(C,T).addSegStrokeR(w,0).addSegStrokeR(0,P).addSegStrokeR(-w,0).closeSegStroke()},R=a-h+c;i.addMainO(L(h,0,R,e.T1)),i.addMainO(L(-h-R,0,R,e.T1)),i.addSecond(L(a-r,0,2*r,e.T1)),i.addSecond(L(-a-r,0,2*r,e.T1));const v=h+e.L2;i.addSecond(L(v-l,0,2*l,e.T1)),i.addSecond(L(-v-l,0,2*l,e.T1)),t.fig={faceTop:n,faceSection:i};const x=t.partName;t.vol={extrudes:[{outName:`subpax_${x}_top`,face:`${x}_faceTop`,extrudeMethod:se.eLinearOrtho,length:e.T1,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${x}`,boolMethod:pe.eIdentity,inList:[`subpax_${x}_top`]}]},t.sub={},t.logstr+=`ring_guidance drawn successfully!
`,t.calcErr=!1}catch(a){t.logstr+=a,console.log(a)}return t}var Pr={pTitle:"Ring-guidance",pDescription:"The guidance of the gear-ring for the heliostat azimuth",pDef:As,pGeom:xr},Ms={partName:"vaxis_guidance",params:[o("D1","mm",700,5,2500,1),o("N1","legs",6,1,24,1),o("D2","mm",600,5,2e3,1),oe("leg details"),o("D3","mm",30,1,200,1),o("D4","mm",50,1,200,1),o("L1","mm",90,1,900,1),o("R5","mm",20,0,500,1),oe("inner"),o("D6","mm",540,1,1e3,1),o("N2","springs",6,1,24,1),At("orientation",["ccw","cw","alt"]),o("R7","mm",10,0,100,1),o("L2","mm",100,1,900,1),o("E2","mm",20,1,200,1),oe("spring"),o("SA1","degree",0,-45,45,1),o("SE1","mm",10,.1,200,.1),o("SD1","mm",20,1,200,1),o("SD2","mm",10,1,200,1),o("SN1","loops",2,0,8,1),o("SL1","mm",40,1,900,1),o("SL2","mm",70,0,900,1),At("Send",["round","pike"]),oe("thickness"),o("T1","mm",10,1,200,1),o("Dvaxis","mm",260,5,1e3,1)],paramSvg:{D1:"vaxis_guidance_top.svg",N1:"vaxis_guidance_top.svg",D2:"vaxis_guidance_top.svg",D3:"vaxis_guidance_top.svg",D4:"vaxis_guidance_top.svg",L1:"vaxis_guidance_top.svg",R5:"vaxis_guidance_top.svg",D6:"vaxis_guidance_top.svg",N2:"vaxis_guidance_top.svg",orientation:"vaxis_guidance_top.svg",R7:"vaxis_guidance_top.svg",L2:"vaxis_guidance_spring.svg",E2:"vaxis_guidance_spring.svg",SA1:"vaxis_guidance_spring.svg",SE1:"vaxis_guidance_spring.svg",SD1:"vaxis_guidance_spring.svg",SD2:"vaxis_guidance_spring.svg",SN1:"vaxis_guidance_spring.svg",SL1:"vaxis_guidance_spring.svg",SL2:"vaxis_guidance_spring.svg",Send:"vaxis_guidance_spring.svg",T1:"vaxis_guidance_top.svg",Dvaxis:"vaxis_guidance_top.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function Dr(s,e,d=""){const t=be(Ms.partName+d),n=G(),i=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const a=e.D1/2,r=e.D2/2,c=e.D3/2,h=e.D4/2,l=e.D6/2;if(r<l)throw`err466: D6 ${e.D6} is too large compare to D2 ${e.D2}`;t.logstr+=`vaxis_guidance: Dmax ${p(e.D1+2*h)} mm
`;const f=[],[_,u,g]=Ps(e);t.logstr+=_,f.push(u);for(let x=0;x<e.N1;x++)f.push($(a,0,c).rotate(0,0,x*g));const[S,L]=or(e);t.logstr+=S,f.push(L),n.addSecond($(0,0,e.Dvaxis/2)),n.addMainOI(f);const R=a-l+h;i.addMainO(Oe(l,0,R,e.T1)),i.addMainO(Oe(-l-R,0,R,e.T1)),i.addSecond(Oe(a-c,0,2*c,e.T1)),i.addSecond(Oe(-a-c,0,2*c,e.T1)),t.fig={faceTop:n,faceSection:i};const v=t.partName;t.vol={extrudes:[{outName:`subpax_${v}_top`,face:`${v}_faceTop`,extrudeMethod:se.eLinearOrtho,length:e.T1,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${v}`,boolMethod:pe.eIdentity,inList:[`subpax_${v}_top`]}]},t.sub={},t.logstr+=`vaxis_guidance drawn successfully!
`,t.calcErr=!1}catch(a){t.logstr+=a,console.log(a)}return t}var Hr={pTitle:"Vaxis-guidance",pDescription:"The guidance of the V-Axis for the heliostat azimuth",pDef:Ms,pGeom:Dr},ys={partName:"haxis_guidance",params:[o("D5","mm",600,1,2e3,1),o("D8","mm",1e3,1,2e3,1),oe("outer details"),o("E5","mm",1,0,200,1),o("E8","mm",20,1,200,1),o("L5","mm",20,1,200,1),o("R9","mm",20,0,500,1),oe("inner spring"),o("SA1","degree",0,-45,45,1),o("SE1","mm",2,.1,100,.1),o("SD1","mm",20,1,200,1),o("SD2","mm",10,1,200,1),o("SN1","springs",7,1,24,1),o("SL1","mm",60,0,500,1),o("SL2","mm",100,0,500,1),At("Send",["round","pike"]),oe("thickness"),o("L4","mm",400,1,2e3,1)],paramSvg:{D5:"haxis_guidance_outer.svg",D8:"haxis_guidance_outer.svg",E5:"haxis_guidance_outer.svg",E8:"haxis_guidance_outer.svg",L5:"haxis_guidance_outer.svg",R9:"haxis_guidance_outer.svg",SA1:"haxis_guidance_spring.svg",SE1:"haxis_guidance_spring.svg",SD1:"haxis_guidance_spring.svg",SD2:"haxis_guidance_spring.svg",SN1:"haxis_guidance_spring.svg",SL1:"haxis_guidance_spring.svg",SL2:"haxis_guidance_spring.svg",Send:"haxis_guidance_spring.svg",L4:"haxis_guidance_outer.svg"},sim:{tMax:100,tStep:.5,tUpdate:500}};function kr(s,e,d=""){const t=be(ys.partName+d),n=G(),i=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const a=e.D5/2,r=e.D8/2,c=e.SD1/2,h=a+e.E5,l=r-e.E8,f=2*Math.asin(e.L5/(2*h)),_=Math.PI/12+xe(e.SA1),u=Math.PI/2+f-_,g=Math.PI-_,S=Math.PI/2-Math.PI/6+_;if(h+c+e.SE1>l)throw`err411: D8 ${e.D8} is too small compare to D5 ${e.D5}, E5 ${e.E5}, E8 ${e.E8}`;if(2*Math.PI/3-2*f<e.R9/l)throw`err412: L5 ${e.L5} is too large compare to R9 ${e.R9}`;t.logstr+=`haxis_guidance: Dinner ${p(2*h)} mm
`,n.addSecond($(0,0,a)),n.addSecond($(0,0,r));const[L,R]=Eo(e,!1),[,v]=Eo(e,!0);t.logstr+=L;const x=Math.PI/2-f,C=-Math.PI/6+f,T=ae(0,0),w=T.translatePolar(x,h+e.SE1+c),P=w.translatePolar(x-Math.PI/2,c),M=P.translatePolar(x+Math.PI,c+e.SE1),b=P.translatePolar(x+Math.PI,c),j=M.rotate(P,u),O=T.translatePolar(C,h+e.SE1+c),y=O.translatePolar(C+Math.PI/2,c),q=y.translatePolar(C+Math.PI,c+e.SE1),X=y.translatePolar(C+Math.PI,c),N=X.rotate(y,-u),F=B(0,h).addSegStrokeA(M.cx,M.cy).addPointA(j.cx,j.cy).addSegArc(c+e.SE1,!1,!0);F.addPartial(R.rotate(0,0,g).translate(j.cx,j.cy)),F.addPointA(b.cx,b.cy).addPointA(w.cx,w.cy).addSegArc2().addSegStrokeAP(x,l).addCornerRounded(e.R9).addPointAP(C,l).addSegArc(l,!1,!1).addCornerRounded(e.R9).addSegStrokeA(O.cx,O.cy).addPointA(X.cx,X.cy).addPointA(N.cx,N.cy).addSegArc2(),F.addPartial(v.rotate(0,0,S).translate(N.cx,N.cy)),F.addPointA(q.cx,q.cy).addSegArc(c+e.SE1,!1,!0).addSegStrokeAP(-Math.PI/6,h).addSegStrokeAP(-Math.PI/6,r).addPointAP(Math.PI/2,r).addSegArc(r,!1,!0).closeSegStroke(),n.addMainO(F);const W=r*Math.sin(Math.PI/6);i.addMainO(Oe(0,-W,e.L4,r+W)),i.addSecond(Oe(0,-r,e.L4,2*r)),i.addSecond(Oe(0,-a,e.L4,2*a)),t.fig={faceProfile:n,faceSide:i};const K=t.partName;t.vol={extrudes:[{outName:`subpax_${K}_profile`,face:`${K}_faceProfile`,extrudeMethod:se.eLinearOrtho,length:e.L4,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${K}`,boolMethod:pe.eIdentity,inList:[`subpax_${K}_profile`]}]},t.sub={},t.logstr+=`haxis_guidance drawn successfully!
`,t.calcErr=!1}catch(a){t.logstr+=a,console.log(a)}return t}var mr={pTitle:"Haxis-guidance",pDescription:"The guidance of the H-Axis for the heliostat inclination",pDef:ys,pGeom:kr},Ns={partName:"rod",params:[o("L1","mm",1e4,100,4e4,10),o("L2","mm",100,2,400,1),o("L3","mm",400,10,1e3,1),o("L4","mm",600,10,1e3,1),o("N1","",10,2,50,1),oe("section"),o("H1","mm",200,5,4e3,1),o("E1","mm",2,1,80,1),o("E2","mm",10,1,80,1),oe("pad"),o("N3","",2,1,20,1),o("N4","",4,1,20,1),o("R3","mm",100,1,500,1),o("D2","mm",10,1,100,1),o("L7","mm",10,1,300,1)],paramSvg:{L1:"rod_top.svg",L2:"rod_top.svg",L3:"rod_top.svg",L4:"rod_top.svg",H1:"rod_cut.svg",E1:"rod_cut.svg",E2:"rod_cut.svg",N1:"rod_top.svg",N3:"rod_top.svg",N4:"rod_top.svg",R3:"rod_top.svg",D2:"rod_plate.svg",L7:"rod_plate.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function pr(s,e,d=""){const t=be(Ns.partName+d),n=G(),i=G(),a=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const r=e.D2/2,c=e.L3/(e.N3+1),h=e.L4/(e.N4+1);t.logstr+=`rod-length: ${p(e.L1)} mm
`;const l=(e.L1-e.L3)/(e.N1-1);t.logstr+=`space-length: ${p(l)} mm
`;const f=function(P){const M=[],b=B(e.L4/2,P).addCornerRounded(e.R3).addSegStrokeA(e.L4/2,P+e.L3).addCornerRounded(e.R3).addSegStrokeA(-e.L4/2,P+e.L3).addCornerRounded(e.R3).addSegStrokeA(-e.L4/2,P).addCornerRounded(e.R3).closeSegStroke();M.push(b);for(let j=1;j<e.N3+1;j++)M.push($(e.L4/2-e.L7,P+j*c,r)),M.push($(-e.L4/2+e.L7,P+j*c,r));for(let j=1;j<e.N4+1;j++)M.push($(-e.L4/2+j*h,P+e.L7,r)),M.push($(-e.L4/2+j*h,P+e.L3-e.L7,r));return M},_=function(P,M){return B(e.L2/2,P).addSegStrokeA(e.L2/2,P+M).addSegStrokeA(-e.L2/2,P+M).addSegStrokeA(-e.L2/2,P).closeSegStroke()},u=[],g=e.L2/2,S=e.L4/2,L=(e.L2-2*e.E1)/2,R=e.H1-e.E1,v=B(g,0).addSegStrokeA(g,e.H1).addSegStrokeA(-g,e.H1).addSegStrokeA(-g,0).closeSegStroke(),x=B(L,e.E1).addSegStrokeA(L,R).addSegStrokeA(-L,R).addSegStrokeA(-L,e.E1).closeSegStroke(),C=B(S,e.H1).addSegStrokeA(S,e.H1+e.E2).addSegStrokeA(-S,e.H1+e.E2).addSegStrokeA(-S,e.H1).closeSegStroke();u.push(v),u.push(x),n.addSecond(C),n.addMainOI(u),i.addMainOI(f(0)),i.addSecond(_(-e.L3/2,2*e.L3));const T=(e.L1-e.L3)/(e.N1-1);for(let P=0;P<e.N1;P++)a.addMainOI(f(P*T));a.addSecond(_(0,e.L1)),t.fig={faceCut:n,facePlate:i,faceTop:a};const w=t.partName;t.vol={extrudes:[{outName:`subpax_${w}_rod`,face:`${w}_faceCut`,extrudeMethod:se.eLinearOrtho,length:e.L1,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${w}_plates`,face:`${w}_faceTop`,extrudeMethod:se.eLinearOrtho,length:e.E2,rotate:[Math.PI/2,0,0],translate:[0,e.E2+e.H1,0]}],volumes:[{outName:`pax_${w}`,boolMethod:pe.eUnion,inList:[`subpax_${w}_rod`,`subpax_${w}_plates`]}]},t.sub={},t.logstr+=`heliostat-rod drawn successfully!
`,t.calcErr=!1}catch(r){t.logstr+=r,console.log(r)}return t}var br={pTitle:"Heliostat rod",pDescription:"The rod of an heliostat-surface",pDef:Ns,pGeom:pr},$s={partName:"trapeze",params:[o("L1","mm",1600,10,4e3,1),o("L2","mm",1e3,10,4e3,1),o("L3","mm",400,5,800,1),o("L4","mm",300,5,800,1),oe("outer frame"),o("N1","",7,1,20,1),o("N2","",4,1,20,1),o("D1","mm",10,1,40,1),o("L5","mm",100,1,400,1),o("L6","mm",20,1,400,1),o("R1","mm",60,1,400,1),o("R2","mm",20,1,400,1),oe("inner pad"),o("N3","",2,1,20,1),o("N4","",2,1,20,1),o("D2","mm",10,1,40,1),o("L7","mm",20,1,400,1),o("R3","mm",20,1,400,1),oe("diagonal shaft"),o("D3","mm",30,1,100,1),o("D4","mm",26,1,100,1),o("H1","mm",300,.5,800,.5),o("H2","mm",2,.5,800,.5),o("H3","mm",5,.5,800,.5)],paramSvg:{L1:"trapeze_top.svg",L2:"trapeze_top.svg",L3:"trapeze_top.svg",L4:"trapeze_top.svg",N1:"trapeze_top.svg",N2:"trapeze_top.svg",N3:"trapeze_top.svg",N4:"trapeze_top.svg",L5:"trapeze_top.svg",L6:"trapeze_top.svg",L7:"trapeze_top.svg",D1:"trapeze_top.svg",D2:"trapeze_top.svg",D3:"trapeze_rod.svg",D4:"trapeze_rod.svg",R1:"trapeze_top.svg",R2:"trapeze_top.svg",R3:"trapeze_top.svg",H1:"trapeze_side.svg",H2:"trapeze_side.svg",H3:"trapeze_side.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function wr(s,e,d=""){const t=be($s.partName+d);let n,i;const a=G(),r=G(),c=G(),h=G(),l=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{if(e.L3>e.L1-e.L5)throw`err595: L3 ${e.L3} too large compare to L1 ${e.L1} and L5 ${e.L5}`;if(e.L4>e.L2-e.L5)throw`err596: L4 ${e.L4} too large compare to L2 ${e.L2} and L5 ${e.L5}`;if(e.H1-e.H2-e.H3<4*e.D3)throw`err597: H1 ${e.H1} too small compare to H2 ${e.H2}, H3 ${e.H3} and D3 ${e.D3}`;const f=e.R1*(1-1/Math.sqrt(2)),_=e.R3*(1-1/Math.sqrt(2)),u=e.L2/2-f-(e.L4/2-_),g=e.L1/2-f-(e.L3/2-_),S=Math.sqrt(u**2+g**2),L=e.H1-e.H2-e.H3,R=Math.sqrt(S**2+L**2),v=Math.atan2(L,S),x=Math.atan2(g,u);t.logstr+=`rod-slope:  length: ${p(R)} mm,  angle: ${p(Ce(v))} degree
`,t.logstr+=`rod-xy-angle: ${p(Ce(x))} degree
`;const C=e.D3/Math.cos(Math.PI/2-v);t.logstr+=`rod-footprint-length: ${p(C)} mm
`;const T=Math.sqrt((C/2)**2+(e.D3/2)**2),w=Math.atan2(e.D3,C);n=function(V,Z,ee){return B(V,Z).addPointRP(ee+Math.PI-w,T).addSeg2Arcs(ee+Math.PI/2,ee).addPointRP(ee+Math.PI+w,T).addSeg2Arcs(ee+Math.PI,ee+Math.PI/2).addPointRP(ee-w,T).addSeg2Arcs(ee+3*Math.PI/2,ee+Math.PI).addPointRP(ee+w,T).addSeg2Arcs(ee,ee-Math.PI/2)},i=function(V,Z,ee){const He=V+T*Math.cos(ee+Math.PI-w),Le=Z+T*Math.sin(ee+Math.PI-w);return B(He,Le).addSegStrokeRP(ee+Math.PI,S).addSegStrokeRP(ee-Math.PI/2,e.D3).addSegStrokeRP(ee,S).closeSegStroke()};const P=[];if(e.R1>e.L1/4||e.R1>e.L2/4)throw`err614: R1 ${e.R1} too large compare to L1 ${e.L1} or L2 ${e.L2}`;const M=B(e.L2/2,e.L1/2).addSegStrokeA(-e.L2/2,e.L1/2).addCornerRounded(e.R1).addSegStrokeA(-e.L2/2,-e.L1/2).addCornerRounded(e.R1).addSegStrokeA(e.L2/2,-e.L1/2).addCornerRounded(e.R1).closeSegStroke().addCornerRounded(e.R1);if(e.R2>(e.L1-2*e.L5)/4||e.R2>(e.L2-2*e.L5)/4)throw`err627: R2 ${e.R2} too large compare to L1 ${e.L1}, L2 ${e.L2} and L5 ${e.L5}`;const b=B(e.L2/2-e.L5,e.L1/2-e.L5).addSegStrokeA(-e.L2/2+e.L5,e.L1/2-e.L5).addCornerRounded(e.R2).addSegStrokeA(-e.L2/2+e.L5,-e.L1/2+e.L5).addCornerRounded(e.R2).addSegStrokeA(e.L2/2-e.L5,-e.L1/2+e.L5).addCornerRounded(e.R2).closeSegStroke().addCornerRounded(e.R2);if(e.R3>e.L3/4||e.R3>e.L4/4)throw`err639: R3 ${e.R3} too large compare to L3 ${e.L3} or L4 ${e.L4}`;const j=B(e.L4/2,e.L3/2).addSegStrokeA(-e.L4/2,e.L3/2).addCornerRounded(e.R3).addSegStrokeA(-e.L4/2,-e.L3/2).addCornerRounded(e.R3).addSegStrokeA(e.L4/2,-e.L3/2).addCornerRounded(e.R3).closeSegStroke().addCornerRounded(e.R3);P.push(M),P.push(b),a.addSecond(j);const O=e.L1/(e.N1+1),y=e.L2/(e.N2+1),q=e.L3/(e.N3+1),X=e.L4/(e.N4+1);if(e.L5<e.D1/2+e.L6)throw`err658: L5 ${e.L5} too small compare to D1 ${e.D1} or L6 ${e.L6}`;if(q<e.D2/2+e.L7)throw`err661: D2 ${e.D2} or L7 ${e.L7} too large compare to L3 ${e.l3}`;if(X<e.D2/2+e.L7)throw`err664: D2 ${e.D2} or L7 ${e.L7} too large compare to L4 ${e.l4}`;const N=[];for(let V=1;V<e.N1+1;V++)N.push($(e.L2/2-e.L6,-e.L1/2+V*O,e.D1/2)),N.push($(-e.L2/2+e.L6,-e.L1/2+V*O,e.D1/2));for(let V=1;V<e.N2+1;V++)N.push($(-e.L2/2+V*y,e.L1/2-e.L6,e.D1/2)),N.push($(-e.L2/2+V*y,-e.L1/2+e.L6,e.D1/2));const F=[];for(let V=1;V<e.N3+1;V++)F.push($(e.L4/2-e.L7,-e.L3/2+V*q,e.D2/2)),F.push($(-e.L4/2+e.L7,-e.L3/2+V*q,e.D2/2));for(let V=1;V<e.N4+1;V++)F.push($(-e.L4/2+V*X,e.L3/2-e.L7,e.D2/2)),F.push($(-e.L4/2+V*X,-e.L3/2+e.L7,e.D2/2));N.forEach(V=>{P.push(V)}),F.forEach(V=>{a.addSecond(V)}),a.addMainOI(P);const W=[];W.push(n(e.L2/2-f,e.L1/2-f,x)),W.push(n(e.L4/2-_,e.L3/2-_,x)),W.push(n(-e.L2/2+f,e.L1/2-f,Math.PI-x)),W.push(n(-e.L4/2+_,e.L3/2-_,Math.PI-x)),W.push(n(-e.L2/2+f,-e.L1/2+f,Math.PI+x)),W.push(n(-e.L4/2+_,-e.L3/2+_,Math.PI+x)),W.push(n(e.L2/2-f,-e.L1/2+f,-x)),W.push(n(e.L4/2-_,-e.L3/2+_,-x));const K=[];K.push(i(e.L2/2-f,e.L1/2-f,x)),K.push(i(-e.L2/2+f,e.L1/2-f,Math.PI-x)),K.push(i(-e.L2/2+f,-e.L1/2+f,Math.PI+x)),K.push(i(e.L2/2-f,-e.L1/2+f,-x)),W.forEach(V=>{a.addSecond(V)}),K.forEach(V=>{a.addSecond(V)});const z=[];if(z.push(j),F.forEach(V=>{z.push(V)}),r.addSecond(M),r.addSecond(b),N.forEach(V=>{r.addSecond(V)}),W.forEach(V=>{r.addSecond(V)}),K.forEach(V=>{r.addSecond(V)}),r.addMainOI(z),e.D4>=e.D3)throw`err218: D4 ${e.D4} larger than D3 ${e.D3}`;c.addMainO($(0,0,e.D3/2)),c.addSecond($(0,0,e.D4/2)),h.addMainO($(0,0,e.D4/2)),h.addSecond($(0,0,e.D3/2));const I=e.D3*Math.cos(v),U=I/Math.tan(v),D=_+(C/2+U)*Math.cos(x),Y=_+(C/2+U)*Math.sin(x),E=R+2*(C+U+I),Q=E+e.L3+e.L4+I,ie=B(Q,Q).addSegStrokeA(-Q,Q).addSegStrokeA(-Q,-Q).addSegStrokeA(Q,-Q).closeSegStroke();l.addMainO(ie),t.fig={faceFrame:a,facePlate:r,faceRod:c,faceRodHollow:h,faceCutRod:l};const J=t.partName;t.vol={extrudes:[{outName:`subpax_${J}_frame`,face:`${J}_faceFrame`,extrudeMethod:se.eLinearOrtho,length:e.H2,rotate:[0,0,0],translate:[0,0,e.H1-e.H2]},{outName:`subpax_${J}_plate`,face:`${J}_facePlate`,extrudeMethod:se.eLinearOrtho,length:e.H3,rotate:[0,0,0],translate:[0,0,0]},{outName:`subpax_${J}_rod1`,face:`${J}_faceRod`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,x],translate:[e.L4/2-D,e.L3/2-Y,e.H3-I]},{outName:`subpax_${J}_rod2`,face:`${J}_faceRod`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,Math.PI-x],translate:[-e.L4/2+D,e.L3/2-Y,e.H3-I]},{outName:`subpax_${J}_rod3`,face:`${J}_faceRod`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,Math.PI+x],translate:[-e.L4/2+D,-e.L3/2+Y,e.H3-I]},{outName:`subpax_${J}_rod4`,face:`${J}_faceRod`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,-x],translate:[e.L4/2-D,-e.L3/2+Y,e.H3-I]},{outName:`subpax_${J}_rodH1`,face:`${J}_faceRodHollow`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,x],translate:[e.L4/2-D,e.L3/2-Y,e.H3-I]},{outName:`subpax_${J}_rodH2`,face:`${J}_faceRodHollow`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,Math.PI-x],translate:[-e.L4/2+D,e.L3/2-Y,e.H3-I]},{outName:`subpax_${J}_rodH3`,face:`${J}_faceRodHollow`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,Math.PI+x],translate:[-e.L4/2+D,-e.L3/2+Y,e.H3-I]},{outName:`subpax_${J}_rodH4`,face:`${J}_faceRodHollow`,extrudeMethod:se.eLinearOrtho,length:E,rotate:[0,Math.PI/2-v,-x],translate:[e.L4/2-D,-e.L3/2+Y,e.H3-I]},{outName:`subpax_${J}_cut1`,face:`${J}_faceCutRod`,extrudeMethod:se.eLinearOrtho,length:Q,rotate:[0,0,0],translate:[0,0,-Q]},{outName:`subpax_${J}_cut2`,face:`${J}_faceCutRod`,extrudeMethod:se.eLinearOrtho,length:Q,rotate:[0,0,0],translate:[0,0,e.H1]}],volumes:[{outName:`ipax_${J}_rawRod`,boolMethod:pe.eUnion,inList:[`subpax_${J}_rod1`,`subpax_${J}_rod2`,`subpax_${J}_rod3`,`subpax_${J}_rod4`]},{outName:`ipax_${J}_rodHollow`,boolMethod:pe.eUnion,inList:[`subpax_${J}_rodH1`,`subpax_${J}_rodH2`,`subpax_${J}_rodH3`,`subpax_${J}_rodH4`]},{outName:`ipax_${J}_halfRods`,boolMethod:pe.eSubstraction,inList:[`ipax_${J}_rawRod`,`subpax_${J}_cut1`]},{outName:`ipax_${J}_rods`,boolMethod:pe.eSubstraction,inList:[`ipax_${J}_halfRods`,`subpax_${J}_cut2`]},{outName:`ipax_${J}_plus`,boolMethod:pe.eUnion,inList:[`subpax_${J}_frame`,`subpax_${J}_plate`,`ipax_${J}_rods`]},{outName:`pax_${J}`,boolMethod:pe.eSubstraction,inList:[`ipax_${J}_plus`,`ipax_${J}_rodHollow`]}]},t.sub={},t.logstr+=`trapeze drawn successfully!
`,t.calcErr=!1}catch(f){t.logstr+=f,console.log(f)}return t}var Rr={pTitle:"Heliostat trapeze",pDescription:"The support of one solar panel. Made out of aluminium for lightness and cooling",pDef:$s,pGeom:wr},Es={partName:"surface",params:[o("LH","mm",1600,10,4e3,1),o("LV","mm",1e3,10,4e3,1),o("LZ","mm",40,0,100,1),o("nx","",9,1,40,1),o("ny","",9,1,40,1),oe("main fantasia"),At("main_direction",["horizontal","vertical"]),ct("crenel",!1),o("first_row","",9,1,40,1),o("second_row","",9,1,40,1),oe("horizontal spacing"),o("EH","mm",10,0,1e3,1),ct("EH_gradient",!1),o("EH_sup","mm",500,0,1e3,1),o("EH_cycle","",1,0,3,.05),o("EH_start","",0,0,1,.05),At("EH_shape",["sinusoid","triangle","sawUp","sawDown"]),oe("vertical spacing"),o("EV","mm",10,0,1e3,1),ct("EV_gradient",!1),o("EV_sup","mm",500,0,1e3,1),o("EV_cycle","",1,0,3,.05),o("EV_start","",0,0,1,.05),At("EV_shape",["sinusoid","triangle","sawUp","sawDown"]),oe("solar power"),o("power_efficiency","%",16,0,100,.1),o("solar_power","W/m2",816,100,2e3,1)],paramSvg:{LH:"surface_main.svg",LV:"surface_main.svg",LZ:"surface_lz.svg",nx:"surface_main.svg",ny:"surface_main.svg",main_direction:"surface_crenel.svg",crenel:"surface_crenel.svg",first_row:"surface_extremities.svg",second_row:"surface_extremities.svg",EH:"surface_main.svg",EH_gradient:"surface_space_evolution.svg",EH_sup:"surface_space_evolution.svg",EH_cycle:"surface_space_evolution.svg",EH_start:"surface_space_evolution.svg",EH_shape:"surface_space_shape.svg",EV:"surface_main.svg",EV_gradient:"surface_space_evolution.svg",EV_sup:"surface_space_evolution.svg",EV_cycle:"surface_space_evolution.svg",EV_start:"surface_space_evolution.svg",EV_shape:"surface_space_shape.svg",power_efficiency:"surface_power.svg",solar_power:"surface_power.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Ar(s,e,d=""){const t=be(Es.partName+d);let n;const i=G(),a=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const r=e.LH*e.LV/1e6,c=e.solar_power*r*e.power_efficiency/100;t.logstr+=`panel surface: ${p(r)} m2
`,t.logstr+=`panel power: ${p(c)} W
`;const h=e.nx*e.ny;t.logstr+=`max panel number: ${h}
`,t.logstr+=`max panel surface: ${p(h*r)} m2
`,t.logstr+=`max panel power: ${p(h*c)} W
`;const l=e.main_direction===1?e.ny:e.nx,f=e.main_direction===1?e.nx:e.ny,_=e.main_direction===1?e.EV:e.EH,u=e.main_direction===1?e.EV_gradient:e.EH_gradient,g=e.main_direction===1?e.EV_sup:e.EH_sup,S=e.main_direction===1?e.EV_cycle:e.EH_cycle,L=e.main_direction===1?e.EV_start:e.EH_start,R=e.main_direction===1?e.EV_shape:e.EH_shape,v=e.main_direction===0?e.EV:e.EH,x=e.main_direction===0?e.EV_gradient:e.EH_gradient,C=e.main_direction===0?e.EV_sup:e.EH_sup,T=e.main_direction===0?e.EV_cycle:e.EH_cycle,w=e.main_direction===0?e.EV_start:e.EH_start,P=e.main_direction===0?e.EV_shape:e.EH_shape,M=Math.max(f,e.first_row,e.second_row),b=[];for(let E=0;E<l;E++){const Q=(E+1)%2,ie=e.crenel?f-Q:f;b.push(ie)}b[0]=e.first_row,b[b.length-1]=e.first_row,l>2&&(b[1]=e.second_row,b[b.length-2]=e.second_row);let j=0;b.forEach(E=>{j+=E}),t.logstr+=`actual panel number: ${j} (${p(100*j/h)} %)
`,t.logstr+=`actual panel surface: ${p(j*r)} m2
`,t.logstr+=`actual panel power: ${p(j*c)} W
`;const O=[];for(let E=0;E<l-1;E++){let Q=_;if(u===1){const ie=l>2?l-2:1,J=(L+E*S/ie)%1;switch(R){case 0:Q+=g*(1-Math.cos(J*2*Math.PI))/2;break;case 1:Q+=g*(1-2*Math.abs(J-.5));break;case 2:Q+=g*J;break;case 3:Q+=g*(1-J);break;default:Q+=g}}O.push(Q)}let y=0;const q=[];q.push(0),O.forEach(E=>{y+=E,q.push(y)});const X=[];for(let E=0;E<M-1;E++){let Q=v;if(x===1){const ie=M>2?M-2:1,J=(w+E*T/ie)%1;switch(P){case 0:Q+=C*(1-Math.cos(J*2*Math.PI))/2;break;case 1:Q+=C*(1-2*Math.abs(J-.5));break;case 2:Q+=C*J;break;case 3:Q+=C*(1-J);break;default:Q+=C}}X.push(Q)}let N=0;const F=[];F.push(0),X.forEach(E=>{N+=E,F.push(N)});let W=0,K=0;e.main_direction===0?(W=l*e.LH+y,K=M*e.LV+N):(W=M*e.LH+N,K=l*e.LV+y);const z=W*K/10**6;t.logstr+=`global horizontal width: ${p(W/1e3)} m
`,t.logstr+=`global vertical height: ${p(K/1e3)} m
`,t.logstr+=`global area: ${p(z)} m2
`,t.logstr+=`area efficiency: ${p(100*j*r/z)} %
`;const I=-W/2,U=-K/2;n=function(E,Q){return B(E,Q).addSegStrokeA(E+e.LH,Q).addSegStrokeA(E+e.LH,Q+e.LV).addSegStrokeA(E,Q+e.LV).closeSegStroke()};const D=[];b.forEach((E,Q)=>{const ie=(M-E)%2,J=Math.floor((M-E)/2);for(let V=0;V<E;V++){let Z=0,ee=0;e.main_direction===0?(Z=I+Q*e.LH+q[Q],ee=U+(J+V)*e.LV+F[J+V],ie===1&&(ee+=(e.LV+F[J+V+1]-F[J+V])/2)):(ee=U+Q*e.LV+q[Q],Z=I+(J+V)*e.LH+F[J+V],ie===1&&(Z+=(e.LH+F[J+V+1]-F[J+V])/2)),D.push([Z,ee])}});for(const E of D)i.addMainO(n(E[0],E[1]));a.addMainO(n(0,0)),t.fig={faceSurface:i,faceOnePanel:a};const Y=t.partName;t.vol={extrudes:D.map((E,Q)=>({outName:`subpax_${Y}_panel_${Q}`,face:`${Y}_faceOnePanel`,extrudeMethod:se.eLinearOrtho,length:e.LZ,rotate:[0,0,0],translate:[E[0],E[1],0]})),volumes:[{outName:`pax_${Y}`,boolMethod:pe.eUnion,inList:D.map((E,Q)=>`subpax_${Y}_panel_${Q}`)}]},t.sub={},t.logstr+=`panel-surface drawn successfully!
`,t.calcErr=!1}catch(r){t.logstr+=r,console.log(r)}return t}var Mr={pTitle:"Heliostat panel-surface",pDescription:"The surface collecting the solar power",pDef:Es,pGeom:Ar},Yo={partName:"circles",params:[o("angle","degree",15,5,45,1),o("amplitude-offset","mm",1,.5,4,.1),o("amplitude-scale","scalar",.2,.1,.5,.01)],paramSvg:{angle:"circles_angle.svg","amplitude-offset":"circles_amplitude-offset.svg","amplitude-scale":"circles_amplitude-scale.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function yr(s,e,d=""){const t=be(Yo.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=ae(10,10),a=ae(10,30);n.addPoint(a);for(let r=0;r<20;r++)n.addPoint(i.scale(a,e["amplitude-offset"]+e["amplitude-scale"]*r).rotate(a,r*xe(e.angle)+s*Math.PI/2/Yo.sim.tMax));t.fig={one:n},t.logstr+=`Circles drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var Nr={pTitle:"Circles",pDescription:"A spiral made by points.",pDef:Yo,pGeom:yr},Cs={partName:"rectangle",params:[o("width","mm",15,3,40,.5),o("height","mm",10,3,40,.5)],paramSvg:{width:"rectangle_width.svg",height:"rectangle_height.svg"},sim:{tMax:120,tStep:1,tUpdate:500}};function $r(s,e,d=""){const t=be(Cs.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=ae(10,10),a=ae(10+e.width,10),r=ae(10+e.width,10+e.height),c=ae(10,10+e.height),h=s*Math.PI/180;n.addPoint(i),n.addPoint(a.rotate(i,h)),n.addPoint(r.rotate(i,h)),n.addPoint(c.rotate(i,h)),t.fig={one:n},t.logstr+=`Rectangle drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var Er={pTitle:"Rectangle",pDescription:"Just a rectangle.",pDef:Cs,pGeom:$r},Os={partName:"voila",params:[o("H1","mm",40,1,4e3,1),o("H2","mm",50,1,4e3,1),o("radius","mm",10,1,4e3,1),oe("corners"),o("Rc","mm",10,0,400,1)],paramSvg:{H1:"voila_face.svg",H2:"voila_face.svg",radius:"voila_face.svg",Rc:"voila_face.svg"},sim:{tMax:180,tStep:.5,tUpdate:500}};function Cr(s,e,d=""){const t=be(Os.partName+d),n=G();t.logstr+=`${t.partName} simTime: ${s}
`;try{const i=[],a=B(-e.H1/2,-e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(e.H1/2,-e.H2/2).addSegStrokeA(e.H1/2,e.H2/2).addCornerRounded(e.Rc).addSegStrokeA(-e.H1/2,e.H2/2).closeSegStroke();i.push(a),i.push($(0,0,e.radius)),n.addMainOI(i),t.fig={faceVoila:n};const r=t.partName;t.vol={extrudes:[{outName:`subpax_${r}_top`,face:`${r}_faceVoila`,extrudeMethod:se.eLinearOrtho,length:10,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${r}`,boolMethod:pe.eIdentity,inList:[`subpax_${r}_top`]}]},t.sub={},t.logstr+=`voila drawn successfully!
`,t.calcErr=!1}catch(i){t.logstr+=i,console.log(i)}return t}var Or={pTitle:"voila",pDescription:"A simple design for testing exports",pDef:Os,pGeom:Cr},Is={partName:"verify_point",params:[o("p1x","mm",30,-200,200,1),o("p1y","mm",50,-200,200,1),o("p2a","degree",30,-200,200,1),o("p2l","mm",60,0,200,1),o("rotateOrig","degree",45,-200,200,1),o("scaleOrig","scalar",1.5,.1,2,.1)],paramSvg:{p1x:"verify_point_p1x.svg",p1y:"verify_point_p1x.svg",p2a:"verify_point_p1x.svg",p2l:"verify_point_p1x.svg",rotateOrig:"verify_point_p1x.svg",scaleOrig:"verify_point_p1x.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function Ir(s,e,d=""){const t=be(Is.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=ae(e.p1x,e.p1y+s),a=ae(0,0).setPolar(xe(e.p2a),e.p2l),r=i.rotateOrig(xe(e.rotateOrig)),c=i.scaleOrig(e.scaleOrig);n.addPoint(i),n.addPoint(a),n.addPoint(r),n.addPoint(c),t.fig={one:n},t.logstr+=`verify_point drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var Vr={pTitle:"Verify point",pDescription:"Debugging point.ts",pDef:Is,pGeom:Ir},Vs={partName:"verify_point_2",params:[o("p1x","mm",30,-200,200,1),o("p1y","mm",50,-200,200,1),o("p2x","mm",-10,-200,200,1),o("p2y","mm",60,-200,200,1),o("p3x","mm",70,-200,200,1),o("p3y","mm",-20,-200,200,1),o("dist","mm",50,0,200,1)],paramSvg:{p1x:"verify_line_p1x.svg",p1y:"verify_line_p1x.svg",p2x:"verify_line_p1x.svg",p2y:"verify_line_p1x.svg",p3x:"verify_line_p1x.svg",p3y:"verify_line_p1x.svg",dist:"default_param_blank.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function Tr(s,e,d=""){const t=be(Vs.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=ae(e.p1x,e.p1y+s),a=ae(e.p2x,e.p2y),r=ae(e.p3x,e.p3y),c=i.middlePoint(a),h=i.equidistantPoint(a,e.dist,r);n.addPoint(i),n.addPoint(a),n.addPoint(r),n.addPoint(c),n.addPoint(h),t.fig={one:n},t.logstr+=`verify_point_2 drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var jr={pTitle:"Verify point 2",pDescription:"Debugging more point.ts",pDef:Vs,pGeom:Tr},Ts={partName:"verify_line",params:[o("p1x","mm",30,-200,200,1),o("p1y","mm",50,-200,200,1),o("p2x","mm",40,-200,200,1),o("p2y","mm",-20,-200,200,1),o("p3x","mm",-30,-200,200,1),o("p3y","mm",30,-200,200,1)],paramSvg:{p1x:"verify_line_p1x.svg",p1y:"verify_line_p1x.svg",p2x:"verify_line_p1x.svg",p2y:"verify_line_p1x.svg",p3x:"verify_line_p1x.svg",p3y:"verify_line_p1x.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function Fr(s,e,d=""){const t=be(Ts.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=ae(e.p1x,e.p1y+s),a=ae(e.p2x,e.p2y),r=ae(e.p3x,e.p3y);n.addPoint(i),n.addPoint(a),n.addPoint(r);const c=zo(0,0,0).setFromPoints(i,a);n.addLine(c),n.addPoint(ae(c.getAxisXIntersection(),0)),n.addPoint(ae(0,c.getAxisYIntersection()));const h=c.projectOrig();n.addPoint(h);const l=ae(0,0);if(!l.isEqual(h)){const f=on(l,h);n.addLine(f)}n.addLine(c.lineOrthogonal(r)),n.addLine(c.lineParallel(r)),n.addPoint(c.projectPoint(r)),t.fig={one:n},t.logstr+=`dist(l1, p3) = ${c.distanceToPoint(r)}
`,t.logstr+=`verify_line drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var Br={pTitle:"Verify line",pDescription:"Debugging line.ts",pDef:Ts,pGeom:Fr},js={partName:"verify_line_2",params:[o("l1cx","mm",10,-200,200,1),o("l1cy","mm",20,-200,200,1),o("l1ca","degree",15,-200,200,1),o("l2cx","mm",30,-200,200,1),o("l2cy","mm",50,-200,200,1),o("l2ca","degree",35,-200,200,1),o("p3x","mm",-30,-200,200,1),o("p3y","mm",30,-200,200,1)],paramSvg:{l1cx:"verify_line_2_l1cx.svg",l1cy:"verify_line_2_l1cx.svg",l1ca:"verify_line_2_l1cx.svg",l2cx:"verify_line_2_l1cx.svg",l2cy:"verify_line_2_l1cx.svg",l2ca:"verify_line_2_l1cx.svg",p3x:"verify_line_2_l1cx.svg",p3y:"verify_line_2_l1cx.svg"},sim:{tMax:100,tStep:.1,tUpdate:500}};function zr(s,e,d=""){const t=be(js.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=ae(e.l1cx,e.l1cy),a=ae(e.l2cx,e.l2cy),r=ae(e.p3x,e.p3y);n.addPoint(i),n.addPoint(a),n.addPoint(r);const c=zo(e.l1cx,e.l1cy,xe(e.l1ca+s)),h=zo(e.l2cx,e.l2cy,xe(e.l2ca));n.addLine(c),n.addLine(h),n.addPoint(c.intersection(h)),n.addPoint(c.projectPoint(r)),t.logstr+=`dist(l1, p3) = ${c.distanceToPoint(r)}
`,n.addPoint(h.projectPoint(r)),t.logstr+=`dist(l2, p3) = ${h.distanceToPoint(r)}
`;const l=c.bisector(h,r),f=ae(l.cx,l.cy).translatePolar(l.ca,30);n.addPoint(f),t.fig={one:n},t.logstr+=`verify_line_2 drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var Gr={pTitle:"Verify line 2",pDescription:"Debugging more line.ts",pDef:js,pGeom:zr},Fs={partName:"verify_line_3",params:[o("p1x","mm",30,-200,200,1),o("p1y","mm",50,-200,200,1),o("p2x","mm",40,-200,200,1),o("p2y","mm",-20,-200,200,1),o("p3x","mm",-30,-200,200,1),o("p3y","mm",30,-200,200,1)],paramSvg:{p1x:"verify_line_p1x.svg",p1y:"verify_line_p1x.svg",p2x:"verify_line_p1x.svg",p2y:"verify_line_p1x.svg",p3x:"verify_line_p1x.svg",p3y:"verify_line_p1x.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function Jr(s,e,d=""){const t=be(Fs.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=ae(e.p1x,e.p1y+s),a=ae(e.p2x,e.p2y),r=ae(e.p3x,e.p3y);n.addPoint(i),n.addPoint(a),n.addPoint(r);const c=sn(i,a);n.addLine(c);const h=nn(i,a,r);n.addPoint(h),t.fig={one:n},t.logstr+=`verify_line_3 drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var Ur={pTitle:"Verify line 3",pDescription:"Debugging more more line.ts",pDef:Fs,pGeom:Jr},Bs={partName:"verify_vector",params:[o("p1x","mm",30,-200,200,1),o("p1y","mm",50,-200,200,1),o("p2x","mm",80,-200,200,1),o("p2y","mm",-30,-200,200,1),o("v1a","degree",30,-200,200,1),o("v1l","mm",60,0,200,1),o("v2a","degree",30,-200,200,1),o("v2l","mm",60,0,200,1)],paramSvg:{p1x:"verify_vector_p1x.svg",p1y:"verify_vector_p1x.svg",p2x:"verify_vector_p1x.svg",p2y:"verify_vector_p1x.svg",v1a:"verify_vector_p1x.svg",v1l:"verify_vector_p1x.svg",v2a:"verify_vector_p1x.svg",v2l:"verify_vector_p1x.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function Wr(s,e,d=""){const t=be(Bs.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=ae(e.p1x,e.p1y+s),a=ae(e.p2x,e.p2y),r=os(xe(e.v1a),e.v1l,i),c=os(xe(e.v2a),e.v2l,i);n.addPoint(i),n.addPoint(a),n.addVector(r),n.addVector(c);const h=r.add(c),l=h.translatePoint(a);n.addVector(h),n.addPoint(l),t.fig={one:n},t.logstr+=`verify_vector drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var qr={pTitle:"Verify vector",pDescription:"Debugging vector.ts",pDef:Bs,pGeom:Wr},zs={partName:"verify_contour_1",params:[o("r1","mm",30,10,200,1),o("d1","mm",20,10,200,1),o("w1","mm",100,10,200,1),o("r2","mm",60,10,200,1),o("l1","mm",10,5,200,1),o("l2","mm",30,5,200,1)],paramSvg:{r1:"verify_contour_1_r1.svg",d1:"verify_contour_1_r1.svg",w1:"verify_contour_1_r1.svg",r2:"verify_contour_1_r1.svg",l1:"verify_contour_1_l1.svg",l2:"verify_contour_1_l1.svg"},sim:{tMax:10,tStep:.5,tUpdate:500}};function Xr(s,e,d=""){const t=be(zs.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=e.r1,a=e.d1,r=e.w1,c=e.r2,h=e.l1,l=e.l2,f=6*i+4*a,_=r/2,u=a+i,g=2*i+a,S=u+g,L=u+2*g,R=B(0,0);R.addSegStrokeA(r,0),R.addSegStrokeA(r,f),R.addSegStrokeA(0,f),R.closeSegStroke(),R.check(),n.addMainOI([R,$(_,u,i),$(_,S,i+s),$(_,L,i)]);const v=$(r+c,3*u,c);v.check(),n.addSecond(v);const x=B(200+h,200).addSegStrokeA(200+h+l,200).addSegStrokeR(0,h).addSegStrokeRP(0,h).addSegStrokeRP(Math.PI/2,l).addSegStrokeAP(Math.PI/4,Math.sqrt(2)*(200+h+l)).addSegStrokeA(200+h+l,200+2*h+l).addSegStrokeR(-l,0).addSegStrokeR(0,-h).addSegStrokeR(-h,0).addSegStrokeRP(-Math.PI/2,l).addSegStrokeR(h,0).closeSegStroke();x.check(),n.addSecond(x),t.fig={one:n},t.logstr+=`verify_contour_1 drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var Yr={pTitle:"Verify contour 1",pDescription:"Debugging contour.ts",pDef:zs,pGeom:Xr},Gs={partName:"verify_contour_2",params:[o("r1","mm",20,5,200,1),o("a1","deg",30,-200,200,1),o("at1","deg",30,-200,200,1),o("at2","deg",50,-200,200,1)],paramSvg:{r1:"verify_contour_1_r1.svg",a1:"verify_contour_1_r1.svg",at1:"verify_contour_1_r1.svg",at2:"verify_contour_1_r1.svg"},sim:{tMax:10,tStep:.5,tUpdate:500}};function Zr(s,e,d=""){const t=be(Gs.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=[],i=G(),a=e.r1+s,r=e.a1+s,c=e.at1+s,h=e.at2+s,l=B(20,20);l.addSegStrokeA(40,20),l.addPointA(60,20).addSegArc(a,!0,!0),l.addPointA(80,20).addSegArc(a,!0,!1),l.addPointA(100,20).addSegArc(a,!1,!0),l.addPointA(120,20).addSegArc(a,!1,!1),l.addSegStrokeA(140,20),l.addSegStrokeA(140,40),l.addPointA(140,60).addSegArc(a,!0,!0),l.addPointA(140,80).addSegArc(a,!0,!1),l.addPointA(140,100).addSegArc(a,!1,!0),l.addPointA(140,120).addSegArc(a,!1,!1),l.addSegStrokeA(140,140),l.addSegStrokeA(120,140),l.addPointA(100,140).addSegArc(a,!0,!0),l.addPointA(80,140).addSegArc(a,!0,!1),l.addPointA(60,140).addSegArc(a,!1,!0),l.addPointA(40,140).addSegArc(a,!1,!1),l.addSegStrokeA(20,140),l.addSegStrokeA(20,120),l.addPointA(20,100).addSegArc(a,!0,!0),l.addPointA(20,80).addSegArc(a,!0,!1),l.addPointA(20,60).addSegArc(a,!1,!0),l.addPointA(20,40).addSegArc(a,!1,!1),l.closeSegStroke(),l.check(),n.push(l),i.addMainOI(n);const f=B(20,-20);f.addSegStrokeA(40,-40),f.addPointA(60,-60).addSegArc(a,!0,!0),f.addPointA(80,-80).addSegArc(a,!0,!1),f.addPointA(100,-100).addSegArc(a,!1,!0),f.addPointA(120,-120).addSegArc(a,!1,!1),f.addSegStrokeA(140,-140),f.addSegStrokeR(20,20).addPointR(20,20).addSegArc(a,!1,!1).addPointRP(Math.PI/4,28).addSegArc(a,!1,!0).addPointRP(Math.PI/4,28).addSegArc(a,!0,!0).addPointRP(Math.PI/4,28).addSegArc(a,!0,!1).addSegStrokeRP(Math.PI/4,20).addSegStrokeRP(-Math.PI/4,20).addPointR(10,-9).addPointR(20,-20).addSegArc2().addPointR(20,-9).addPointR(20,-20).addSegArc2().addPointR(9,-6).addPointR(20,-20).addSegArc2().addPointR(9,-14).addPointR(20,-20).addSegArc2().addPointR(9,0).addPointR(20,-20).addSegArc2().addSegStrokeR(20,-20).addSegStrokeR(20,20).addPointR(9,20).addPointR(20,20).addSegArc2().addPointR(20,10).addPointR(20,20).addSegArc2().addPointR(9,6).addPointR(20,20).addSegArc2().addPointR(9,14).addPointR(20,20).addSegArc2().addPointR(9,0).addPointR(20,20).addSegArc2().addSegStrokeR(20,20).addSegStrokeR(0,20).addPointR(15,8).addPointR(0,20).addSegArc2().addPointR(-15,8).addPointR(0,20).addSegArc2().addPointR(5,8).addPointR(0,20).addSegArc2().addPointR(-5,8).addPointR(0,20).addSegArc2().addSegStrokeR(0,20).addSegStrokeR(20,0).addPointR(8,15).addPointR(20,0).addSegArc2().addPointR(8,-15).addPointR(20,0).addSegArc2().addPointR(8,5).addPointR(20,0).addSegArc2().addPointR(8,-5).addPointR(20,0).addSegArc2().addSegStrokeR(20,0).addSegStrokeR(0,-20).addPointR(15,-8).addPointR(0,-20).addSegArc2().addPointR(-15,-8).addPointR(0,-20).addSegArc2().addPointR(5,-8).addPointR(0,-20).addSegArc2().addPointR(-5,-8).addPointR(0,-20).addSegArc2().addSegStrokeR(0,-20).addSegStrokeR(-20,0).addPointR(-8,15).addPointR(-20,0).addSegArc2().addPointR(-8,-15).addPointR(-20,0).addSegArc2().addPointR(-8,5).addPointR(-20,0).addSegArc2().addPointR(-8,-5).addPointR(-20,0).addSegArc2().addSegStrokeR(-20,0).closeSegStroke(),f.check(),i.addMainO(f);const _=B(200,200).addSegStrokeR(20,0).addPointR(20,0).addSegArc3(xe(r),!0).addSegStrokeR(20,0).addPointR(20,0).addSegArc3(xe(r),!1).addSegStrokeR(20,0).addSegStrokeR(0,20).addPointR(0,20).addSegArc3(xe(r),!0).addSegStrokeR(0,20).addPointR(0,20).addSegArc3(xe(r),!1).addSegStrokeR(0,20).addSegStrokeR(-20,0).addPointR(-20,0).addSegArc3(xe(r),!0).addSegStrokeR(-20,0).addPointR(-20,0).addSegArc3(xe(r),!1).addSegStrokeR(-20,0).addSegStrokeR(0,-20).addPointR(0,-20).addSegArc3(xe(r),!0).addSegStrokeR(0,-20).addPointR(0,-20).addSegArc3(xe(r),!1).addSegStrokeR(0,-20);_.check(),i.addMainO(_);const u=B(600,200).addSegStrokeR(20,20).addPointR(20,20).addSegArc3(xe(r),!0).addSegStrokeR(20,20).addPointR(20,20).addSegArc3(xe(r),!1).addSegStrokeR(20,20).addSegStrokeR(-20,20).addPointR(-20,20).addSegArc3(xe(r),!0).addSegStrokeR(-20,20).addPointR(-20,20).addSegArc3(xe(r),!1).addSegStrokeR(-20,20).addSegStrokeR(-20,-20).addPointR(-20,-20).addSegArc3(xe(r),!0).addSegStrokeR(-20,-20).addPointR(-20,-20).addSegArc3(xe(r),!1).addSegStrokeR(-20,-20).addSegStrokeR(20,-20).addPointR(20,-20).addSegArc3(xe(r),!0).addSegStrokeR(20,-20).addPointR(20,-20).addSegArc3(xe(r),!1).addSegStrokeR(20,-20);u.check(),i.addMainO(u);const g=B(100,500);for(let S=0;S<8;S++){const L=S*45,R=xe(L);g.addSegStrokeRP(R,20).addPointRP(R,20).addSeg2Arcs(xe(L+c),xe(180+L-h)).addSegStrokeRP(R,20).addPointRP(R,20).addSeg2Arcs(xe(L-c),xe(180+L+h)).addSegStrokeRP(R,20)}g.check(),i.addMainO(g),t.fig={one:i},t.logstr+=`verify_contour_2 drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var Kr={pTitle:"Verify contour 2",pDescription:"Debugging more contour.ts",pDef:Gs,pGeom:Zr},Js={partName:"verify_contour_3",params:[o("r1","mm",10,0,200,1),o("r2","mm",10,0,200,1),o("r3","mm",10,0,200,1),o("r4","mm",10,0,200,1),o("r5","mm",10,0,200,1),o("r6","mm",5,0,200,1)],paramSvg:{r1:"verify_contour_1_r1.svg",r2:"verify_contour_1_r1.svg",r3:"verify_contour_1_r1.svg",r4:"verify_contour_1_r1.svg",r5:"verify_contour_1_r1.svg",r6:"verify_contour_1_r1.svg"},sim:{tMax:10,tStep:.5,tUpdate:500}};function Qr(s,e,d=""){const t=be(Js.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=e.r1+s,a=e.r2+s,r=e.r3+s,c=e.r4+s,h=e.r5+s,l=e.r6+s,f=B(100,0).addSegStrokeR(30,200).addCornerRounded(i).addSegStrokeR(200,30).addCornerRounded(i).addSegStrokeR(-200,30).addCornerRounded(i).addSegStrokeR(-30,200).addCornerRounded(i).addSegStrokeR(-30,-200).addCornerRounded(i).addSegStrokeR(-200,-30).addCornerRounded(i).addSegStrokeR(200,-30).addCornerRounded(i).closeSegStroke().addCornerRounded(i);t.logstr+=f.check(),n.addMainO(f);const _=100,u=B(300,0);for(let Z=0;Z<4;Z++){const ee=90*(1-Z);u.addSegStrokeRP(xe(ee),_).addCornerRounded(a).addSegStrokeRP(xe(ee-45),_).addCornerRounded(a).addSegStrokeRP(xe(ee+45),_).addCornerRounded(a).addSegStrokeRP(xe(ee),_).addCornerRounded(a)}t.logstr+=u.check(),n.addMainO(u);const g=100,S=70,L=B(0,600).addSegStrokeR(g,g);for(let Z=0;Z<3;Z++){const ee=(Z&1)!==0,He=(Z&2)!==0;L.addSegStrokeR(g,0).addSegStrokeR(0,g).addCornerRounded(r).addPointR(g,0).addSegArc(S,ee,He).addCornerRounded(r).addSegStrokeR(0,-g)}for(let Z=0;Z<8;Z++){const ee=(Z&4)===0?1:-1,He=(Z&2)!==0,Le=(Z&1)!==0;L.addSegStrokeR(g,0).addCornerRounded(r).addPointR(g,0).addSegArc(S,He,Le).addCornerRounded(r).addSegStrokeR(g,0),L.addSegStrokeR(g,-ee*g/8).addCornerRounded(r).addPointR(g,ee*g/4-3*s).addSegArc(S,He,Le).addCornerRounded(r).addSegStrokeR(g,-ee*g/8)}L.addSegStrokeR(g,0).addSegStrokeR(g,-g).closeSegStroke(),t.logstr+=L.check(),n.addMainO(L);const R=B(0,900).addCornerRounded(r).addPointR(g,g).addSegArc(g,!1,!0).addSegStrokeR(0,2*g).addCornerRounded(r).addPointR(g,-g).addSegArc(g,!1,!0).addSegStrokeR(g,0).addCornerRounded(r).addPointR(g,g).addSegArc(g,!1,!1).addCornerRounded(r).addSegStrokeR(0,2*g).addCornerRounded(r).addPointR(-g,g).addSegArc(g,!1,!1).addPointR(g,g).addSegArc(g,!1,!1).addCornerRounded(r).addSegStrokeR(0,3*g).addCornerRounded(r).addPointR(-g,-g).addSegArc(g,!1,!1).addPointR(-g,g).addSegArc(g,!1,!1).addCornerRounded(r).addSegStrokeR(0,-3*g).addCornerRounded(r).addPointR(-g,g).addSegArc(g,!1,!0).addSegStrokeR(-g,0).closeSegStroke();t.logstr+=R.check(),n.addMainO(R);const v=200,x=180,C=B(0,2e3).addPointR(v,0).addSegArc(x,!1,!0).addCornerRounded(c).addPointR(0,v).addSegArc(x,!1,!0).addCornerRounded(c).addPointR(-v,-v).addSegArc(1.4*x,!1,!0).addCornerRounded(c);t.logstr+=C.check(),n.addMainO(C);const T=B(400,2e3).addPointR(0,1.7*v).addSegArc(2.3*x,!1,!1).addCornerRounded(c).addPointR(v,-.7*v).addSegArc(x,!1,!1).addCornerRounded(c).addPointR(-v,-v).addSegArc(1.4*x,!1,!1).addCornerRounded(c);t.logstr+=T.check(),n.addMainO(T);const w=B(1e3,2e3).addPointR(v,0).addSegArc(.6*x,!0,!0).addCornerRounded(c).addPointR(0,v).addSegArc(x,!0,!0).addCornerRounded(c).addPointR(-v,-v).addSegArc(1.4*x,!0,!0).addCornerRounded(c);t.logstr+=w.check(),n.addMainO(w);const P=B(3e3,2e3).addPointR(0,1.7*v).addSegArc(2.3*x,!0,!1).addCornerRounded(c).addPointR(v,-.7*v).addSegArc(x,!0,!1).addCornerRounded(c).addPointR(-v,-v).addSegArc(1.1*x,!0,!1).addCornerRounded(c);t.logstr+=P.check(),n.addMainO(P);const M=3*v,b=3*x,j=B(3800,2e3).addPointR(M,0).addSegArc(b,!1,!1).addCornerRounded(c).addPointR(0,M).addSegArc(b,!1,!1).addCornerRounded(c).addPointR(-M,0).addSegArc(b,!1,!1).addCornerRounded(c).addPointR(0,-M).addSegArc(b,!1,!1).addCornerRounded(c);t.logstr+=j.check(),n.addMainO(j);const O=B(4500,2e3).addPointR(v,v).addSegArc(v,!1,!1).addPointR(v,-v).addSegArc(v,!1,!1).addCornerRounded(c).addPointR(-v,1.6*v).addSegArc(1.1*x,!1,!0).addCornerRounded(c).addPointR(-v,-1.6*v).addSegArc(1.2*x,!1,!0).addCornerRounded(c);t.logstr+=O.check(),n.addMainO(O);const y=B(5200,2e3).addPointR(v,0).addSegArc(.9*v,!1,!1).addCornerRounded(c).addPointR(v,0).addSegArc(.9*v,!1,!1).addCornerRounded(c).addPointR(-2*v,0).addSegArc(1.3*v,!0,!0).addCornerRounded(c);t.logstr+=y.check(),n.addMainO(y);const q=.999,X=B(6e3,2e3).addPointR(2*v,2*v).addSegArc(1.5*v,!1,!1).addCornerRounded(c).addPointR(2*v,-2*v).addSegArc(1.5*v,!1,!1).addCornerRounded(c).addPointR(-v,v).addSegArc(v,!1,!0).addPointR(-v,-q*v).addSegArc(v,!1,!0).addCornerRounded(c).addPointR(-v,q*v).addSegArc(v,!1,!0).addPointR(-v,-v).addSegArc(v,!1,!0).addCornerRounded(c);t.logstr+=X.check(),n.addMainO(X);const N=200,F=180,W=B(0,3e3).addSegStrokeR(N,0).addCornerWidened(h).addSegStrokeR(0,N).addCornerWidened(h).closeSegStroke().addCornerWidened(h);t.logstr+=W.check(),n.addMainO(W);const K=B(400,3e3).addSegStrokeR(N,0).addCornerWidened(h).addPointR(0,N).addSegArc(F,!1,!0).addCornerWidened(h).addPointR(-N,0).addSegArc(F,!1,!1).addCornerWidened(h).closeSegStroke().addCornerWidened(h);t.logstr+=K.check(),n.addMainO(K);const z=B(3e3,3e3).addPointR(0,1.7*N).addSegArc(2.3*F,!0,!1).addCornerWidened(h).addPointR(N,-.7*N).addSegArc(F,!0,!1).addCornerWidened(h).addPointR(-N,-N).addSegArc(1.1*F,!0,!1).addCornerWidened(h);t.logstr+=z.check(),n.addMainO(z);const I=B(3800,3e3).addPointR(N,0).addSegArc(F,!1,!1).addCornerWidened(h).addPointR(0,N).addSegArc(F,!1,!1).addCornerWidened(h).addPointR(-N,0).addSegArc(F,!1,!1).addCornerWidened(h).addPointR(0,-N).addSegArc(F,!1,!1).addCornerWidened(h);t.logstr+=I.check(),n.addMainO(I);const U=B(4500,3e3).addPointR(N,N).addSegArc(N,!1,!1).addPointR(N,-N).addSegArc(N,!1,!1).addCornerWidened(h).addPointR(-N,1.6*N).addSegArc(1.1*F,!1,!0).addCornerWidened(h).addPointR(-N,-1.6*N).addSegArc(1.2*F,!1,!0).addCornerWidened(h);t.logstr+=U.check(),n.addMainO(U);const D=200,Y=180,E=B(0,4e3).addSegStrokeR(D,0).addCornerWideAcc(l).addSegStrokeR(0,D).addCornerWideAcc(l).closeSegStroke().addCornerWideAcc(l);t.logstr+=E.check(),n.addMainO(E);const Q=B(400,4e3).addSegStrokeR(D,0).addCornerWideAcc(l).addPointR(0,D).addSegArc(Y,!1,!0).addCornerWideAcc(l).addPointR(-D,0).addSegArc(Y,!1,!1).addCornerWideAcc(l).closeSegStroke().addCornerWideAcc(l);t.logstr+=Q.check(),n.addMainO(Q);const ie=B(3e3,4e3).addPointR(0,1.7*D).addSegArc(2.3*Y,!0,!1).addCornerWideAcc(l).addPointR(D,-.7*D).addSegArc(Y,!0,!1).addCornerWideAcc(l).addPointR(-D,-D).addSegArc(1.1*Y,!0,!1).addCornerWideAcc(l);t.logstr+=ie.check(),n.addMainO(ie);const J=B(3800,4e3).addPointR(D,0).addSegArc(Y,!1,!1).addCornerWideAcc(l).addPointR(0,D).addSegArc(Y,!1,!1).addCornerWideAcc(l).addPointR(-D,0).addSegArc(Y,!1,!1).addCornerWideAcc(l).addPointR(0,-D).addSegArc(Y,!1,!1).addCornerWideAcc(l);t.logstr+=J.check(),n.addMainO(J);const V=B(4500,4e3).addPointR(D,D).addSegArc(D,!1,!1).addPointR(D,-D).addSegArc(D,!1,!1).addCornerWideAcc(l).addPointR(-D,1.6*D).addSegArc(1.1*Y,!1,!0).addCornerWideAcc(l).addPointR(-D,-1.6*D).addSegArc(1.2*Y,!1,!0).addCornerWideAcc(l);t.logstr+=V.check(),n.addMainO(V),t.fig={one:n},t.logstr+=`verify_contour_3 drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var ea={pTitle:"Verify contour 3",pDescription:"Debugging contour.ts for rounded corners and widened corners",pDef:Js,pGeom:Qr},Us={partName:"verify_contour_4",params:[o("n1","scalar",16,1,50,1),o("n2","scalar",6,3,50,1),o("r1","mm",5,0,20,1)],paramSvg:{n1:"verify_contour_1_r1.svg",n2:"verify_contour_1_r1.svg",r1:"verify_contour_1_r1.svg"},sim:{tMax:10,tStep:.5,tUpdate:500}};function ta(s,e,d=""){const t=be(Us.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=e.n1,a=e.n2,r=e.r1,c=50+s,h=2*Math.PI/(a*3),l=B(c,0).addSegStrokeAP(h,1.5*c).addCornerRounded(r).addPointAP(2*h,c).addSegArc(.45*c,!1,!0).addCornerWidened(r).addSegStrokeAP(3*h,1.2*c),f=B(c,0),_=l.clone().addCornerRounded(r);for(let v=0;v<i;v++){const x=_.rotate(0,0,v*3*h).scale(0,0,1+v*.2,!0);f.addPartial(x)}f.closeSegStroke(),t.logstr+=f.check(),n.addMainO(f);const u=B(c,0);for(let v=0;v<i;v++)u.addPartial(_.rotate(0,0,v*3*h).scale(0,0,1+v*.2,!1));u.closeSegStroke(),t.logstr+=u.check(),n.addMainO(u.translate(-10*c,0));const g=l.generateContour(),S=g.clone();for(let v=1;v<i;v++)S.addPartial(g.rotate(0,0,v*3*h).scale(0,0,1+v*.2));S.closeSegStroke();const L=S.translate(10*c,0);t.logstr+=L.check(),n.addMainO(L);const R=S.translatePolar(Math.PI/3,10*c);t.logstr+=R.check(),n.addMainO(R),t.fig={one:n},t.logstr+=`verify_contour_4 drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var oa={pTitle:"Verify contour 4",pDescription:"Debugging contour.ts for addPartial",pDef:Us,pGeom:ta},Ws={partName:"verify_contour_5",params:[o("L1","mm",100,10,200,1),o("L2","mm",100,10,200,1),o("R1","mm",10,0,100,1),o("R2","mm",10,0,100,1)],paramSvg:{L1:"verify_contour_1_r1.svg",L2:"verify_contour_1_r1.svg",R1:"verify_contour_1_r1.svg",R2:"verify_contour_1_r1.svg"},sim:{tMax:10,tStep:.5,tUpdate:500}};function sa(s,e,d=""){const t=be(Ws.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G(),i=B(0,0).addSegStrokeR(e.L1,0).addCornerRounded(e.R1).addSegStrokeR(0,e.L2).addCornerRounded(e.R2).closeSegStroke();t.logstr+=i.check(),n.addMainO(i);const a=i.generateRevertOrientation().translate(300,0);t.logstr+=a.check(),n.addMainO(a);const r=B(0,300).addSegStrokeR(e.L1,0).addCornerRounded(e.R1).addSegStrokeR(0,e.L2).closeSegStroke().addCornerRounded(e.R2);t.logstr+=r.check(),n.addMainO(r);const c=r.generateRevertOrientation().translate(300,0);t.logstr+=c.check(),n.addMainO(c);const h=B(0,600).addCornerRounded(e.R2).addSegStrokeR(e.L1,0).addCornerRounded(e.R1).addSegStrokeR(0,e.L2).closeSegStroke();t.logstr+=h.check(),n.addMainO(h);const l=h.generateRevertOrientation().translate(300,0);t.logstr+=l.check(),n.addMainO(l);const f=B(0,900).addSegStrokeR(e.L1,0).addCornerRounded(e.R1).addPointR(0,e.L2).addSegArc(e.L2,!1,!1).addCornerRounded(e.R2).closeSegStroke();t.logstr+=f.check(),n.addMainO(f);const _=f.generateRevertOrientation().translate(300,0);t.logstr+=_.check(),n.addMainO(_);const u=B(0,1200).addSegStrokeR(e.L1,0).addCornerRounded(e.R1).addPointR(0,e.L2).addSegArc(e.L2,!1,!1).closeSegArc(e.L1+e.L2,!1,!0).addCornerRounded(e.R2);t.logstr+=u.check(),n.addMainO(u);const g=u.generateRevertOrientation().translate(300,0);t.logstr+=g.check(),n.addMainO(g),t.fig={one:n},t.logstr+=`verify_contour_5 drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var na={pTitle:"Verify contour 5",pDescription:"Debugging contour.ts for revert-contour",pDef:Ws,pGeom:sa},qs={partName:"verify_exports_1",params:[ct("circle",!0),o("circle-size","mm",100,1,1e3,1),ct("contour",!0),o("contour-size","mm",30,1,1e3,1),ct("contour-arc-large",!1)],paramSvg:{circle:"default_param_blank.svg","circle-size":"default_param_blank.svg",contour:"default_param_blank.svg","contour-size":"default_param_blank.svg","contour-arc-large":"default_param_blank.svg"},sim:{tMax:10,tStep:.1,tUpdate:500}};function ra(s,e,d=""){const t=be(qs.partName+d);t.logstr+=`${t.partName} simTime: ${s}
`;try{const n=G();if(e.circle===1){const a=$(0,0,e["circle-size"]);n.addMainO(a)}if(e.contour===1){const a=e["contour-size"],r=e["contour-arc-large"]===1,c=B(0,0).addSegStrokeA(a,0).addPointA(a,a).addSegArc(a*.8,r,!0).closeSegStroke();n.addMainO(c)}t.fig={one:n};const i=t.partName;t.vol={extrudes:[{outName:`subpax_${i}_one`,face:`${i}_one`,extrudeMethod:se.eLinearOrtho,length:10,rotate:[0,0,0],translate:[0,0,0]}],volumes:[{outName:`pax_${i}`,boolMethod:pe.eIdentity,inList:[`subpax_${i}_one`]}]},t.logstr+=`verify_exports_1 drawn successfully!
`,t.calcErr=!1}catch(n){t.logstr+=n,console.log(n)}return t}var aa={pTitle:"Verify exports 1",pDescription:"For dev & debug of Openscad export",pDef:qs,pGeom:ra};const ia="/docs/apidoc/",Co=[{category:"",pages:[{path:"/",page:null,svg:"page_index.svg"}]},{category:"Gears",pages:[{path:"/gear/gear_wheel",page:qn,svg:"page_gearwheel.svg"},{path:"/gear/gear_bar",page:Yn,svg:"page_gearbar.svg"},{path:"/gear/gear_ring",page:Kn,svg:"page_gearring.svg"},{path:"/gear/gear_epicycloid",page:er,svg:"page_epicycloid.svg"}]},{category:"Heliostat",pages:[{path:"/heliostat/heliostat",page:cr,svg:"page_heliostat.svg"},{path:"/heliostat/heliostat_2",page:hr,svg:"page_heliostat.svg"},{path:"/heliostat/base",page:_r,svg:"page_base.svg"},{path:"/heliostat/pole_static",page:xo,svg:"page_pole_static.svg"},{path:"/heliostat/vaxis",page:vr,svg:"page_vaxis.svg"},{path:"/heliostat/ring",page:Lr,svg:"page_vaxis.svg"},{path:"/heliostat/vaxis_holder",page:Jt,svg:"page_vaxis.svg"},{path:"/heliostat/ring_guidance",page:Pr,svg:"page_vaxis.svg"},{path:"/heliostat/vaxis_guidance",page:Hr,svg:"page_vaxis.svg"},{path:"/heliostat/rake",page:Po,svg:"page_rake.svg"},{path:"/heliostat/rake_stopper",page:qo,svg:"page_rake.svg"},{path:"/heliostat/haxis_guidance",page:mr,svg:"page_vaxis.svg"},{path:"/heliostat/spider",page:Uo,svg:"page_spider.svg"},{path:"/heliostat/swing",page:Do,svg:"page_swing.svg"},{path:"/heliostat/rod",page:br,svg:"page_rod.svg"},{path:"/heliostat/trapeze",page:Rr,svg:"page_trapeze.svg"},{path:"/heliostat/surface",page:Mr,svg:"page_surface.svg"}]},{category:"Junk designs",pages:[{path:"/junk/circles",page:Nr,svg:"page_circles.svg"},{path:"/junk/rectangle",page:Er,svg:"page_rectangle.svg"},{path:"/junk/voila",page:Or,svg:"page_rectangle.svg"}]},{category:"Geometrix verification",pages:[{path:"/dev/verify_point",page:Vr,svg:"page_verify_point.svg"},{path:"/dev/verify_point_2",page:jr,svg:"page_verify_point.svg"},{path:"/dev/verify_line",page:Br,svg:"page_verify_line.svg"},{path:"/dev/verify_line_2",page:Gr,svg:"page_verify_line.svg"},{path:"/dev/verify_line_3",page:Ur,svg:"page_verify_line.svg"},{path:"/dev/verify_vector",page:qr,svg:"page_verify_line.svg"},{path:"/dev/verify_contour_1",page:Yr,svg:"page_verify_line.svg"},{path:"/dev/verify_contour_2",page:Kr,svg:"page_verify_line.svg"},{path:"/dev/verify_contour_3",page:ea,svg:"page_verify_line.svg"},{path:"/dev/verify_contour_4",page:oa,svg:"page_verify_line.svg"},{path:"/dev/verify_contour_5",page:na,svg:"page_verify_line.svg"},{path:"/dev/verify_exports_1",page:aa,svg:"page_verify_line.svg"}]},{category:"Dynamic design import",pages:[{path:"/import",page:null,svg:"page_about.svg"}]},{category:"Docs",pages:[{path:ia,page:null,svg:"page_about.svg"},{path:"/docs/readme",page:null,svg:"page_readme.svg"},{path:"/docs/concept",page:null,svg:"page_concept.svg"},{path:"/docs/geom-dev",page:null,svg:"page_geom.svg"},{path:"/docs/geom-user",page:null,svg:"page_geom.svg"},{path:"/docs/geom-tutorial",page:null,svg:"page_geom.svg"},{path:"/docs/ui",page:null,svg:"page_ui.svg"},{path:"/docs/lists",page:null,svg:"page_geom.svg"},{path:"/docs/prez-1",page:null,svg:"page_concept.svg"},{path:"/docs/prez-2",page:null,svg:"page_concept.svg"},{path:"/docs/prez-2-fr",page:null,svg:"page_concept.svg"},{path:"/docs/prez-3",page:null,svg:"page_concept.svg"},{path:"/docs/js-app",page:null,svg:"page_jsapp.svg"},{path:"/docs/motors",page:null,svg:"page_gears.svg"},{path:"/docs/gears",page:null,svg:"page_gears.svg"},{path:"/docs/involute",page:null,svg:"page_gears.svg"},{path:"/docs/magnetic",page:null,svg:"page_magnetic.svg"},{path:"/docs/axis",page:null,svg:"page_axis.svg"},{path:"/docs/cad-ecosystem",page:null,svg:"page_concept.svg"}]},{category:"",pages:[{path:"/about",page:null,svg:"page_about.svg"}]}],Ee=Wt({});function da(s){for(const e of Object.keys(s)){const d={};for(const t of s[e].pDef.params)d[t.name]=t.init;Ee[e]=d}}function Xs(s,e,d){if(Object.keys(Ee).includes(s)){const n=Ee[s],i=Object.keys(n);for(const a of Object.keys(e))i.includes(a)?d&&(n[a]=e[a]):n[a]=e[a];Ee[s]=n}else Ee[s]=e}function md(s){const e=s.pDef.partName,d={};for(const t of s.pDef.params)d[t.name]=t.init;Xs(e,d,!1)}function ca(s,e){e(!1)}var la=Re('<aside class="backdrop svelte-sjxf1e"><div class="dialog svelte-sjxf1e"><button class="svelte-sjxf1e"><img/></button></div></aside>');function Ys(s,e){Ke(e,!0);let d=rt(e,"modalOpen",15);var t=Lo(),n=dt(t);{var i=a=>{var r=la(),c=k(r),h=k(c);h.__click=[ca,d];var l=k(h);H(h),H(c),H(r),je(()=>{Ne(l,"src",e.svgPath),Ne(l,"alt",e.svgPath)}),De(a,r)};Ut(n,a=>{d()&&a(i)})}De(s,t),Qe()}Lt(["click"]);var ga=(s,e,d)=>e(d),ha=Re('<button class="svelte-fxmnfh"><img class="svelte-fxmnfh"/></button>'),ua=Re('<section class="svelte-fxmnfh"><!> <!></section>');function pd(s,e){Ke(e,!0);function d(l){const f=[];for(const _ of Object.values(l.paramSvg))f.includes(_)||f.push(_);return f}let t=$e(!1),n=$e(""),i=qe(()=>d(e.pDef).map(l=>`${No}/pgdsvg/${l}`));function a(l){de(n,l,!0),de(t,!0)}var r=ua(),c=k(r);Ys(c,{get svgPath(){return A(n)},get modalOpen(){return A(t)},set modalOpen(l){de(t,l,!0)}});var h=m(c,2);lt(h,16,()=>A(i),l=>l,(l,f)=>{var _=ha();_.__click=[ga,a,f];var u=k(_);H(_),je(()=>{Ne(u,"src",f),Ne(u,"alt",f)}),De(l,_)}),H(r),De(s,r),Qe()}Lt(["click"]);function _a(s,e){e(!1)}function fa(s,e,d){e.okFunc(),d(!1)}var va=Re('<aside class="backdrop svelte-weruk7"><div><article class="question svelte-weruk7"><!></article> <footer class="svelte-weruk7"><button class="cancel svelte-weruk7">Cancel</button> <button class="ok svelte-weruk7"> </button></footer></div></aside>');function vo(s,e){Ke(e,!0);let d=rt(e,"okName",3,"Ok"),t=rt(e,"modalOpen",15),n=rt(e,"sizeLarge",3,!1);var i=Lo(),a=dt(i);{var r=c=>{var h=va(),l=k(h);let f;var _=k(l),u=k(_);yn(u,()=>e.children),H(_);var g=m(_,2),S=k(g);S.__click=[_a,t];var L=m(S,2);L.__click=[fa,e,t];var R=k(L,!0);H(L),H(g),H(l),H(h),je(v=>{f=Ze(l,1,"dialog svelte-weruk7",null,f,v),_e(R,d())},[()=>({sizeLarge:n()})]),De(c,h)};Ut(a,c=>{t()&&c(r)})}De(s,i),Qe()}Lt(["click"]);function Sa(s,e,d,t){for(const n of e())A(d)[n]=A(t)}var La=(s,e)=>{de(e,!0)},xa=Re('<p class="diagItem svelte-12dj9tj"> </p>'),Pa=Re('<p class="diagTitle svelte-12dj9tj">Do you really want to delete the following localStorage keys?</p> <!>',1),Da=(s,e,d)=>e(d),Ha=Re('<tr class="svelte-12dj9tj"><td><input type="checkbox"/></td><td class="svelte-12dj9tj"><button class="svelte-12dj9tj"> </button></td><td> </td></tr>'),ka=Re('<div class="deleteKeys svelte-12dj9tj"><button class="svelte-12dj9tj">Delete</button> <!> <table class="svelte-12dj9tj"><thead class="svelte-12dj9tj"><tr><td>Delete</td><td>Key name</td><td>Last modification</td></tr><tr><td><input type="checkbox"/></td><td class="instruction">delete all</td><td></td></tr></thead><tbody class="svelte-12dj9tj"></tbody></table></div>');function Zs(s,e){Ke(e,!0);let d=rt(e,"storeName",15),t=rt(e,"localKeys",15),n=$e(Wt({})),i=$e(!1),a=$e(!1);function r(){let w=[];const P=new RegExp(`^${e.pageName}_`);return w=Object.keys(window.localStorage).filter(b=>P.test(b)).map(b=>b.replace(P,"")),w.sort(),w}t(r());function c(w){d(w)}function h(w){let P={};for(const M of w){let b="";const j=`${e.pageName}_${M}`,O=window.localStorage.getItem(j);O!==null&&(b=JSON.parse(O).lastModif),P[M]=b}return P}let l=qe(()=>h(t()));function f(w){let P={};for(const M of w)P[M]=!1;return P}de(n,f(t()),!0);function _(){for(const w of t())if(A(n)[w]){const P=`${e.pageName}_${w}`;window.localStorage.removeItem(P)}de(i,!1),t(r())}var u=ka(),g=k(u);g.__click=[La,a];var S=m(g,2);vo(S,{okName:"Confirm",okFunc:_,get modalOpen(){return A(a)},set modalOpen(w){de(a,w,!0)},children:(w,P)=>{var M=Pa(),b=m(dt(M),2);lt(b,16,t,j=>j,(j,O)=>{var y=Lo(),q=dt(y);{var X=N=>{var F=xa(),W=k(F,!0);H(F),je(()=>_e(W,O)),De(N,F)};Ut(q,N=>{A(n)[O]&&N(X)})}De(j,y)}),De(w,M)},$$slots:{default:!0}});var L=m(S,2),R=k(L),v=m(k(R)),x=k(v),C=k(x);Be(C),C.__change=[Sa,t,n,i],H(x),st(2),H(v),H(R);var T=m(R);lt(T,20,t,w=>w,(w,P)=>{var M=Ha(),b=k(M),j=k(b);Be(j),H(b);var O=m(b),y=k(O);y.__click=[Da,c,P];var q=k(y,!0);H(y),H(O);var X=m(O),N=k(X,!0);H(X),H(M),je(()=>{_e(q,P),_e(N,A(l)[P])}),nt(j,()=>A(n)[P],F=>A(n)[P]=F),De(w,M)}),H(T),H(L),H(u),nt(C,()=>A(i),w=>de(i,w)),De(s,u),Qe()}Lt(["click","change"]);var ma=Re('<p class="warnMsg svelte-1rkdwo"> </p>'),pa=Re('<!> <div class="svelte-1rkdwo"><label for="storName" class="svelte-1rkdwo">Give a name to your parameter-set:</label> <input type="text" id="storName" required minlength="4" maxlength="30" size="32" class="svelte-1rkdwo"/> <!></div>',1);function ba(s,e){Ke(e,!0);let d=rt(e,"storeName",15),t=$e(Wt([]));function n(_){const u=/[-:]/g,g=/\..*$/,S=new Date().toISOString().replace(u,"").replace(g,"").replace("T","_");return`${_}_${S}`}d(n(e.pageName));let i=qe(()=>A(t).includes(d()));var a=pa(),r=dt(a);Zs(r,{get pageName(){return e.pageName},get storeName(){return d()},set storeName(_){d(_)},get localKeys(){return A(t)},set localKeys(_){de(t,_,!0)}});var c=m(r,2),h=m(k(c),2);Be(h);var l=m(h,2);{var f=_=>{var u=ma(),g=k(u);H(u),je(()=>_e(g,`Warning: name ${d()??""} already used`)),De(_,u)};Ut(l,_=>{A(i)&&_(f)})}H(c),to(h,d),De(s,a),Qe()}var wa=Re('<!> <div class="svelte-1ozd0ey"><label for="storName" class="svelte-1ozd0ey">Select a parameter-set:</label> <input type="text" id="storName" readonly="" minlength="4" maxlength="30" size="32" class="svelte-1ozd0ey"/></div>',1);function Ra(s,e){Ke(e,!0);let d=rt(e,"storeName",15),t=$e(Wt([]));function n(h){let l=d();return!h.includes(l)&&(h.length>0?l=h[0]:l=""),l}Ko(()=>{d(n(A(t)))});var i=wa(),a=dt(i);Zs(a,{get pageName(){return e.pageName},get storeName(){return d()},set storeName(h){d(h)},get localKeys(){return A(t)},set localKeys(h){de(t,h,!0)}});var r=m(a,2),c=m(k(r),2);Be(c),H(r),je(()=>yo(c,d())),De(s,i),Qe()}const he=Wt({dLayers:dn(),zAdjust:an(),canvasZWidth:0});var Aa=Re('<canvas class="mini svelte-z8e4tz"></canvas>');function us(s,e){Ke(e,!0);const d=200,t=.6;let n;function i(c,h,l,f){const _=cn(f);_.ruler=!1;let u;if(n){const g=n.getContext("2d");g.clearRect(0,0,g.canvas.width,g.canvas.height);const S=g.canvas.width;try{e.full?u=c.getAdjustFull(g.canvas.width,g.canvas.height):u=ln(l,S,h),c.draw(g,u,_)}catch(L){console.log(L)}}}Ko(()=>{i(e.pFig,he.zAdjust,he.canvasZWidth,he.dLayers)});function a(c){const h=c.offsetX,l=c.offsetY,f=n.getContext("2d"),_=f.canvas.width/2,u=f.canvas.height/2;if(c.button===0){let g=1;h>_&&(g+=1*t),l>u&&(g+=2*t),f.canvas.width=g*d,f.canvas.height=g*d,i(e.pFig,he.zAdjust,he.canvasZWidth,he.dLayers)}}var r=Aa();Ne(r,"width",d),Ne(r,"height",d),r.__click=a,$o(r,c=>n=c,()=>n),De(s,r),Qe()}Lt(["click"]);function Ma(s,e){const d=document.createElement("a");d.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),d.setAttribute("download",s),d.click(),d.remove()}function ya(s,e,d){const t=/[-:]/g,n=/\..*$/,i=new Date().toISOString().replace(t,"").replace(n,"").replace("T","_");return Zo(i,s,e,d)}function Qo(s,e,d){const t=/[-:]/g,n=/\..*$/,i=new Date().toISOString().replace(t,"").replace(n,"").replace("T","_"),a=`px_${s}_${i}.json`,r=Zo(i,s,e,d);Ma(a,r)}function Na(s,e,d){const t=new URL(s),n=2e3;let i=t.toString().length;for(const a of Object.keys(e)){const r=e[a].toString(),c=2+a.length+r.length;t.searchParams.append(encodeURIComponent(a),encodeURIComponent(r)),i+=c}return i>=n&&console.log(`warn547: generateUrl: strLength ${i} larger than strLengthLimit ${n}`),t.toString()}const $a=Symbol();class Ea extends URLSearchParams{#e=$e(0);#s=Oa();#t=!1;#o(){if(!this.#s||this.#t)return;this.#t=!0;const e=this.toString();this.#s.search=e&&`?${e}`,this.#t=!1}[$a](e){if(!this.#t){this.#t=!0;for(const d of[...super.keys()])super.delete(d);for(const[d,t]of e)super.append(d,t);fo(this.#e),this.#t=!1}}append(e,d){super.append(e,d),this.#o(),fo(this.#e)}delete(e,d){var t=super.has(e,d);super.delete(e,d),t&&(this.#o(),fo(this.#e))}get(e){return A(this.#e),super.get(e)}getAll(e){return A(this.#e),super.getAll(e)}has(e,d){return A(this.#e),super.has(e,d)}keys(){return A(this.#e),super.keys()}set(e,d){var t=super.getAll(e).join("");super.set(e,d),t!==super.getAll(e).join("")&&(this.#o(),fo(this.#e))}sort(){super.sort(),this.#o(),fo(this.#e)}toString(){return A(this.#e),super.toString()}values(){return A(this.#e),super.values()}entries(){return A(this.#e),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return A(this.#e),super.size}}let Ca=null;function Oa(){return Ca}function Ia(s,e){if(s.target){const d=s.target.files;d&&e(d[0])}}function Va(s,e,d,t){de(e,d(),!0),de(t,!0)}function Ta(s,e){de(e,!0)}function ja(s,e){de(e,!0)}function Fa(s,e){de(e,!1)}var Ba=(s,e)=>{de(e,!0)},za=(s,e)=>{de(e,!0)},Ga=(s,e,d)=>e(A(d).name),Ja=Re('<input type="number" class="input-number svelte-jonk14"/> <input type="range" class="svelte-jonk14"/>',1),Ua=Re("<option> </option>"),Wa=Re("<select></select>"),qa=Re("<option> </option>"),Xa=Re("<select></select>"),Ya=Re('<tr><td class="svelte-jonk14"> </td><td class="svelte-jonk14"><button class="svelte-jonk14"> </button></td><td class="svelte-jonk14"><!></td><td> </td><td> </td><td class="svelte-jonk14"> </td><td class="svelte-jonk14"> </td><td> </td></tr>'),Za=Re('<tbody class="svelte-jonk14"><tr class="separator svelte-jonk14"><td class="svelte-jonk14"> </td><td class="svelte-jonk14"> </td><td class="svelte-jonk14"><label class="svelte-jonk14"><input type="checkbox" class="svelte-jonk14"/> <span class="svelte-jonk14"></span></label></td></tr></tbody> <tbody></tbody>',1),Ka=(s,e)=>{de(e,!0)},Qa=Re('<p>Copy this URL and send it to your friends!</p> <p class="cUrl svelte-jonk14"> </p>',1),ei=Re('<section class="svelte-jonk14"><h2 class="svelte-jonk14">Parameters</h2> <main class="svelte-jonk14"><label for="loadFParams" class="fileUpload svelte-jonk14">Load Params from File</label> <input id="loadFParams" type="file" accept="text/plain, application/json" class="svelte-jonk14"/> <button class="svelte-jonk14">Set Params Default</button> <button class="svelte-jonk14">Load Params from localStorage</button> <!> <!> <textarea rows="3" cols="80" readonly="" wrap="soft"></textarea> <table class="svelte-jonk14"><thead class="svelte-jonk14"><tr class="svelte-jonk14"><td class="svelte-jonk14">&#35;</td><td class="svelte-jonk14">Parameter name</td><td class="svelte-jonk14">Value<span class="svelte-jonk14"><button class="svelte-jonk14">&minus;</button><button class="svelte-jonk14">+</button></span></td><td>Unit</td><td>Default</td><td class="svelte-jonk14">Min</td><td class="svelte-jonk14">Max</td><td>Step</td></tr></thead><!></table> <div class="comment svelte-jonk14"><label for="inComment">Comment:</label> <input type="text" id="inComment" maxlength="150"/></div> <button class="svelte-jonk14">Save Parameters to File</button> <button class="svelte-jonk14">Save Parameters as URL</button> <button class="svelte-jonk14">Save Parameters to localStorage</button> <!> <!></main> <!> <button class="side-img svelte-jonk14"><img class="svelte-jonk14"/></button> <div class="mini-canvas svelte-jonk14"><!></div> <div class="mini-canvas svelte-jonk14"><!></div></section>');function ti(s,e){Ke(e,!0);let d=$e(""),t=$e(!1),n=$e(""),i=$e(!1),a=$e(!1),r=$e(!1),c=$e(!1),h=$e(!1),l=$e(""),f=$e(""),_=$e(""),u=$e(Wt(O(e.pDef.params[0].name))),g=$e(!1),S=$e(Wt(X(q(e.pDef.params))));_s(()=>{de(u,O(e.pDef.params[0].name),!0),de(S,X(q(e.pDef.params)),!0)});function L(te,ne){let ue="",we=!1;te!==e.pDef.partName&&(ue+=`warn361: read partName: '${te}'  expected partName: '${e.pDef.partName}'
`,we=!0);let Ve=0,Ue=0,ht=0;const Zt=[];for(const Xe of e.pDef.params)Zt.push(Xe.name),Object.hasOwn(ne,Xe.name)?(Ve+=1,Ee[e.pDef.partName][Xe.name]===ne[Xe.name]?ht+=1:Ee[e.pDef.partName][Xe.name]=ne[Xe.name]):Ue+=1;let tt=0;for(const Xe of Object.keys(ne))Zt.includes(Xe)||(tt+=1,ue+=`warn363: parameter ${Xe} not in the scope of the design (${tt})
`);const Vt=tt>0,Tt=new Date().toLocaleTimeString();return ue+=`Params loaded at ${Tt} :`,ue+=` def-nb: ${Object.keys(e.pDef.params).length}`,ue+=`, cover-nb: ${Ve}, uncover-nb: ${Ue}
`,ue+=` load-nb: ${Object.keys(ne).length}`,ue+=`, equal-nb: ${ht}, changed-nb: ${Ve-ht}`,ue+=`, out-of-scope: ${tt}`,[ue,we||Vt]}async function R(te){try{const ne=await fetch(te);if(!ne.ok)throw`err627: error while fetching ${te}`;const ue=await ne.text(),[we]=ss(ue);(Ve=>{var Ue=Mo(Ve,2);de(n,Ue[0],!0),de(i,Ue[1],!0)})(L(we.partName,we.pVal)),de(d,we.comment,!0)}catch(ne){let ue=`err223: error by fetching px file
`;ue+=ne,de(n,ue,!0),de(i,!0)}}async function v(){{const te=new Ea(cs.url.search),ne="pxUrl";if(te.has(ne)){const we=te.get(ne);te.delete(ne),we?await R(we):(de(n,`err123: error by parsing URL-search-params
`),de(i,!0))}const ue={};for(const[we,Ve]of te){const Ue=Number(Ve);isNaN(Ue)||(ue[we]=Ue)}Object.keys(ue).length>0&&(we=>{var Ve=Mo(we,2);de(n,Ve[0],!0),de(i,Ve[1],!0)})(L(e.pDef.partName,ue))}}v();function x(te){try{const[ne]=ss(te);(ue=>{var we=Mo(ue,2);de(n,we[0],!0),de(i,we[1],!0)})(L(ne.partName,ne.pVal)),de(d,ne.comment,!0)}catch(ne){let ue=`err723: error by parsing parameter file
`;ue+=ne,de(n,ue,!0),de(i,!0)}}async function C(te){const ne=await te.text();x(ne)}function T(){Qo(e.pDef.partName,Ee[e.pDef.partName],A(d))}function w(){const te={};for(const ne of e.pDef.params)te[ne.name]=ne.init;(ne=>{var ue=Mo(ne,2);de(n,ue[0],!0),de(i,ue[1],!0)})(L(e.pDef.partName,te))}function P(){if(A(l)!==void 0&&A(l)!==""){const te=`${e.pDef.partName}_${A(l)}`;{const ne=window.localStorage.getItem(te);ne===null?(de(n,`Warn157: localStorage key ${te} is null`),de(i,!0)):x(ne)}}else de(n,"Warn239: No valid name for loading from localStorage!"),de(i,!0)}function M(){if(A(f)!==void 0&&A(f)!==""){const te=`${e.pDef.partName}_${A(f)}`,ne=/\..*$/,ue=new Date().toISOString().replace(ne,""),we=Zo(ue,e.pDef.partName,Ee[e.pDef.partName],A(d));window.localStorage.setItem(te,we)}else console.log("Warn639: No valid name for writing to localStorage!")}function b(){return Na(cs.url.href,Ee[e.pDef.partName]).toString()}function j(){}function O(te){let ne=`${No}/pgdsvg/default_param_blank.svg`;return Object.keys(e.pDef.paramSvg).includes(te)&&(ne=`${No}/pgdsvg/${e.pDef.paramSvg[te]}`),ne}function y(te){de(u,O(te),!0)}function q(te){const ne=[];let we={sectionName:"main",sectionID:"g0main",sectionVisCollapse:!1,params:[]},Ve=0;for(const Ue of te)Ue.pType===Ro.eSectionSeparator?(ne.push(we),Ve+=1,we={sectionName:Ue.name,sectionID:`g${Ve}${Ue.name}`,sectionVisCollapse:!0,params:[]}):we.params.push(Ue);return ne.push(we),ne}function X(te){const ne={};for(const ue of te)ne[ue.sectionID]=ue.sectionVisCollapse;return ne}let N=qe(()=>q(e.pDef.params)),F=qe(()=>A(t)?2:4),W=qe(()=>A(t)?2:3),K=qe(()=>A(t)?50:70);var z=ei(),I=m(k(z),2),U=m(k(I),2);U.__change=[Ia,C];var D=m(U,2);D.__click=[Ba,a];var Y=m(D,2);Y.__click=[za,r];var E=m(Y,2);vo(E,{okName:"Overwrite Parameters",okFunc:w,get modalOpen(){return A(a)},set modalOpen(te){de(a,te,!0)},children:(te,ne)=>{st();var ue=as("Load the default parameters ?");De(te,ue)},$$slots:{default:!0}});var Q=m(E,2);vo(Q,{okName:"Load Parameters",okFunc:P,get modalOpen(){return A(r)},set modalOpen(te){de(r,te,!0)},children:(te,ne)=>{Ra(te,{get pageName(){return e.pDef.partName},get storeName(){return A(l)},set storeName(ue){de(l,ue,!0)}})},$$slots:{default:!0}});var ie=m(Q,2);Go(ie);let J;var V=m(ie,2),Z=k(V),ee=k(Z),He=m(k(ee),2),Le=m(k(He)),ye=k(Le);ye.__click=[ja,t];var fe=m(ye);fe.__click=[Fa,t],H(Le),H(He);var ce=m(He);let Ie;var We=m(ce);let et;var le=m(We,3);let qt;H(ee),H(Z);var at=m(Z);lt(at,19,()=>A(N),te=>te.sectionName,(te,ne,ue)=>{var we=Za(),Ve=dt(we),Ue=k(Ve),ht=k(Ue),Zt=k(ht,!0);H(ht);var tt=m(ht),Vt=k(tt,!0);H(tt);var Tt=m(tt),jt=k(Tt),Xe=k(jt);Be(Xe),st(2),H(jt),H(Tt),H(Ue),H(Ve);var Ft=m(Ve,2);let Ho;lt(Ft,23,()=>A(ne).params,Dt=>Dt.name,(Dt,Me,oo)=>{var Nt=Ya();let ko;var Bt=k(Nt),Io=k(Bt);H(Bt);var zt=m(Bt),so=k(zt);so.__click=[Ga,y,Me];var mo=k(so,!0);H(so),H(zt);var no=m(zt),ro=k(no);{var ao=ot=>{var ut=Ja(),it=dt(ut);Be(it);var _t=m(it,2);Be(_t),je(()=>{Ne(it,"min",A(Me).min),Ne(it,"max",A(Me).max),Ne(it,"step",A(Me).step),Ne(_t,"min",A(Me).min),Ne(_t,"max",A(Me).max),Ne(_t,"step",A(Me).step)}),to(it,()=>Ee[e.pDef.partName][A(Me).name],re=>Ee[e.pDef.partName][A(Me).name]=re),to(_t,()=>Ee[e.pDef.partName][A(Me).name],re=>Ee[e.pDef.partName][A(Me).name]=re),De(ot,ut)},Vo=ot=>{var ut=Lo(),it=dt(ut);{var _t=Pe=>{var me=Wa();lt(me,22,()=>["Off","On"],ve=>ve,(ve,Fe,Ht)=>{var Te=Ua(),Ye=k(Te,!0);H(Te);var Ge={};je(()=>{_e(Ye,Fe),Ge!==(Ge=A(Ht))&&(Te.value=(Te.__value=A(Ht))??"")}),De(ve,Te)}),H(me),ls(me,()=>Ee[e.pDef.partName][A(Me).name],ve=>Ee[e.pDef.partName][A(Me).name]=ve),De(Pe,me)},re=Pe=>{var me=Lo(),ve=dt(me);{var Fe=Te=>{var Ye=Xa();lt(Ye,22,()=>A(Me).dropdown,Ge=>Ge,(Ge,wt,Et)=>{var Rt=qa(),Qs=k(Rt,!0);H(Rt);var es={};je(()=>{_e(Qs,wt),es!==(es=A(Et))&&(Rt.value=(Rt.__value=A(Et))??"")}),De(Ge,Rt)}),H(Ye),ls(Ye,()=>Ee[e.pDef.partName][A(Me).name],Ge=>Ee[e.pDef.partName][A(Me).name]=Ge),De(Te,Ye)},Ht=Te=>{var Ye=as("unknown");De(Te,Ye)};Ut(ve,Te=>{A(Me).pType===Ro.eDropdown?Te(Fe):Te(Ht,!1)},!0)}De(Pe,me)};Ut(it,Pe=>{A(Me).pType===Ro.eCheckbox?Pe(_t):Pe(re,!1)},!0)}De(ot,ut)};Ut(ro,ot=>{A(Me).pType===Ro.eNumber?ot(ao):ot(Vo,!1)})}H(no);var $t=m(no);let po;var io=k($t,!0);H($t);var Kt=m($t);let co;var To=k(Kt,!0);H(Kt);var Qt=m(Kt),lo=k(Qt,!0);H(Qt);var go=m(Qt),ho=k(go,!0);H(go);var uo=m(go);let _o;var jo=k(uo,!0);H(uo),H(Nt),je((ot,ut,it,_t)=>{ko=Ze(Nt,1,"svelte-jonk14",null,ko,ot),_e(Io,`${A(ue)+1}.${A(oo)+1}`),_e(mo,A(Me).name),po=Ze($t,1,"svelte-jonk14",null,po,ut),_e(io,A(Me).unit),co=Ze(Kt,1,"svelte-jonk14",null,co,it),_e(To,A(Me).init),_e(lo,A(Me).min),_e(ho,A(Me).max),_o=Ze(uo,1,"svelte-jonk14",null,_o,_t),_e(jo,A(Me).step)},[()=>({changed:Ee[e.pDef.partName][A(Me).name]!==A(Me).init}),()=>({hideColumn:A(t)}),()=>({hideColumn:A(t)}),()=>({hideColumn:A(t)})]),De(Dt,Nt)}),H(Ft),je(Dt=>{_e(Zt,A(ue)+1),Ne(tt,"colspan",A(F)),_e(Vt,A(ne).sectionName),Ne(Tt,"colspan",A(W)),Ho=Ze(Ft,1,"svelte-jonk14",null,Ho,Dt)},[()=>({collaps:A(S)[A(ne).sectionID]})]),nt(Xe,()=>A(S)[A(ne).sectionID],Dt=>A(S)[A(ne).sectionID]=Dt),De(te,we)}),H(V);var It=m(V,2),Mt=m(k(It),2);Be(Mt),H(It);var Xt=m(It,2);Xt.__click=T;var kt=m(Xt,2);kt.__click=[Va,_,b,c];var xt=m(kt,2);xt.__click=[Ka,h];var Pt=m(xt,2);vo(Pt,{okName:"Done",okFunc:j,sizeLarge:!0,get modalOpen(){return A(c)},set modalOpen(te){de(c,te,!0)},children:(te,ne)=>{var ue=Qa(),we=m(dt(ue),2),Ve=k(we,!0);H(we),je(()=>_e(Ve,A(_))),De(te,ue)},$$slots:{default:!0}});var yt=m(Pt,2);vo(yt,{okName:"Save into localStorage",okFunc:M,get modalOpen(){return A(h)},set modalOpen(te){de(h,te,!0)},children:(te,ne)=>{ba(te,{get pageName(){return e.pDef.partName},get storeName(){return A(f)},set storeName(ue){de(f,ue,!0)}})},$$slots:{default:!0}}),H(I);var mt=m(I,2);Ys(mt,{get svgPath(){return A(u)},get modalOpen(){return A(g)},set modalOpen(te){de(g,te,!0)}});var pt=m(mt,2);pt.__click=[Ta,g];var gt=k(pt);H(pt);var bt=m(pt,2),Se=k(bt);us(Se,{get pFig(){return e.pFig},full:!0}),H(bt);var Yt=m(bt,2),ke=k(Yt);us(ke,{get pFig(){return e.pFig},full:!1}),H(Yt),H(z),je((te,ne,ue,we)=>{yo(ie,A(n)),J=Ze(ie,1,"svelte-jonk14",null,J,te),Ie=Ze(ce,1,"svelte-jonk14",null,Ie,ne),et=Ze(We,1,"svelte-jonk14",null,et,ue),qt=Ze(le,1,"svelte-jonk14",null,qt,we),Ne(Mt,"size",A(K)),Ne(gt,"src",A(u)),Ne(gt,"alt",A(u))},[()=>({colorWarn:A(i)}),()=>({hideColumn:A(t)}),()=>({hideColumn:A(t)}),()=>({hideColumn:A(t)})]),to(Mt,()=>A(d),te=>de(d,te)),De(s,z),Qe()}Lt(["change","click"]);var oi=Re('<nav class="svelte-1lpxlzz"><button class="svelte-1lpxlzz">0</button> <button class="svelte-1lpxlzz">&lt-</button> <button class="svelte-1lpxlzz">|&lt</button> <button class="svelte-1lpxlzz">||</button> <button class="svelte-1lpxlzz">&gt|</button> <button class="svelte-1lpxlzz">-&gt</button> <input type="range" min="0" class="svelte-1lpxlzz"/> <input type="number" min="0" class="svelte-1lpxlzz"/></nav>');function si(s,e){Ke(e,!0);let d=rt(e,"tMax",3,10),t=rt(e,"tStep",3,.1),n=rt(e,"tUpdate",3,500),i=rt(e,"simTime",15,0),a=null,r=0,c;const h=4;function l(){a!==null&&(clearInterval(a),a=null)}function f(){c<0&&i()<=0?i(d()):c>0&&i()>=d()?i(0):i(i()+c)}function _(){const y=n()/2**(Math.abs(r)-1);c=r<0?-t():t(),a=setInterval(f,y)}function u(){l(),i(0),r=0}function g(){l(),r=0,c=-t(),f()}function S(){l(),r=0,c=t(),f()}function L(){l(),r=Math.max(r-1,-h),_()}function R(){l(),r=Math.min(r+1,h),_()}function v(){l(),r=0}$n(()=>{l()});var x=oi(),C=k(x);C.__click=u;var T=m(C,2);T.__click=L;var w=m(T,2);w.__click=g;var P=m(w,2);P.__click=v;var M=m(P,2);M.__click=S;var b=m(M,2);b.__click=R;var j=m(b,2);Be(j);var O=m(j,2);Be(O),H(x),je(()=>{Ne(j,"max",d()),Ne(j,"step",t()),Ne(O,"max",d()),Ne(O,"step",t())}),to(j,i),to(O,i),De(s,x),Qe()}Lt(["click"]);var ni=(s,e)=>e.zoomClick("zoomInit"),ri=(s,e)=>e.zoomClick("zoomIn"),ai=(s,e)=>e.zoomClick("zoomOut"),ii=(s,e)=>e.zoomClick("moveLeft"),di=(s,e)=>e.zoomClick("moveRight"),ci=(s,e)=>e.zoomClick("moveUp"),li=(s,e)=>e.zoomClick("moveDown"),gi=Re('<nav class="svelte-et5lcr"><button aria-labelledby="zoomInit" class="svelte-et5lcr"><div class="zero svelte-et5lcr"></div></button><button aria-labelledby="zoomIn" class="svelte-et5lcr"><div class="zoomin svelte-et5lcr"></div></button><button aria-labelledby="zoomOut" class="svelte-et5lcr"><div class="zoomout svelte-et5lcr"></div></button><button aria-labelledby="moveLeft" class="svelte-et5lcr"><div class="arrowleft svelte-et5lcr"></div></button><button aria-labelledby="moveRight" class="svelte-et5lcr"><div class="arrowright svelte-et5lcr"></div></button><button aria-labelledby="moveUp" class="svelte-et5lcr"><div class="arrowup svelte-et5lcr"></div></button><button aria-labelledby="moveDown" class="svelte-et5lcr"><div class="arrowdown svelte-et5lcr"></div></button></nav>');function hi(s,e){Ke(e,!0);var d=gi(),t=k(d);t.__click=[ni,e];var n=m(t);n.__click=[ri,e];var i=m(n);i.__click=[ai,e];var a=m(i);a.__click=[ii,e];var r=m(a);r.__click=[di,e];var c=m(r);c.__click=[ci,e];var h=m(c);h.__click=[li,e],H(d),De(s,d),Qe()}Lt(["click"]);var Ae=Vn(()=>he),ui=Re('<div class="svelte-1rsbkj"><label class="svelte-1rsbkj"><input type="checkbox" class="svelte-1rsbkj"/>main part</label> <label class="svelte-1rsbkj"><input type="checkbox" class="svelte-1rsbkj"/>main skeleton</label> <label class="svelte-1rsbkj"><input type="checkbox" class="svelte-1rsbkj"/>second parts</label> <label class="svelte-1rsbkj"><input type="checkbox" class="svelte-1rsbkj"/>second skeletons</label> <label class="svelte-1rsbkj"><input type="checkbox" class="svelte-1rsbkj"/>dynamics</label> <label class="svelte-1rsbkj"><input type="checkbox" class="svelte-1rsbkj"/>ruler</label> <label class="svelte-1rsbkj"><input type="checkbox" class="svelte-1rsbkj"/>frame of reference</label> <label class="svelte-1rsbkj"><input type="checkbox" class="svelte-1rsbkj"/>points</label> <label class="svelte-1rsbkj"><input type="checkbox" class="svelte-1rsbkj"/>lines</label> <label class="svelte-1rsbkj"><input type="checkbox" class="svelte-1rsbkj"/>vectors</label></div>');function _i(s,e){Ke(e,!1),Cn();var d=ui(),t=k(d),n=k(t);Be(n),st(),H(t);var i=m(t,2),a=k(i);Be(a),st(),H(i);var r=m(i,2),c=k(r);Be(c),st(),H(r);var h=m(r,2),l=k(h);Be(l),st(),H(h);var f=m(h,2),_=k(f);Be(_),st(),H(f);var u=m(f,2),g=k(u);Be(g),st(),H(u);var S=m(u,2),L=k(S);Be(L),st(),H(S);var R=m(S,2),v=k(R);Be(v),st(),H(R);var x=m(R,2),C=k(x);Be(C),st(),H(x);var T=m(x,2),w=k(T);Be(w),st(),H(T),H(d),nt(n,()=>Ae().dLayers.main,P=>Ae(Ae().dLayers.main=P)),nt(a,()=>Ae().dLayers.mainB,P=>Ae(Ae().dLayers.mainB=P)),nt(c,()=>Ae().dLayers.second,P=>Ae(Ae().dLayers.second=P)),nt(l,()=>Ae().dLayers.secondB,P=>Ae(Ae().dLayers.secondB=P)),nt(_,()=>Ae().dLayers.dynamics,P=>Ae(Ae().dLayers.dynamics=P)),nt(g,()=>Ae().dLayers.ruler,P=>Ae(Ae().dLayers.ruler=P)),nt(L,()=>Ae().dLayers.refframe,P=>Ae(Ae().dLayers.refframe=P)),nt(v,()=>Ae().dLayers.points,P=>Ae(Ae().dLayers.points=P)),nt(C,()=>Ae().dLayers.lines,P=>Ae(Ae().dLayers.lines=P)),nt(w,()=>Ae().dLayers.vectors,P=>Ae(Ae().dLayers.vectors=P)),De(s,d),Qe()}var fi=Re('<section class="svelte-1lstqwr"><!> <div class="rack svelte-1lstqwr"><canvas class="full svelte-1lstqwr"></canvas> <!></div> <div class="rack svelte-1lstqwr"><canvas class="zoom svelte-1lstqwr"></canvas> <!></div></section>');function vi(s,e){Ke(e,!0);let d=rt(e,"simTime",15,0);const t=400,n=1200;let i=$e(t),a,r,c;function h(I,U){if(a){const D=a.getContext("2d");D.clearRect(0,0,D.canvas.width,D.canvas.height);try{c=I.getAdjustFull(D.canvas.width,D.canvas.height),I.draw(D,c,U)}catch(Y){console.log(Y)}}}function l(I,U,D){if(r){const Y=r.getContext("2d");Y.clearRect(0,0,Y.canvas.width,Y.canvas.height);try{(U===void 0||U.init===0)&&(U=I.getAdjustZoom(Y.canvas.width,Y.canvas.height)),I.draw(Y,U,D)}catch(E){console.log(E)}}}function f(){const I=a.getContext("2d"),U=r.getContext("2d"),D=Math.min(Math.max(.4*A(i),t),n);I.canvas.width=D,I.canvas.height=D,U.canvas.width=D,U.canvas.height=D,he.canvasZWidth=D,he.zAdjust.init===0&&(he.zAdjust=e.pFig.getAdjustZoom(U.canvas.width,U.canvas.height))}function _(){f(),h(e.pFig,he.dLayers),l(e.pFig,he.zAdjust,he.dLayers)}function u(I,U,D){h(I,D),l(I,U,D)}En(()=>{f()}),Ko(()=>{u(e.pFig,he.zAdjust,he.dLayers)});function g(I){const U=r.getContext("2d");switch(I){case"zoomInit":he.zAdjust=e.pFig.getAdjustZoom(U.canvas.width,U.canvas.height);break;case"zoomIn":he.zAdjust=Ao(.7,he.zAdjust);break;case"zoomOut":he.zAdjust=Ao(1.3,he.zAdjust);break;case"moveLeft":he.zAdjust.xMin+=-.2*he.zAdjust.xyDiff;break;case"moveRight":he.zAdjust.xMin+=.2*he.zAdjust.xyDiff;break;case"moveUp":he.zAdjust.yMin+=.2*he.zAdjust.xyDiff;break;case"moveDown":he.zAdjust.yMin+=-.2*he.zAdjust.xyDiff;break;default:console.log(`ERR423: ${I} has no case!`)}l(e.pFig,he.zAdjust,he.dLayers)}const S=3e3,L=10,R=3;let v={timestamp:0,offsetX:0,offsetY:0};function x(I){I.button===0&&(v.timestamp=Date.now(),v.offsetX=I.offsetX,v.offsetY=I.offsetY)}function C(I){if(I.button===0)if(Date.now()-v.timestamp<S){const U=Math.abs(v.offsetX-I.offsetX),D=Math.abs(v.offsetY-I.offsetY);if(U<L&&D<L){const[Y,E]=Gt(I.offsetX,I.offsetY,c);he.zAdjust=gn(Y,E,he.zAdjust),u(e.pFig,he.zAdjust,he.dLayers)}if(U>L&&D>L){const Y=U/D,E=1/Y;if(Y<R&&E<R){const[Q,ie]=Gt(I.offsetX,I.offsetY,c),[J,V]=Gt(v.offsetX,v.offsetY,c),ee=r.getContext("2d").canvas.width;he.zAdjust=hn(Q,ie,J,V,ee,ee),u(e.pFig,he.zAdjust,he.dLayers)}}}else console.log(`Warn205: ignore ${I.offsetX} ${I.offsetY} because too slow`)}function T(I){if(a){const U=a.getContext("2d");if(I.buttons===1){const D=I.offsetX-v.offsetX,Y=I.offsetY-v.offsetY;h(e.pFig,he.dLayers),U.beginPath(),U.rect(v.offsetX,v.offsetY,D,Y),U.strokeStyle=Bo.mouse,U.stroke()}if(he.dLayers.ruler){const[D,Y]=Gt(I.offsetX,I.offsetY,c);U.clearRect(5,5,200,25),U.font="15px Arial",U.fillStyle=Bo.ruler,U.fillText(`x: ${D.toFixed(4)} y: ${Y.toFixed(4)}`,5,20)}}}let w,P,M;function b(I){if(I.button===0){const[U,D]=Gt(I.offsetX,I.offsetY,he.zAdjust);w=U,P=D,M=un(he.zAdjust)}}function j(I){if(I.buttons===1){const[U,D]=Gt(I.offsetX,I.offsetY,M);he.zAdjust=_n(w,P,U,D,M),l(e.pFig,he.zAdjust,he.dLayers)}else if(he.dLayers.ruler&&r){const U=r.getContext("2d"),[D,Y]=Gt(I.offsetX,I.offsetY,he.zAdjust);U.clearRect(5,5,200,25),U.font="15px Arial",U.fillStyle=Bo.ruler,U.fillText(`x: ${D.toFixed(4)} y: ${Y.toFixed(4)}`,5,20)}}function O(I){I.preventDefault(),I.deltaY>0?he.zAdjust=Ao(.7,he.zAdjust):he.zAdjust=Ao(1.3,he.zAdjust),l(e.pFig,he.zAdjust,he.dLayers)}var y=fi();is("resize",bn,_);var q=k(y);_i(q,{});var X=m(q,2),N=k(X);Ne(N,"width",t),Ne(N,"height",t),N.__mousedown=x,N.__mouseup=C,N.__mousemove=T,$o(N,I=>a=I,()=>a);var F=m(N,2);si(F,{get tMax(){return e.pDefSim.tMax},get tStep(){return e.pDefSim.tStep},get tUpdate(){return e.pDefSim.tUpdate},get simTime(){return d()},set simTime(I){d(I)}}),H(X);var W=m(X,2),K=k(W);Ne(K,"width",t),Ne(K,"height",t),K.__mousedown=b,K.__mousemove=j,$o(K,I=>r=I,()=>r);var z=m(K,2);hi(z,{zoomClick:g}),H(W),H(y),In("innerWidth",I=>de(i,I,!0)),is("wheel",K,O),De(s,y),Qe()}Lt(["mousedown","mouseup","mousemove"]);var Si=(s,e,d)=>e(d),Li=(s,e,d)=>e(d),xi=Re("<tr><td> </td><td> </td><td> </td><td><i> </i></td><td><i> </i></td></tr>"),Pi=Re('<li class="svelte-lzdpo0"><input type="checkbox" class="toggle svelte-lzdpo0"/> <label class="label svelte-lzdpo0"><div class="arrow svelte-lzdpo0"></div> </label> <button class="svelte-lzdpo0"> </button> <button class="svelte-lzdpo0">Export parameters</button> <div class="nested svelte-lzdpo0"><article class="svelte-lzdpo0"> <strong> </strong> </article> <table class="svelte-lzdpo0"><thead class="svelte-lzdpo0"><tr><td>Num</td><td>Name</td><td>Value</td><td>Init</td><td>Set?</td></tr></thead><tbody class="svelte-lzdpo0"></tbody></table></div></li>'),Di=Re('<section class="svelte-lzdpo0"><h2 class="svelte-lzdpo0">Sub-designs <span class="svelte-lzdpo0"> </span></h2> <ol class="svelte-lzdpo0"></ol></section>');function Hi(s,e){Ke(e,!0);const d=qe(()=>Object.keys(e.subD));async function t(u){const g=e.subD[u];Xs(g.partName,ns(g.dparam),!0);const S=`${No}${e.pLink[g.partName]}`;Nn(S)}function n(u){const g=e.subD[u].partName,S=e.subD[u].dparam,L=`sub-design parameters of ${g} from ${e.origPartName}`;Qo(g,ns(S),L)}function i(u){let g="[ ";return g+=`${p(Ce(u[0]))}, `,g+=`${p(Ce(u[1]))}, `,g+=`${p(Ce(u[2]))} ]`,g}function a(u){let g="[ ";return g+=`${p(u[0])}, `,g+=`${p(u[1])}, `,g+=`${p(u[2])} ]`,g}function r(u){return u?"Yes":""}var c=Di(),h=k(c),l=m(k(h)),f=k(l);H(l),H(h);var _=m(h,2);lt(_,20,()=>A(d),u=>u,(u,g)=>{var S=Pi(),L=k(S);Be(L),Mn(L,!1);var R=m(L,2),v=m(k(R));H(R);var x=m(R,2);x.__click=[Si,t,g];var C=k(x);H(x);var T=m(x,2);T.__click=[Li,n,g];var w=m(T,2),P=k(w),M=k(P),b=m(M),j=k(b,!0);H(b);var O=m(b);H(P);var y=m(P,2),q=m(k(y));lt(q,22,()=>Object.keys(e.subD[g].dparam),X=>X,(X,N,F)=>{var W=xi();let K;var z=k(W),I=k(z,!0);H(z);var U=m(z),D=k(U,!0);H(U);var Y=m(U),E=k(Y,!0);H(Y);var Q=m(Y),ie=k(Q),J=k(ie,!0);H(ie),H(Q);var V=m(Q),Z=k(V),ee=k(Z,!0);H(Z),H(V),H(W),je((He,Le)=>{K=Ze(W,1,"svelte-lzdpo0",null,K,He),_e(I,A(F)+1),_e(D,N),_e(E,e.subD[g].dparam[N].val),_e(J,e.subD[g].dparam[N].init),_e(ee,Le)},[()=>({changed:e.subD[g].dparam[N].chg}),()=>r(e.subD[g].dparam[N].chg)]),De(X,W)}),H(q),H(y),H(w),H(S),je((X,N,F)=>{Ne(L,"id",`cb_${g??""}`),Ne(R,"for",`cb_${g??""}`),_e(v,` ${g??""}`),_e(C,`Go to ${e.pLink[e.subD[g].partName]??""}`),_e(M,`${X??""} parameters of `),_e(j,e.subD[g].partName),_e(O,` with orientation ${N??""} (degree) at position
						${F??""} (mm)`)},[()=>Object.keys(e.subD[g].dparam).length,()=>i(e.subD[g].orientation),()=>a(e.subD[g].position)]),De(u,S)}),H(_),H(c),je(()=>_e(f,`(Number of sub-instances: ${A(d).length??""})`)),De(s,c),Qe()}Lt(["click"]);async function ki(s,e){Qo(e.pDef.partName,Ee[e.pDef.partName],"")}var mi=(s,e,d)=>{de(e,d,!0)},pi=Re("<button> </button>"),bi=(s,e,d)=>{de(e,d)},wi=(s,e,d)=>{e(ya(d.pDef.partName,Ee[d.pDef.partName],""))},Ri=(s,e)=>{e("all",ze.eTXTLOG)},Ai=async(s,e)=>{await e("compute_log")},Mi=(s,e,d)=>{e(d,ze.eSVG)},yi=async(s,e,d)=>{await e(`svg_${d}`)},Ni=Re('<tr class="svelte-8jmax4"><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">2d- svg</td><td class="svelte-8jmax4"><button class="svelte-8jmax4">preview</button></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr>'),$i=(s,e)=>{e("all",ze.eSVGALL)},Ei=async(s,e)=>{await e("allsvg")},Ci=(s,e,d)=>{e(d,ze.eDXF)},Oi=async(s,e,d)=>{await e(`dxf_${d}`)},Ii=Re('<tr class="svelte-8jmax4"><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">2d- dxf</td><td class="svelte-8jmax4"><button class="svelte-8jmax4">preview</button></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr>'),Vi=(s,e)=>{e("all",ze.eDXFALL)},Ti=async(s,e)=>{await e("alldxf")},ji=(s,e)=>{e("all",ze.ePAX)},Fi=async(s,e)=>{await e("pax")},Bi=(s,e)=>{e("all",ze.eOPENSCAD)},zi=async(s,e)=>{await e("oscad")},Gi=(s,e)=>{e("all",ze.eJSCAD)},Ji=async(s,e)=>{await e("ojscad")},Ui=(s,e)=>{e("all",ze.eFREECAD)},Wi=async(s,e)=>{await e("freecad")},qi=async(s,e)=>{await e("zip")},Xi=Re('<!> <section class="svelte-8jmax4"><h2 class="svelte-8jmax4">Log</h2> <textarea rows="5" cols="94" readonly="" wrap="soft"></textarea></section> <section class="svelte-8jmax4"><h2 class="svelte-8jmax4">2D Drawings : <!> <button>All faces merged</button></h2></section> <!> <section class="svelte-8jmax4"><h2 class="svelte-8jmax4">Export</h2> <table class="svelte-8jmax4"><caption class="svelte-8jmax4">Output files</caption><thead class="svelte-8jmax4"><tr class="svelte-8jmax4"><th class="svelte-8jmax4">#</th><th class="svelte-8jmax4">Filename</th><th class="svelte-8jmax4">Type</th><th class="svelte-8jmax4">Preview</th><th class="svelte-8jmax4">Download</th></tr></thead><tbody class="svelte-8jmax4"><tr class="svelte-8jmax4"><td class="svelte-8jmax4">1</td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">0-params- pxJson</td><td class="svelte-8jmax4"><button class="svelte-8jmax4">preview</button></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr><tr class="svelte-8jmax4"><td class="svelte-8jmax4">2</td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">1-log- txtLog</td><td class="svelte-8jmax4"><button class="svelte-8jmax4">preview</button></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr><!><tr class="svelte-8jmax4"><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">2d- svg</td><td class="svelte-8jmax4"><button class="svelte-8jmax4">preview</button></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr><!><tr class="svelte-8jmax4"><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">2d- dxf</td><td class="svelte-8jmax4"><button class="svelte-8jmax4">preview</button></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr><tr class="svelte-8jmax4"><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">4-pax- paxJson</td><td class="svelte-8jmax4"><button class="svelte-8jmax4">preview</button></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr><tr class="svelte-8jmax4"><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">5-script- scad</td><td class="svelte-8jmax4"><button class="svelte-8jmax4">preview</button></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr><tr class="svelte-8jmax4"><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">5-script- jsCad</td><td class="svelte-8jmax4"><button class="svelte-8jmax4">preview</button></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr><tr class="svelte-8jmax4"><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">5-script- pyFreecad</td><td class="svelte-8jmax4"><button class="svelte-8jmax4">preview</button></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr><tr class="svelte-8jmax4"><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4"> </td><td class="svelte-8jmax4">6-zip- zip</td><td class="svelte-8jmax4"></td><td class="svelte-8jmax4"><button class="svelte-8jmax4">download</button></td></tr></tbody></table> <dialog id="dBview" class="svelte-8jmax4"><textarea readonly="" wrap="soft" class="svelte-8jmax4"></textarea> <button class="bback svelte-8jmax4">close - back - escape</button></dialog> <!></section>',1);function bd(s,e){Ke(e,!0);const d="ParametrixAll";function t(re){let Pe=!0;const me=/warn/i;return re.search(me)<0&&(Pe=!1),Pe}function n(re,Pe){let me=Pe;if(re.length===0)console.log("warn404: Drawing has an empty face list");else{const ve=re.slice();ve.push(d),ve.includes(me)||(me=re[0])}return me}function i(re,Pe){let me;const ve=Object.keys(re),Fe=n(ve,Pe);return ve.includes(Fe)?me=re[Fe]:me=Ln(re),me}let a=$e(0),r=$e(d);_s(()=>{de(r,n(Object.keys(e.fgeom(0,Ee[e.pDef.partName]).fig),""),!0)});let c=qe(()=>e.fgeom(A(a),Ee[e.pDef.partName])),h=qe(()=>{const re=new Date().toLocaleTimeString();let Pe=`Geometry ${e.pDef.partName} computed at ${re}
`;return Pe+=A(c).logstr,Pe}),l=qe(()=>Object.keys(A(c).fig)),f=qe(()=>A(c).calcErr),_=qe(()=>t(A(c).logstr)),u=qe(()=>i(A(c).fig,A(r))),g=qe(()=>A(c).sub);function S(re,Pe){const me=document.createElement("a"),ve=URL.createObjectURL(Pe);me.setAttribute("href",ve),me.setAttribute("download",re),me.click(),me.remove(),URL.revokeObjectURL(ve)}function L(re,Pe,me){const ve=document.createElement("a"),Fe="data:"+me+";utf-8,"+encodeURIComponent(Pe);ve.setAttribute("href",Fe),ve.setAttribute("download",re),ve.click(),ve.remove()}function R(){const re=/[-:]/g,Pe=/\..*$/;return new Date().toISOString().replace(re,"").replace(Pe,"").replace("T","_")}async function v(re){const Pe=/^svg_/,me=/^dxf_/;let ve=ze.eSVG,Fe="all";re.match(Pe)?(ve=ze.eSVG,Fe=re.replace(Pe,"")):re.match(me)?(ve=ze.eDXF,Fe=re.replace(me,"")):re==="allsvg"?ve=ze.eSVGALL:re==="alldxf"?ve=ze.eDXFALL:re==="compute_log"?ve=ze.eTXTLOG:re==="pax"?ve=ze.ePAX:re==="oscad"?ve=ze.eOPENSCAD:re==="ojscad"?ve=ze.eJSCAD:re==="freecad"?ve=ze.eFREECAD:re==="zip"?ve=ze.eZIP:console.log(`err883: downloadExport iExportFace ${re} invalid`);const Ht=vn(ve),Te=xn(ve),Ye=Sn(ve),Ge=e.pDef.partName+"_"+Fe+"_"+R()+Ht;if(Ye){const wt=await fn(e.fgeom,A(a),Ee[e.pDef.partName],e.pDef,ve);S(Ge,wt)}else{const wt=rs(e.fgeom,Ee[e.pDef.partName],e.pDef,Fe,ve);L(Ge,wt,Te)}}let x,C=$e("");function T(re){de(C,re,!0),x.showModal()}function w(re,Pe){T(rs(e.fgeom,Ee[e.pDef.partName],e.pDef,re,Pe))}function P(){x.close()}var M=Xi(),b=dt(M);ti(b,{get pDef(){return e.pDef},get pFig(){return A(u)}});var j=m(b,2),O=m(k(j),2);Go(O);let y;H(j);var q=m(j,2),X=k(q),N=m(k(X));lt(N,16,()=>A(l),re=>re,(re,Pe)=>{var me=pi();me.__click=[mi,r,Pe];var ve=k(me,!0);H(me),je(()=>{Ze(me,1,ds({theFace:A(r)===Pe}),"svelte-8jmax4"),_e(ve,Pe)}),De(re,me)});var F=m(N,2);F.__click=[bi,r,d],H(X),H(q);var W=m(q,2);vi(W,{get pDefSim(){return e.pDef.sim},get pFig(){return A(u)},get simTime(){return A(a)},set simTime(re){de(a,re,!0)}});var K=m(W,2),z=m(k(K),2),I=m(k(z),2),U=k(I),D=m(k(U)),Y=k(D);H(D);var E=m(D,2),Q=k(E);Q.__click=[wi,T,e],H(E);var ie=m(E),J=k(ie);J.__click=[ki,e],H(ie),H(U);var V=m(U),Z=m(k(V)),ee=k(Z);H(Z);var He=m(Z,2),Le=k(He);Le.__click=[Ri,w],H(He);var ye=m(He),fe=k(ye);fe.__click=[Ai,v],H(ye),H(V);var ce=m(V);lt(ce,18,()=>A(l),re=>re,(re,Pe,me)=>{var ve=Ni(),Fe=k(ve),Ht=k(Fe,!0);H(Fe);var Te=m(Fe),Ye=k(Te);H(Te);var Ge=m(Te,2),wt=k(Ge);wt.__click=[Mi,w,Pe],H(Ge);var Et=m(Ge),Rt=k(Et);Rt.__click=[yi,v,Pe],H(Et),H(ve),je(()=>{_e(Ht,3+A(me)),_e(Ye,`${e.pDef.partName??""}_${Pe??""}.svg`)}),De(re,ve)});var Ie=m(ce),We=k(Ie),et=k(We,!0);H(We);var le=m(We),qt=k(le);H(le);var at=m(le,2),It=k(at);It.__click=[$i,w],H(at);var Mt=m(at),Xt=k(Mt);Xt.__click=[Ei,v],H(Mt),H(Ie);var kt=m(Ie);lt(kt,18,()=>A(l),re=>re,(re,Pe,me)=>{var ve=Ii(),Fe=k(ve),Ht=k(Fe,!0);H(Fe);var Te=m(Fe),Ye=k(Te);H(Te);var Ge=m(Te,2),wt=k(Ge);wt.__click=[Ci,w,Pe],H(Ge);var Et=m(Ge),Rt=k(Et);Rt.__click=[Oi,v,Pe],H(Et),H(ve),je(()=>{_e(Ht,4+A(l).length+A(me)),_e(Ye,`${e.pDef.partName??""}_${Pe??""}.dxf`)}),De(re,ve)});var xt=m(kt),Pt=k(xt),yt=k(Pt,!0);H(Pt);var mt=m(Pt),pt=k(mt);H(mt);var gt=m(mt,2),bt=k(gt);bt.__click=[Vi,w],H(gt);var Se=m(gt),Yt=k(Se);Yt.__click=[Ti,v],H(Se),H(xt);var ke=m(xt),te=k(ke),ne=k(te,!0);H(te);var ue=m(te),we=k(ue);H(ue);var Ve=m(ue,2),Ue=k(Ve);Ue.__click=[ji,w],H(Ve);var ht=m(Ve),Zt=k(ht);Zt.__click=[Fi,v],H(ht),H(ke);var tt=m(ke),Vt=k(tt),Tt=k(Vt,!0);H(Vt);var jt=m(Vt),Xe=k(jt);H(jt);var Ft=m(jt,2),Ho=k(Ft);Ho.__click=[Bi,w],H(Ft);var Dt=m(Ft),Me=k(Dt);Me.__click=[zi,v],H(Dt),H(tt);var oo=m(tt),Nt=k(oo),ko=k(Nt,!0);H(Nt);var Bt=m(Nt),Io=k(Bt);H(Bt);var zt=m(Bt,2),so=k(zt);so.__click=[Gi,w],H(zt);var mo=m(zt),no=k(mo);no.__click=[Ji,v],H(mo),H(oo);var ro=m(oo),ao=k(ro),Vo=k(ao,!0);H(ao);var $t=m(ao),po=k($t);H($t);var io=m($t,2),Kt=k(io);Kt.__click=[Ui,w],H(io);var co=m(io),To=k(co);To.__click=[Wi,v],H(co),H(ro);var Qt=m(ro),lo=k(Qt),go=k(lo,!0);H(lo);var ho=m(lo),uo=k(ho);H(ho);var _o=m(ho,3),jo=k(_o);jo.__click=[qi,v],H(_o),H(Qt),H(I),H(z);var ot=m(z,2),ut=k(ot);Go(ut);var it=m(ut,2);it.__click=P,H(ot),$o(ot,re=>x=re,()=>x);var _t=m(ot,2);Hi(_t,{get subD(){return A(g)},get origPartName(){return e.pDef.partName},get pLink(){return e.pLink}}),H(K),je(re=>{yo(O,A(h)),y=Ze(O,1,"svelte-8jmax4",null,y,re),Ze(F,1,ds({theFace:A(r)===d}),"svelte-8jmax4"),_e(Y,`px_${e.pDef.partName??""}.json`),_e(ee,`${e.pDef.partName??""}_all.log`),_e(et,3+A(l).length),_e(qt,`${e.pDef.partName??""}_all.svg`),_e(yt,4+2*A(l).length),_e(pt,`${e.pDef.partName??""}_all.dxf`),_e(ne,5+2*A(l).length),_e(we,`${e.pDef.partName??""}_all.pax.json`),_e(Tt,6+2*A(l).length),_e(Xe,`${e.pDef.partName??""}_all_noarc_openscad.scad`),_e(ko,7+2*A(l).length),_e(Io,`${e.pDef.partName??""}_all_noarc_jscad.js`),_e(Vo,8+2*A(l).length),_e(po,`${e.pDef.partName??""}_all_freecad.py`),_e(go,9+2*A(l).length),_e(uo,`${e.pDef.partName??""}_all.zip`),yo(ut,A(C))},[()=>({colorErr:A(f),colorWarn:A(_)})]),De(s,M),Qe()}Lt(["click"]);function Oo(s){const e=/^.*\//g;let d=s.replace(e,"");return d===""&&(d="index"),d}function Yi(s){const e=[];for(const d of s){const t={category:d.category,pages:[]};for(const n of d.pages){const i={path:n.path,page:n.page,svg:n.svg,label:Oo(n.path)};t.pages.push(i)}e.push(t)}return e}function Zi(s){const e={};for(const d of s)for(const t of d.pages)if(t.page!=null){const n=Oo(t.path);e[n]=t.page}return e}function Ki(s){const e={};for(const d of s)for(const t of d.pages)if(t.page!=null){const n=Oo(t.path);e[n]=t.path}return e}function Qi(s){const e=/\/$/;return s.replace(e,"")}function ed(s){let e=s;return(e==="/index"||e==="/index.html")&&(e="/"),e}function td(s){let e=s;return e===""&&(e="/"),e}function od(s){let e=s;return e=Qi(e),e=td(e),e=ed(e),e}const Ks={path:"/",page:null,svg:"page_index.svg",label:"index"},sd={path:"/about",page:null,svg:"page_about.svg",label:"about"},nd={category:"",pages:[Ks,sd]};function rd(s,e){const d=od(e);let t=0;e:for(const[i,a]of s.entries())for(const r of a.pages)if(d===r.path){t=i;break e}let n=nd;if(t>0&&t<s.length-1){const i=s[t];n={category:i.category,pages:[]},n.pages.push(Ks);for(const a of i.pages){const r={path:a.path,page:a.page,svg:a.svg,label:Oo(a.path)};n.pages.push(r)}}return n}function wd(s){return rd(Co,s)}const Rd=Yi(Co),ad=Zi(Co),Ad=Ki(Co);da(ad);export{pd as D,bd as P,ia as a,Ad as b,od as c,ad as d,md as i,wd as l,Rd as m};
